{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/Idrisでふんわり眺める依存型/","result":{"data":{"site":{"siteMetadata":{"siteUrl":"https://sititou70.github.io"}},"markdownRemark":{"excerpt":"どうも，よわよわエンジニアです．前回の記事では，TAPLを読んで型システムに入門しました． その記事の中で，1つ腑に落ちなかったことがあります．そう， 依存型 です． 依存型は，TAPLでも発展的内容として深く触れないんだっピ… よわよわエンジニアがTAPL…","html":"<p>どうも，よわよわエンジニアです．<a href=\"/%E3%82%88%E3%82%8F%E3%82%88%E3%82%8F%E3%82%A8%E3%83%B3%E3%82%B8%E3%83%8B%E3%82%A2%E3%81%8C-TAPL%EF%BC%88%E5%9E%8B%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E5%85%A5%E9%96%80%EF%BC%89%E3%82%92%E8%AA%AD%E3%82%93%E3%81%A0%E3%82%89/\">前回</a>の記事では，TAPLを読んで型システムに入門しました．</p>\n<p>その記事の中で，1つ腑に落ちなかったことがあります．そう， <strong>依存型</strong> です．</p>\n<blockquote>\n<p>依存型は，TAPLでも発展的内容として深く触れないんだっピ…</p>\n<p><a href=\"https://sititou70.github.io/%E3%82%88%E3%82%8F%E3%82%88%E3%82%8F%E3%82%A8%E3%83%B3%E3%82%B8%E3%83%8B%E3%82%A2%E3%81%8C-TAPL%EF%BC%88%E5%9E%8B%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E5%85%A5%E9%96%80%EF%BC%89%E3%82%92%E8%AA%AD%E3%82%93%E3%81%A0%E3%82%89/\">よわよわエンジニアがTAPL（型システム入門）を読んだら</a></p>\n</blockquote>\n<p>依存型は，関数型，全称型，型演算子に続いてラムダキューブを完成させる最後のピースでした．</p>\n<p>それが埋まらず，日々ストレスを貯める一方だったのですが，はてブのコメントで「<a href=\"https://b.hatena.ne.jp/entry/4719109124404117986/comment/zyzy\">実戦で色々試したくなったらIdrisがあるよ!!</a>」と親切な方が教えてくださったので，</p>\n<p>依存型の雰囲気を味わうためにIdrisへふんわり入門してみます．</p>\n<ul>\n<li>依存型ってなんやねん</li>\n<li>型にプログラムが書けるってどういうこと</li>\n<li>プログラミングと証明に何の関係があるんだ</li>\n</ul>\n<p>といった疑問を解決するまでの日記です．</p>\n<h2 id=\"idrisとは\" style=\"position:relative;\"><a href=\"#idris%E3%81%A8%E3%81%AF\" aria-label=\"idrisとは permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Idrisとは</h2>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>I</mi><mi>d</mi><mi>r</mi><mi>i</mi><mi>s</mi><mo>=</mo><mi>H</mi><mi>a</mi><mi>s</mi><mi>k</mi><mi>e</mi><mi>l</mi><mi>l</mi><mo>+</mo><mtext>依存型</mtext></mrow><annotation encoding=\"application/x-tex\">Idris = Haskell + 依存型</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">ll</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord cjk_fallback\">依存型</span></span></span></span></span></div>\n<p>と<a href=\"https://keens.github.io/blog/2020/11/30/idristtedonnagengo_/\">言われている</a>そうです．</p>\n<p>Haskellとは，言わずとしれた関数型プログラミング言語です．え？ <em>Haskellを知らないからこの先読めるか不安？</em> ハハハ， <strong>私もHaskellまったくわからん</strong> ので大丈夫ですよ（？）</p>\n<p>依存型とは，TAPLによれば「項でインデックス付けされた型」であり，型の中にプログラムが書けると言っています．なんのこっちゃ．さらに依存型は，<a href=\"https://ja.wikipedia.org/wiki/%E4%BE%9D%E5%AD%98%E5%9E%8B#%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E8%A8%80%E8%AA%9E%E3%81%A8%E8%AB%96%E7%90%86%E5%AD%A6%E3%81%AE%E4%B8%A1%E7%AB%8B\">定理証明支援系とも関係がある</a>とのことです．はえー．</p>\n<p>というわけで，試しにいくつかの証明をIdrisで書いてみたいと思います．がんばるぞ．</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ idris <span class=\"token parameter variable\">--version</span>\n<span class=\"token number\">1.3</span>.4-git:PRE</code></pre></div>\n<h2 id=\"ウォーミングアップモーダスポネンス\" style=\"position:relative;\"><a href=\"#%E3%82%A6%E3%82%A9%E3%83%BC%E3%83%9F%E3%83%B3%E3%82%B0%E3%82%A2%E3%83%83%E3%83%97%E3%83%A2%E3%83%BC%E3%83%80%E3%82%B9%E3%83%9D%E3%83%8D%E3%83%B3%E3%82%B9\" aria-label=\"ウォーミングアップモーダスポネンス permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ウォーミングアップ：モーダスポネンス</h2>\n<p>最初は依存型を使わずに，簡単な命題を証明してみます．</p>\n<p>以下の例を見てください．</p>\n<ol>\n<li><a href=\"https://dic.pixiv.net/a/%E3%81%93%E3%81%AE%E6%88%A6%E4%BA%89%E3%81%8C%E7%B5%82%E3%82%8F%E3%81%A3%E3%81%9F%E3%82%89%2F%E6%95%85%E9%83%B7%E3%81%AB%E5%B8%B0%E3%81%A3%E3%81%9F%E3%82%89%E3%80%87%E3%80%87%E3%81%99%E3%82%8B%E3%82%93%E3%81%A0\">俺，戦争から戻ったら結婚するんだ……</a></li>\n<li>俺，戦争から戻ったんだ……</li>\n<li>俺，結婚するんだ……</li>\n</ol>\n<p>ちょっと長いので，以下の記号で短く書き換えてみます．</p>\n<ul>\n<li>戦争から戻る： <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span></span></li>\n<li>結婚する： <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span></li>\n<li>ならば（たら）： <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\rightarrow</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span></span></li>\n</ul>\n<p>すると</p>\n<ol>\n<li><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo>→</mo><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">p \\rightarrow q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span></li>\n<li><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span></span></li>\n<li><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span></li>\n</ol>\n<p>となり，もうちょっと短く書くと</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">(</mo><mi>p</mi><mo>→</mo><mi>q</mi><mo stretchy=\"false\">)</mo><mtext>かつ</mtext><mi>p</mi><mo stretchy=\"false\">)</mo><mo>→</mo><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">((p \\rightarrow q) かつ p) \\rightarrow q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">((</span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mclose\">)</span><span class=\"mord cjk_fallback\">かつ</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span></div>\n<p>と表現できます．これが俺くんによる主張の論理構造であり， <strong>それを正しいと証明するIdrisのコードは以下のとおりです．</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"idris\"><pre class=\"language-idris\"><code class=\"language-idris\"><span class=\"token hvariable\">modusPonens</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token hvariable\">p</span> <span class=\"token operator\">-></span> <span class=\"token hvariable\">q</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">p</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token hvariable\">q</span>\n<span class=\"token hvariable\">modusPonens</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">hpq</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">hp</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">hpq</span> <span class=\"token hvariable\">hp</span></code></pre></div>\n<p>どういうことなのか，順を追って説明させてください．</p>\n<h3 id=\"まずは構文\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%9A%E3%81%AF%E6%A7%8B%E6%96%87\" aria-label=\"まずは構文 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まずは構文</h3>\n<p>上記のコードでは<code class=\"language-text\">modusPonens</code>という名前の関数を定義しています．関数定義の構文は以下のようになっています．</p>\n<div class=\"gatsby-highlight\" data-language=\"idris\"><pre class=\"language-idris\"><code class=\"language-idris\">関数名 <span class=\"token operator\">:</span> 関数の型\n関数名 引数<span class=\"token number\">1</span> 引数<span class=\"token number\">2</span> … <span class=\"token operator\">=</span> 関数のプログラム本体</code></pre></div>\n<p>つまり，</p>\n<ul>\n<li>関数名：<code class=\"language-text\">modusPonens</code></li>\n<li>関数の型：<code class=\"language-text\">((p -> q), p) -> q</code></li>\n<li>第1引数：<code class=\"language-text\">(hpq, hp)</code></li>\n<li>関数のプログラム本体：<code class=\"language-text\">hpq hp</code></li>\n</ul>\n<p>です．</p>\n<p>関数型は<code class=\"language-text\">引数 -> 戻り値</code>と書きます．<code class=\"language-text\">p -> q</code>は，「<code class=\"language-text\">p</code>型の値を受け取って<code class=\"language-text\">q</code>型の値を返す関数の型」です．</p>\n<p>タプル型は<code class=\"language-text\">(要素1, 要素2…)</code>と書きます．</p>\n<p>第1引数<code class=\"language-text\">(hpq, hp)</code>では，タプルを分割して受け取っています．ちなみに引数名の<code class=\"language-text\">hpq</code>は「仮定（<strong>h</strong> ypothesis）の <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo>→</mo><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">p \\rightarrow q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span>」の略として命名しました．</p>\n<p>プログラム本体の<code class=\"language-text\">hpq hp</code>は関数呼び出しで，CやJavaScript風に書くと<code class=\"language-text\">hpq(hp)</code>です．</p>\n<h3 id=\"カリーハワード同型対応\" style=\"position:relative;\"><a href=\"#%E3%82%AB%E3%83%AA%E3%83%BC%E3%83%8F%E3%83%AF%E3%83%BC%E3%83%89%E5%90%8C%E5%9E%8B%E5%AF%BE%E5%BF%9C\" aria-label=\"カリーハワード同型対応 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>カリー＝ハワード同型対応</h3>\n<p>ここまでで，</p>\n<p><em>プログラムを書くことが証明にどう関係するのか？</em></p>\n<p>と思われたかもしれません．</p>\n<p>実を言うとこのコードは， <strong>命題：<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">(</mo><mi>p</mi><mo>→</mo><mi>q</mi><mo stretchy=\"false\">)</mo><mtext>かつ</mtext><mi>p</mi><mo stretchy=\"false\">)</mo><mo>→</mo><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">((p \\rightarrow q) かつ p) \\rightarrow q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">((</span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mclose\">)</span><span class=\"mord cjk_fallback\">かつ</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span> をIdrisの型で，またその証明をIdrisのプログラムで表現したもの</strong> になっているんです．</p>\n<div class=\"gatsby-highlight\" data-language=\"idris\"><pre class=\"language-idris\"><code class=\"language-idris\"><span class=\"token hvariable\">modusPonens</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token hvariable\">p</span> <span class=\"token operator\">-></span> <span class=\"token hvariable\">q</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">p</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token hvariable\">q</span>\n<span class=\"token hvariable\">modusPonens</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">hpq</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">hp</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">hpq</span> <span class=\"token hvariable\">hp</span></code></pre></div>\n<p>以下のような論理とコードの対応関係は，<a href=\"https://ja.wikipedia.org/wiki/%E3%82%AB%E3%83%AA%E3%83%BC%EF%BC%9D%E3%83%8F%E3%83%AF%E3%83%BC%E3%83%89%E5%90%8C%E5%9E%8B%E5%AF%BE%E5%BF%9C\">カリー＝ハワード同型対応</a>として知られています．</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">論理</th>\n<th align=\"left\">Idris</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"left\">命題</td>\n<td align=\"left\">型</td>\n</tr>\n<tr>\n<td align=\"left\">証明</td>\n<td align=\"left\">プログラム</td>\n</tr>\n<tr>\n<td align=\"left\">かつ</td>\n<td align=\"left\">タプル<code class=\"language-text\">(要素1, 要素2…)</code></td>\n</tr>\n<tr>\n<td align=\"left\"><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\rightarrow</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span></span> （ならば）</td>\n<td align=\"left\">関数型<code class=\"language-text\">引数 -> 戻り値</code></td>\n</tr>\n</tbody>\n</table>\n<p>つまり今回の命題は</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">論理</th>\n<th align=\"left\">Idris</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"left\"><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">(</mo><mi>p</mi><mo>→</mo><mi>q</mi><mo stretchy=\"false\">)</mo><mtext>かつ</mtext><mi>p</mi><mo stretchy=\"false\">)</mo><mo>→</mo><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">((p \\rightarrow q) かつ p) \\rightarrow q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">((</span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mclose\">)</span><span class=\"mord cjk_fallback\">かつ</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span></td>\n<td align=\"left\"><code class=\"language-text\">((p -> q), p) -> q</code></td>\n</tr>\n</tbody>\n</table>\n<p>と対応します．</p>\n<p>カリー＝ハワード同型対応により， <strong>ある命題の証明を書く</strong> のは， <strong>ある型のプログラムを書く</strong> のと同じだとわかります．示したい命題に対応する型のプログラムが書ければ，もとの命題を示したことになるわけです．</p>\n<h3 id=\"コードができるまで\" style=\"position:relative;\"><a href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%8C%E3%81%A7%E3%81%8D%E3%82%8B%E3%81%BE%E3%81%A7\" aria-label=\"コードができるまで permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>コードができるまで</h3>\n<p>以上を踏まえて，今回のコードが書かれるまでを追ってみます．</p>\n<p>示したい命題：<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">(</mo><mi>p</mi><mo>→</mo><mi>q</mi><mo stretchy=\"false\">)</mo><mtext>かつ</mtext><mi>p</mi><mo stretchy=\"false\">)</mo><mo>→</mo><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">((p \\rightarrow q) かつ p) \\rightarrow q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">((</span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mclose\">)</span><span class=\"mord cjk_fallback\">かつ</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span> にカリー＝ハワード同型対応する型は<code class=\"language-text\">((p -> q), p) -> q</code>です．</p>\n<p>これは関数型なので，そのような型が付く<code class=\"language-text\">modusPonens</code>という関数を実装できれば証明完了です．ここまでで，以下のところまで書けます．</p>\n<div class=\"gatsby-highlight\" data-language=\"idris\"><pre class=\"language-idris\"><code class=\"language-idris\"><span class=\"token hvariable\">modusPonens</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token hvariable\">p</span> <span class=\"token operator\">-></span> <span class=\"token hvariable\">q</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">p</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token hvariable\">q</span>\n<span class=\"token hvariable\">modusPonens</span> <span class=\"token operator\">...</span>ここを埋める<span class=\"token operator\">...</span></code></pre></div>\n<p>肝心の<code class=\"language-text\">modusPonens</code>の実装を考えてみます．ここでの目標は「<code class=\"language-text\">q</code>型の値」を返すことです．いま，「<code class=\"language-text\">(p -> q)</code>型の値」と「<code class=\"language-text\">p</code>型の値」がもらえるので，単純に<code class=\"language-text\">p</code>を<code class=\"language-text\">(p -> q)</code>へ渡してしまえば「<code class=\"language-text\">q</code>型の値」が得られます． <strong>これが証明です</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"idris\"><pre class=\"language-idris\"><code class=\"language-idris\"><span class=\"token hvariable\">modusPonens</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token hvariable\">p</span> <span class=\"token operator\">-></span> <span class=\"token hvariable\">q</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">p</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token hvariable\">q</span>\n<span class=\"token hvariable\">modusPonens</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">hpq</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">hp</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">hpq</span> <span class=\"token hvariable\">hp</span></code></pre></div>\n<p><code class=\"language-text\">hpq</code>や<code class=\"language-text\">hp</code>にどのような値が来ようが，<code class=\"language-text\">modusPonens</code>は100％確実に<code class=\"language-text\">q</code>型の値を返します．このことは，型検査で容易に確かめられます．</p>\n<p>そして実際に，このコードを<code class=\"language-text\">idris --check</code>で型検査すると成功しますので，先程の論理構造は正しいと証明されました．ご結婚おめでとうございます．</p>\n<h3 id=\"ウォーミングアップまとめ\" style=\"position:relative;\"><a href=\"#%E3%82%A6%E3%82%A9%E3%83%BC%E3%83%9F%E3%83%B3%E3%82%B0%E3%82%A2%E3%83%83%E3%83%97%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"ウォーミングアップまとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ウォーミングアップまとめ</h3>\n<p>今回のお題は自明すぎて，</p>\n<p><em>なぜこんなに回りくどいことをする必要があるのか？</em></p>\n<p>と思われたかもしれません．簡単すぎて依存型の出番もなく，イマイチしっくりきていないのも事実です．</p>\n<p>というわけで，もうちょっと難しい <strong>実践編</strong> で依存型に触れてみましょう．</p>\n<h2 id=\"実践編高校数学\" style=\"position:relative;\"><a href=\"#%E5%AE%9F%E8%B7%B5%E7%B7%A8%E9%AB%98%E6%A0%A1%E6%95%B0%E5%AD%A6\" aria-label=\"実践編高校数学 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実践編：高校数学</h2>\n<p>想像してください．我々は高校生で，今は数学の試験中です．</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 728px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/82c1a735590a9195678fcc43a66b12fe/289e0/study1.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.31868131868132%; position: relative; bottom: 0; left: 0; background-image: url('data:image/svg+xml,%3csvg%20xmlns=\\'http://www.w3.org/2000/svg\\'%20width=\\'400\\'%20height=\\'225\\'%20viewBox=\\'0%200%20400%20225\\'%20preserveAspectRatio=\\'none\\'%3e%3cpath%20d=\\'M160%2017c-4%202-15%2012-15%2013l-2%204c-3%203-5%209-3%2012l1%205h5l-2%202c-2%202-3%203%200%206l2%207c0%2011%201%2025%204%2035%203%2011%203%2011%202%205V85l1%203%202%2012a398%20398%200%20014%2038l-2-2c-2-1-2-1-3%202l-1%204v-1c1-4-6-2-9%202l-6%202-11%204-10%201c-4%200-5%200-5%202l-2%202%2015%201a150%20150%200%200042-2c11%200%2013-1%2015-12l1-4c1%201%202-6%201-10l-1-7%208-31v-5l-1-3h3a92%2092%200%20001%208l4%201%201%202%201%203v2c0%202%201%202%202%202%201-1%202%200%202%201v2c-2%200-3%203-2%204l3%201c4-1%206%200%206%202%200%201-1%202-5%202-8%201-11%203-11%205%201%201%200%204-1%205l-2%206-1%203-5%2012c-4%2011-6%2013-10%2013l-8%204-4%201c-4%200-4%200-1-1%202-1%202-1-2-1h-2l2-1h-2l-4%201v1c4%200%200%203-4%203l-13%202h-2l-3-1-1%202c1%202-9%201-12-1-1-2-3-3-5-3l-3-1-5-1c-3%200-4%200-3-1l-2-1-3%202h-2l2-1c1-1%201-1-1-1l-2%201-4%201-3%201%204%201c3%200%205%202%201%202-5%200-7%202-4%203%202%201%202%201%200%201l-3-2c-5-5-6%201-2%209l4%209%202%204-4-1c-5%200-7%201-5%204%201%201%201%202%202%201s6%200%208%203c2%202%206%202%2015%200l2%201-2%201c-1%201-1%201%201%201l2-1%203-3c2-1%202-1%202%201-1%202%200%203%202%201s1-4%200-3l-2-1%201-1%2012-3a15743%2015743%200%200137-14l15-6c2%200%204%200%203%201l-9%204c-3%204-14%209-19%209-3%200-23%208-24%209h-2c0-1-9%201-9%203l-7%2010c-2%203-2%205%202%209%203%203%206%203%2011%201l7-2c2%200%203-1%201-6-2-3-2-3%201-3l2%202%202-3%204-4h5c4%200%204%200%202%201-2%202-3%203%2020-2%2027-6%2026-6%2030-3%202%203%204%204%209%205%208%201%209%203%203%204-5%200-5%202%200%202%203%200%204%201%207%203%203%204%204%204%209%203h9l-7%201-8%203h-7l-26%201c-21%200-24%200-26%202-1%202-17%201-19-2l-4-2c-2%200-3-1-3-4l-1-3v3c0%203%200%204-4%205-3%200-6%202-7%203l-3%202c-2%200-1%203%201%204a4117%204117%200%2000249%202c3%200%203%200%202-4%200-5-1-5%209-11l7-4%201%201h1l4%2010%204%209v-11c0-9%200-10-2-11-2%200-3-4-1-4l1%201%201%201v-13c0-2%200-2%201-1l1-4-1-79V30l-4-1c-5-1-11-1-15%202l-3%201-6%204c-4%203-4%204-4%209l-1%209-1%2022c0%2020-1%2036-3%2037v-12c2-11%201-14-3-15-2%200-9%206-11%2011l-3%203-1%202-3%208c-4%206-5%208-3%208v2h-3c-1%203-1%203%201%202l1%201-3%201-3-1c-2%201-2%201-1%202h3l1%201c0%202%2013%207%2020%209l24%2010-13-4a2760%202760%200%2000-33-10h2l-2-1c-2%200-4-3-5-5-2-5-2-6%202-6l2-1h-4c-4%200-4%200-6-5l-5-8c-2%200-3-2-3-2l-3-2c-3-2-3-2-2-5%200-3-1-4-2-1s-2%203-5%200l-4-2-5-3c-4-4-9-6-12-6l-2-1c-1-2-3-2-3%200l-6%201c-4-1-5%200-5%201v1c-2-1-7%202-7%203l-4%202c-3%201-3%201-5-1l-2-2-4-6c-4-9-5-10-5-14-1-5%201-4%204%202l4%205%202%202%202%201%202%201%203%201c3%200%203%200%202-1l-4-7-6-12-5-10c-3-9-12-19-18-21-5-3-9-2-13%200l-6%204-3%201-13%206-2-2-1-4-2-4c-3-9-16-16-24-13m-31%2010c-9%2010-10%2014-5%2021%202%202%203%204%203%207%200%204%203%206%205%204%202-1%205%202%205%204s0%202%202-1c2-2%202-3%201-4l-2-6-1-9-1-2v2c0%204-2%206-2%202%200-6%202-11%208-17%207-7%206-8-2-8-3%200-5%201-11%207m102%2052l-4%201c1%200%203%205%203%209l3%205%201%208-1%204%204-8%202-5%203-4-6-11-5%201m142%2036l-5%2011-5%207c0%201%202%202%207%203%203%202%208-9%208-18%200-12-1-13-5-3M68%20133l3%207%205%208c2%204%204%206%205%205v-2c0-2%201-3%207-3l8-2%205-1%203-2c1-2%202-2%202%201%200%202%200%202%208%202l14-1c6-1%2015-5%2012-6-5-2-15-1-30%202-3%200-3%200-3-5%201-5-1-5-2%201-1%204-1%204-15%206l-9-1-1-1-6-6c-5-7-6-8-6-2m278%2023c-1%203%208%209%2014%209%203%200%203%201%204%203%202%203%203%203%205-2%202-4%202-4%200-4l-1-1-2-1-1-1c1-1-12-5-15-5l-4%202M51%20179l-16%201-15%202-9%201c-7%200-10%201-10%204%200%202%200%202%206%201%2034-3%2061-6%2057-7s-4-2%201-2c2%200%203%200%203%202l1%201%201-2c0-2-8-3-19-1m159%203l-1%202%201%204%201%204%201-5c0-5%201-7%203-4%202%202%202%208%200%2010-2%201-2%201%200%201s4-5%204-8c-1-2%201-3%201-1h3l3%203%202%202%201%201c2%200%201-2-2-5l-2-3-5-2c-8-2-7-2-10%201\\'%20fill=\\'%23d3d3d3\\'%20fill-rule=\\'evenodd\\'/%3e%3c/svg%3e'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/82c1a735590a9195678fcc43a66b12fe/f4a91/study1.webp 728w,\n/static/82c1a735590a9195678fcc43a66b12fe/223e5/study1.webp 1280w\"\n              sizes=\"(max-width: 728px) 100vw, 728px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/82c1a735590a9195678fcc43a66b12fe/83881/study1.jpg 728w,\n/static/82c1a735590a9195678fcc43a66b12fe/289e0/study1.jpg 1280w\"\n            sizes=\"(max-width: 728px) 100vw, 728px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/82c1a735590a9195678fcc43a66b12fe/83881/study1.jpg\"\n            alt=\"教室でテストを受ける外国人のフリー素材\"\n            title=\"教室でテストを受ける外国人のフリー素材\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h3 id=\"問題\" style=\"position:relative;\"><a href=\"#%E5%95%8F%E9%A1%8C\" aria-label=\"問題 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>問題</h3>\n<blockquote>\n<p><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span> が自然数であるとき，次の等式が成り立つことを証明せよ．</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mn>1</mn><mo>+</mo><mn>2</mn><mo>+</mo><mn>3</mn><mo>+</mo><mo>⋯</mo><mo>+</mo><mi>n</mi><mo>=</mo><mfrac><mrow><mi>n</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></mfrac></mrow><annotation encoding=\"application/x-tex\">1 + 2 + 3 + \\cdots + n = \\frac{n(n + 1)}{2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.113em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></div>\n<p>出典：<a href=\"https://www.geisya.or.jp/~mwm48961/kou2/inductive_method4.htm#A1\">https://www.geisya.or.jp/~mwm48961/kou2/inductive_method4.htm#A1</a></p>\n</blockquote>\n<p>――――――</p>\n<p>――――</p>\n<p>――</p>\n<p>よし， <em>「Idrisで回答するな」</em> とは書かれていない．</p>\n<h3 id=\"idrisで証明していく\" style=\"position:relative;\"><a href=\"#idris%E3%81%A7%E8%A8%BC%E6%98%8E%E3%81%97%E3%81%A6%E3%81%84%E3%81%8F\" aria-label=\"idrisで証明していく permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Idrisで証明していく</h3>\n<h4 id=\"総和関数の実装\" style=\"position:relative;\"><a href=\"#%E7%B7%8F%E5%92%8C%E9%96%A2%E6%95%B0%E3%81%AE%E5%AE%9F%E8%A3%85\" aria-label=\"総和関数の実装 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>総和関数の実装</h4>\n<p>はじめに，問題中にある総和関数 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>+</mo><mn>2</mn><mo>+</mo><mn>3</mn><mo>+</mo><mo>⋯</mo><mo>+</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1 + 2 + 3 + \\cdots + n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span> を次のように実装します．</p>\n<div class=\"gatsby-highlight\" data-language=\"idris\"><pre class=\"language-idris\"><code class=\"language-idris\"><span class=\"token hvariable\">sum</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Nat</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Nat</span>\n<span class=\"token hvariable\">sum</span> <span class=\"token constant\">Z</span> <span class=\"token operator\">=</span> <span class=\"token constant\">Z</span>\n<span class=\"token hvariable\">sum</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span> <span class=\"token operator\">+</span> <span class=\"token hvariable\">sum</span> <span class=\"token hvariable\">k</span></code></pre></div>\n<p>ここでは，Idrisの標準ライブラリにある自然数型<code class=\"language-text\">Nat</code>を使用しています．<code class=\"language-text\">Z</code>は <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></span> の値，<code class=\"language-text\">S</code>は後者関数で <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">+ 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">+</span><span class=\"mord\">1</span></span></span></span></span> の意味です．例えば，<code class=\"language-text\">S S Z</code>は <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span></span> を表します．</p>\n<p>総和関数<code class=\"language-text\">sum</code>は，「自然数<code class=\"language-text\">n</code>」を受け取って，「<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></span> から<code class=\"language-text\">n</code>までの合計の自然数」を返すため，<code class=\"language-text\">Nat -> Nat</code>型が付きます．</p>\n<p>プログラム本体は2つのパターンで書いています．<code class=\"language-text\">sum Z = Z</code>のパターンでは，</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>s</mi><mi>u</mi><mi>m</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">sum(0) = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></span></div>\n<p>を定義しています．自明ですね．</p>\n<p><code class=\"language-text\">sum (S k) = S k + sum k</code>のパターンでは，</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>s</mi><mi>u</mi><mi>m</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>n</mi><mo>+</mo><mi>s</mi><mi>u</mi><mi>m</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">sum(n) = n + sum(n - 1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></span></div>\n<p>のように，再帰的な定義を採用しています．<code class=\"language-text\">sum</code>の第1引数を<code class=\"language-text\">S k</code>の形で受け取っているので，<code class=\"language-text\">k</code>は<code class=\"language-text\">第1引数 - 1</code>の数になるのがポイントです．</p>\n<p>実際に動くのかIdrisのREPLで確かめてみます．</p>\n<div class=\"gatsby-highlight\" data-language=\"idris\"><pre class=\"language-idris\"><code class=\"language-idris\"><span class=\"token operator\">*></span> <span class=\"token hvariable\">sum</span> <span class=\"token number\">0</span>\n<span class=\"token number\">0</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Nat</span>\n\n<span class=\"token operator\">*></span> <span class=\"token hvariable\">sum</span> <span class=\"token number\">2</span>\n<span class=\"token number\">3</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Nat</span>\n\n<span class=\"token operator\">*></span> <span class=\"token hvariable\">sum</span> <span class=\"token number\">10</span>\n<span class=\"token number\">55</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Nat</span></code></pre></div>\n<p>いいですね！</p>\n<h4 id=\"依存型で命題を書く\" style=\"position:relative;\"><a href=\"#%E4%BE%9D%E5%AD%98%E5%9E%8B%E3%81%A7%E5%91%BD%E9%A1%8C%E3%82%92%E6%9B%B8%E3%81%8F\" aria-label=\"依存型で命題を書く permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>依存型で命題を書く</h4>\n<p>ではさっそく，総和関数を用いて命題を型で表しましょう，と言いたいところですが，ここでちょっとおまじないをさせてください．等式の両辺を2倍して分母を払います．</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>+</mo><mn>2</mn><mo>+</mo><mn>3</mn><mo>+</mo><mo>⋯</mo><mo>+</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mo>×</mo><mn>2</mn><mo>=</mo><mi>n</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(1 + 2 + 3 + \\cdots + n) \\times 2 = n(n + 1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></span></div>\n<p>というのも，命題に割り算を使ってしまうと証明が結構複雑になりそうだからです．ゼロ除算やら切り捨てやらを考えないためです．</p>\n<p>さて，では気を取り直して，今度こそ上記の命題を型で表してみましょう． <strong>依存型を使用して</strong> 以下のように書けます．</p>\n<div class=\"gatsby-highlight\" data-language=\"idris\"><pre class=\"language-idris\"><code class=\"language-idris\"><span class=\"token punctuation\">(</span><span class=\"token hvariable\">n</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Nat</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">sum</span> <span class=\"token hvariable\">n</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">n</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">n</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>日本語で読むと「ある自然数<code class=\"language-text\">n</code>を受け取り，『<code class=\"language-text\">(sum n) * 2</code>型と<code class=\"language-text\">n * (n + 1)</code>型が等しいという型』を返す関数型」となります．</p>\n<p>注目すべきは，<code class=\"language-text\">n</code>が<code class=\"language-text\">Nat</code>型の <strong>値</strong> であることです．この関数型の <strong>戻り値の型<code class=\"language-text\">(sum n) * 2 = n * (n + 1)</code>は，引数の<code class=\"language-text\">n</code>という値に依存しています．</strong> つまり，プログラム（値）に依存した型，依存型です．<sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup></p>\n<p>返り値の型を更に詳しく見て行きましょう．まず，<code class=\"language-text\">=</code>というのは「両辺の型が等しいこと」を表す，主に証明系で使われる型です．次に，我々が普段プログラムの世界で使用している<code class=\"language-text\">+</code>と<code class=\"language-text\">*</code>ですが，自然数の加算・乗算として型の中に書けちゃいます．また，先ほど我々が定義した，正真正銘プログラムであるはずの<code class=\"language-text\">sum</code>関数もまた，しれっと型の中に書けています．依存型の中では，型とプログラムのどっちを書いているのか混乱しますね……．</p>\n<p><code class=\"language-text\">Nat</code>という自然数全体ではなく，ある特定の自然数<code class=\"language-text\">n</code>に型が依存することで，<code class=\"language-text\">(sum n) * 2 = n * (n + 1)</code>のような等式を表現できました．</p>\n<p>これが依存型のパワー……！この驚くべき表現力によって様々な命題を型に変換し，ついには<a href=\"https://ja.wikipedia.org/wiki/%E5%9B%9B%E8%89%B2%E5%AE%9A%E7%90%86#%E8%A8%BC%E6%98%8E\">数学の難問もコード上で証明してしまった</a>というのですからヤバすぎます．</p>\n<h4 id=\"証明を書こう\" style=\"position:relative;\"><a href=\"#%E8%A8%BC%E6%98%8E%E3%82%92%E6%9B%B8%E3%81%93%E3%81%86\" aria-label=\"証明を書こう permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>証明を書こう</h4>\n<p>それでは<code class=\"language-text\">(n : Nat) -> (sum n) * 2 = n * (n + 1)</code>型の値を書いていきます．これは関数型なので関数を宣言するために</p>\n<div class=\"gatsby-highlight\" data-language=\"idris\"><pre class=\"language-idris\"><code class=\"language-idris\"><span class=\"token hvariable\">p</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">n</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Nat</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">sum</span> <span class=\"token hvariable\">n</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">n</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">n</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token hvariable\">p</span> <span class=\"token operator\">...</span>ここを埋める<span class=\"token operator\">...</span></code></pre></div>\n<p>と書きます．<code class=\"language-text\">p</code>は <strong>p</strong> roposition（命題）の略として命名しました．</p>\n<p>ここでは数学的帰納法を用います．つまり関数<code class=\"language-text\">p</code>が呼び出されるパターンを，第1引数<code class=\"language-text\">Nat</code>によって，<code class=\"language-text\">Z</code>と<code class=\"language-text\">S k</code>に分けて考えていきます．</p>\n<h5 id=\"p-zの場合\" style=\"position:relative;\"><a href=\"#p-z%E3%81%AE%E5%A0%B4%E5%90%88\" aria-label=\"p zの場合 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">p Z</code>の場合</h5>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi>s</mi><mi>u</mi><mi>m</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>×</mo><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>0</mn><mo>×</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mn>0</mn><mo>×</mo><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>0</mn><mo>×</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\nsum(0) \\times 2 &#x26;= 0 \\times (0 + 1) \\\\\n0 \\times 2 &#x26;= 0 \\times 1 \\\\\n0 &#x26;= 0 \\\\\n\\end{aligned}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.5em;vertical-align:-2em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.5em;\"><span style=\"top:-4.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">2</span></span></span><span style=\"top:-3.16em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">2</span></span></span><span style=\"top:-1.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.5em;\"><span style=\"top:-4.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.16em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-1.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2em;\"><span></span></span></span></span></span></span></span></span></span></span></span></div>\n<p>なので自明ですね．このような場合次のように書きます．</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\"><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span>p: (n : Nat) -> (sum n) * 2 = n * (n + 1)\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>p Z = Refl</span></code></pre></div>\n<p>Reflという名前は反射関係（reflexive relation）に由来すると思われます．</p>\n<h5 id=\"p-s-kの場合\" style=\"position:relative;\"><a href=\"#p-s-k%E3%81%AE%E5%A0%B4%E5%90%88\" aria-label=\"p s kの場合 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">p (S k)</code>の場合</h5>\n<p>帰納法なので，<code class=\"language-text\">p k</code>を仮定して<code class=\"language-text\">p (S k)</code>を示します．</p>\n<p>とりあえず帰納法の仮定<code class=\"language-text\">inductiveHypothesis</code>をローカル変数で宣言します．あとから必要になるはず．</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\"><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span>p: (n : Nat) -> (sum n) * 2 = n * (n + 1)\n<span class=\"token prefix unchanged\"> </span>p Z = Refl\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>p (S k) =\n<span class=\"token prefix inserted\">+</span>  let inductiveHypothesis = p k in\n<span class=\"token prefix inserted\">+</span>    ...ここを埋める...</span></code></pre></div>\n<p>そしてここから証明を書いていくわけですが，</p>\n<p>今回は，これまでの <strong>実際にプログラムを書く</strong> 方法ではなく <strong>タクティク</strong> を連ねることで証明を行います．</p>\n<p>タクティクとは証明戦略とも呼ばれ，型検査器に様々な指示を与えます．例えば，命題の式を整理したり変形したりできます．（すみません，ここらへんよくわかっていません）</p>\n<p>この指示を繰り返すことで型検査器を誘導し，「あ，この命題は自明っす」と言わせてみましょう．</p>\n<p>まず，コードを次のように変更します．</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\"><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span>p: (n : Nat) -> (sum n) * 2 = n * (n + 1)\n<span class=\"token prefix unchanged\"> </span>p Z = Refl\n<span class=\"token prefix unchanged\"> </span>p (S k) =\n<span class=\"token prefix unchanged\"> </span>  let inductiveHypothesis = p k in\n</span><span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span>    ...ここを埋める...\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>    ?proofP</span></code></pre></div>\n<p>これにより，Idrisに「<code class=\"language-text\">proofP</code>部分の証明を手伝ってや〜」と伝えられます．</p>\n<p>REPLを起動して，<code class=\"language-text\">:prove proofP</code>でインタラクティブ証明モードを起動します．<sup id=\"fnref-2\"><a href=\"#fn-2\" class=\"footnote-ref\">2</a></sup> 現在の証明の状態が以下のように表示されました．</p>\n<div class=\"gatsby-highlight\" data-language=\"idris\"><pre class=\"language-idris\"><code class=\"language-idris\"><span class=\"token comment\">----------                 Goal:                  ----------</span>\n<span class=\"token punctuation\">{</span><span class=\"token hvariable\">hole_0</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">k</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Nat</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">sum</span> <span class=\"token hvariable\">k</span> <span class=\"token operator\">*</span> <span class=\"token hvariable\">fromInteger</span> <span class=\"token number\">2</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">k</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">k</span> <span class=\"token operator\">+</span> <span class=\"token hvariable\">fromInteger</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">sum</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><em>なにがなんだか</em></p>\n<p>まぁ落ち着いて<code class=\"language-text\">intros</code>という呪文（タクティク）を唱えます．すると</p>\n<div class=\"gatsby-highlight\" data-language=\"idris\"><pre class=\"language-idris\"><code class=\"language-idris\"><span class=\"token comment\">----------              Assumptions:              ----------</span>\n <span class=\"token hvariable\">k</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Nat</span>\n <span class=\"token hvariable\">inductiveHypothesis</span> <span class=\"token operator\">:</span> <span class=\"token hvariable\">sum</span> <span class=\"token hvariable\">k</span> <span class=\"token operator\">*</span> <span class=\"token hvariable\">fromInteger</span> <span class=\"token number\">2</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">k</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">k</span> <span class=\"token operator\">+</span> <span class=\"token hvariable\">fromInteger</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">----------                 Goal:                  ----------</span>\n<span class=\"token punctuation\">{</span><span class=\"token hvariable\">hole_2</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">:</span> <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">sum</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>仮定（Assumptions）が現れました．ここでは<code class=\"language-text\">k</code>が自然数<code class=\"language-text\">Nat</code>であることと，帰納法の仮定<code class=\"language-text\">inductiveHypothesis</code>が使えます．<code class=\"language-text\">inductiveHypothesis</code>の型<code class=\"language-text\">sum k * fromInteger 2 = k * (k + fromInteger 1)</code>は，ちゃんと<code class=\"language-text\">p k</code>型になっています．あたりまえですね．</p>\n<p>示したい命題（Goal）は，ちょっと複雑ですが<code class=\"language-text\">p (S k)</code>になっています．Idrisがある程度式変形してくれているのでごちゃごちゃしているだけです．数式で書いて元の<code class=\"language-text\">p (S k)</code>に戻してみましょう．</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mn>2</mn><mo stretchy=\"false\">(</mo><mi>k</mi><mo>+</mo><mi>s</mi><mi>u</mi><mi>m</mi><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>+</mo><mn>1</mn><mo>+</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>+</mo><mi>k</mi><mo stretchy=\"false\">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mn>2</mn><mi>k</mi><mo>+</mo><mn>2</mn><mi>s</mi><mi>u</mi><mi>m</mi><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mn>1</mn><mo>+</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>+</mo><mi>k</mi><mo stretchy=\"false\">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mn>2</mn><mi>k</mi><mo>+</mo><mn>2</mn><mi>s</mi><mi>u</mi><mi>m</mi><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>+</mo><mi>k</mi><mo stretchy=\"false\">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mn>2</mn><mo stretchy=\"false\">(</mo><mi>s</mi><mi>u</mi><mi>m</mi><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mo stretchy=\"false\">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>+</mo><mi>k</mi><mo stretchy=\"false\">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mn>2</mn><mi>s</mi><mi>u</mi><mi>m</mi><mo stretchy=\"false\">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>+</mo><mi>k</mi><mo stretchy=\"false\">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mn>2</mn><mi>s</mi><mi>u</mi><mi>m</mi><mo stretchy=\"false\">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>k</mi><mo stretchy=\"false\">(</mo><mi>k</mi><mo>+</mo><mn>2</mn><mo stretchy=\"false\">)</mo><mo>+</mo><mo stretchy=\"false\">(</mo><mi>k</mi><mo>+</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mn>2</mn><mi>s</mi><mi>u</mi><mi>m</mi><mo stretchy=\"false\">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mo stretchy=\"false\">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mi>k</mi><mo>+</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n2(k + sum(k)) + 1 + 1 &#x26;= k + 1 + k(k + 1 + 1) + 1 \\\\\n2k + 2sum(k) + 1 + 1 &#x26;= k + 1 + k(k + 1 + 1) + 1 \\\\\n2k + 2sum(k) + 2 &#x26;= k + 1 + k(k + 1 + 1) + 1 \\\\\n2(sum(k) + (k + 1)) &#x26;= k + 1 + k(k + 1 + 1) + 1 \\\\\n2sum(k + 1) &#x26;= k + 1 + k(k + 1 + 1) + 1 \\\\\n2sum(k + 1) &#x26;= k(k + 2) + (k + 2) \\\\\n2sum(k + 1) &#x26;= (k + 1)(k + 2) \\\\\n\\end{aligned}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:10.5em;vertical-align:-5em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.5em;\"><span style=\"top:-7.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">))</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-6.16em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-4.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">2</span></span></span><span style=\"top:-3.16em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">))</span></span></span><span style=\"top:-1.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span><span style=\"top:-0.16em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span><span style=\"top:1.34em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.5em;\"><span style=\"top:-7.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-6.16em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-4.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-3.16em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-1.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-0.16em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">)</span></span></span><span style=\"top:1.34em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5em;\"><span></span></span></span></span></span></span></span></span></span></span></span></div>\n<p>よし，確かに戻りました．</p>\n<p>さて，ここからの証明では<code class=\"language-text\">rewrite</code>という呪文をめっちゃ唱えます．これは式変形を行ってくれるタクティクです．試しに1つ唱えてみましょう．<code class=\"language-text\">rewrite sym (multRightSuccPlus k (k + 1))</code>！</p>\n<p>するとゴールのようすが…？</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\"><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span>----------              Assumptions:              ----------\n<span class=\"token prefix unchanged\"> </span> k : Nat\n<span class=\"token prefix unchanged\"> </span> inductiveHypothesis : sum k * fromInteger 2 = k * (k + fromInteger 1)\n<span class=\"token prefix unchanged\"> </span>----------                 Goal:                  ----------\n</span><span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span>{hole_2} : S (S (mult (plus k (sum k)) 2)) = S (plus (plus k 1) (mult k (S (plus k 1))))\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>{hole_3} : S (S (mult (plus k (sum k)) 2)) = S (plus (plus k 1) (plus k (mult k (plus k 1))))</span></code></pre></div>\n<p>変わった！右辺の一部で</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>k</mi><mo>×</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>+</mo><mo stretchy=\"false\">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mspace linebreak=\"newline\"></mspace><mi>k</mi><mo>+</mo><mi>k</mi><mo stretchy=\"false\">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">k \\times (1 + (k + 1)) \\\\\nk + k(k + 1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">))</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></span></div>\n<p>みたいな変形が起こりました．これを可能にしたのがIdrisの標準ライブラリにある<code class=\"language-text\">multRightSuccPlus</code>という定理です．</p>\n<blockquote>\n<div class=\"gatsby-highlight\" data-language=\"idris\"><pre class=\"language-idris\"><code class=\"language-idris\"><span class=\"token hvariable\">multRightSuccPlus</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">left</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">right</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Nat</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token hvariable\">left</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">right</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">left</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">left</span> <span class=\"token operator\">*</span> <span class=\"token hvariable\">right</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>出典：<a href=\"https://github.com/idris-lang/Idris-dev/blob/master/libs/prelude/Prelude/Nat.idr#L526\">https://github.com/idris-lang/Idris-dev/blob/master/libs/prelude/Prelude/Nat.idr#L526</a></p>\n</blockquote>\n<p>multRightSuccPlusに<code class=\"language-text\">k</code>と<code class=\"language-text\">(k + 1)</code>を与えると<code class=\"language-text\">k * (S (k + 1)) = k + (k * (k + 1))</code>型が返ります．<code class=\"language-text\">rewrite</code>は<code class=\"language-text\">=</code>型を受け取り，ゴールの中から右辺のパターンを見つけて左辺に書き換えます．ただし今回の場合は逆をやってほしかったので，<code class=\"language-text\">sym</code>を使って等式の左右を反転しています．</p>\n<blockquote>\n<div class=\"gatsby-highlight\" data-language=\"idris\"><pre class=\"language-idris\"><code class=\"language-idris\"><span class=\"token hvariable\">sym</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token hvariable\">left</span><span class=\"token operator\">:</span><span class=\"token hvariable\">a</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span><span class=\"token hvariable\">right</span><span class=\"token operator\">:</span><span class=\"token hvariable\">b</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">-></span> <span class=\"token hvariable\">left</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">right</span> <span class=\"token operator\">-></span> <span class=\"token hvariable\">right</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">left</span></code></pre></div>\n<p>出典：<a href=\"https://github.com/idris-lang/Idris-dev/blob/master/libs/prelude/Builtins.idr#L95\">https://github.com/idris-lang/Idris-dev/blob/master/libs/prelude/Builtins.idr#L95</a></p>\n</blockquote>\n<p>ちなみに，multRightSuccPlusの証明はもっと簡単な定理で構成されていて，それは更に簡単な定理で…というように続き，最終的には「自然数の定義より自明」となるところで終わります．</p>\n<p>厳密な演繹をコマンドで簡単に実行できるのは便利ですね．</p>\n<p>標準ライブラリには，他にも証明済みの定理がたくさん入っています．今回は，それらを使って式変形していくことで<code class=\"language-text\">(左辺) = (右辺)</code>を示せます．最終的な式変形は以下のとおりです．</p>\n<div class=\"gatsby-highlight\" data-language=\"idris\"><pre class=\"language-idris\"><code class=\"language-idris\">                         <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">sum</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                         <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">sum</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                         <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">sum</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                         <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">sum</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                         <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">sum</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                         <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">sum</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">sum</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n             <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                  <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n         <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n         <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                  <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                  <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>実行した<code class=\"language-text\">rewrite</code>は</p>\n<div class=\"gatsby-highlight\" data-language=\"idris\"><pre class=\"language-idris\"><code class=\"language-idris\"><span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">sym</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">multRightSuccPlus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">k</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">-- 右辺の変形開始</span>\n<span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">plusCommutative</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">plusCommutative</span> <span class=\"token number\">1</span> <span class=\"token hvariable\">k</span>\n<span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">plusSuccRightSucc</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token hvariable\">k</span>\n<span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">plusCommutative</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">sym</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">multDistributesOverPlusLeft</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">sum</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">-- 左辺の変形開始</span>\n<span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">sym</span> <span class=\"token hvariable\">inductiveHypothesis</span> <span class=\"token comment\">-- ここで帰納法の仮定を使った</span>\n<span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">plusCommutative</span> <span class=\"token number\">1</span> <span class=\"token hvariable\">k</span>\n<span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">sym</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">multRightSuccPlus</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">sym</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">multRightSuccPlus</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">sym</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">multZeroRightZero</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">sym</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plusZeroRightNeutral</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">plusAssociative</span> <span class=\"token hvariable\">k</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>となりました．結論の等式が汚いのは，できるだけ少ないステップ数で証明を完了したかったからですごめんなさい．</p>\n<p>まぁともかく，両辺が等しくなったので<code class=\"language-text\">trivial</code>タクティクを実行します．すると，示すべきゴールがなくなります．（つまり自明）</p>\n<div class=\"gatsby-highlight\" data-language=\"idris\"><pre class=\"language-idris\"><code class=\"language-idris\"><span class=\"token operator\">-</span><span class=\"token hvariable\">Main<span class=\"token punctuation\">.</span>proofP</span><span class=\"token operator\">></span> <span class=\"token hvariable\">trivial</span>\n<span class=\"token hvariable\">proofP</span><span class=\"token operator\">:</span> <span class=\"token constant\">No</span> <span class=\"token hvariable\">more</span> <span class=\"token hvariable\">goals</span><span class=\"token punctuation\">.</span></code></pre></div>\n<p>最後に満を持して<code class=\"language-text\">qed</code>コマンドを打てば……</p>\n<div class=\"gatsby-highlight\" data-language=\"idris\"><pre class=\"language-idris\"><code class=\"language-idris\"><span class=\"token operator\">-</span><span class=\"token hvariable\">Main<span class=\"token punctuation\">.</span>proofP</span><span class=\"token operator\">></span> <span class=\"token hvariable\">qed</span>\n<span class=\"token constant\">Proof</span> <span class=\"token hvariable\">completed</span><span class=\"token operator\">!</span></code></pre></div>\n<p>――――――</p>\n<p>――――</p>\n<p>――</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 728px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bc90cc72896c64fad5161ea66602b9a6/289e0/study2.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.31868131868132%; position: relative; bottom: 0; left: 0; background-image: url('data:image/svg+xml,%3csvg%20xmlns=\\'http://www.w3.org/2000/svg\\'%20width=\\'400\\'%20height=\\'225\\'%20viewBox=\\'0%200%20400%20225\\'%20preserveAspectRatio=\\'none\\'%3e%3cpath%20d=\\'M242%208c-2%200-4%202-5%203l-5%202c-2%200-3%201-5%203l-5%206c-4%204-4%2010%200%2014l1%203v2c1%201%201%201%201-2%200-4%202-5%205-1%202%203%202%203%200%205l-4%203c-2%201-1%207%201%207l2%202c-1%203%203%204%206%201%205-5%2011-2%2010%205-1%204-1%204-4%204l-4-2c-1-1-1-1-2%201-1%203-2%202-2-2%200-3%200-3-1-2-2%202-2%202-3%200-1-1-1-1-1%201l1%203v6l2-1c2-2%205-1%205%202%200%202-1%202-3%203-2%200-3%201-3%203%201%202%203%203%203%201l1-2c2%200%202%201%201%203l1%205c2%201%202%202%201%204s1%205%204%205%203%202%200%202c-3%201-9%207-9%209l-11%2014c-2%200-3-3-2-4v-3h3c0-2-20-1-25%202l-3%202v4l-1%201-2%205-5%2016c-4%2013-5%2013-15%2015l-4%201%202%202h-10c-5%202-12%204-21%205l-9%202-8-4v-3h-2c-3%201-5%200-13-1H95c-6%201-5%204%200%203h2l-5%202c-4%200-4%202%200%203%202%201%202%201%200%201l-6-2c-1-2-2-2-3%200-1%201-1%201%205%2016l3%206-3-1h-4c-3%201-3%201-2%204l2%201c2-1%208%201%209%203%200%202%201%202%206%202h5l-3%201c-2%200-2%200%200%201l6-1c3-1%203-1%201-1-3%200-3%200-2-1%202-2%205-1%205%201l1-1c2-3%204-4%203-1%200%202%200%202%202%201%202-3%203-4%200-4h-1l6-3a308%20308%200%200058-21h4l-4%202-6%204c-4%203-13%207-18%208l-8%202-6%202-5%201-1%201-4%201-6%202c-2%200-3%201-5%204l-6%207c-4%203-4%207-1%2010%203%202%209%203%2010%201h2c1%201%209%200%2012-3%203-2%204-3%202-3s-2%200%200-5%202-5%206-5c5%200%207%201%206%202l3%201c37-8%2043-9%2044-7%201%201%201%201%201-1l2-2%202-1-2-1h-2c-1-1%200-1%201-1l3-1c1-3%203%201%202%205%200%202-1%202-3%201-2%200-2%200-1%201v1c-6%200%200%204%207%205%208%201%209%203%203%204-4%200-6%203-2%203s6%200%209%203l3%203%206-2%2010-1h3l-4%201-8%202-6%202-6%202a339%20339%200%2000-33%201%20686%20686%200%2000-35%201l-5-2-6-1-6%201h-8c-7%200-9%201-10%204-1%206-8%206%20128%206a981%20981%200%2000132-4c0-4%202-8%205-8l1-1%2011-7-1%201%201%201c1-1%201%200%201%201l4%2010%204%208v-11c0-9%200-10-2-11-2%200-3-4-1-4l1%201c0%204%202%203%202-1l-1-5v-2l1-3v-69c0-76%200-75-7-83-4-5-5-5-11-6-13-1-25%209-25%2019l-1%205v15l1%208c1%207%201%207-2%209l-5%207c-1%203-3%205-4%205l-1%202-6%2012h-9c0%202-1%202-2%202h-3l-2-3-8-10-6-8c0-2-1-3-3-1-1%201-2%200-4-2l-5-3h-2l-1-2-3-4-3-2-1%201-1-1h-4c-6%201-8-2-7-12l-1-5c-2-2-1-4%201-3%203%202%205-9%203-11-2-1-2-2%200-6%204-14%200-27-9-31-3-2-6-2-8-2h-3c0-1-8-5-11-5l-5%202m-78%2011l-3%201c-6%200-20%2016-20%2023l-1%202-1-2c0-4%203-12%204-12l11-10c0-1-5-3-9-3s-7%202-12%208c-9%209-10%2015-5%2020%202%202%203%203%203%206s1%204%204%205c3%202%203%202%202-1-1-4%200-4%203%200%201%203%202%203%202%202l-1-3c-2%200-1-2%201-2l1-3c-1-5%203-5%204%200v7c-1-3-2-1-2%205%200%204%200%205%201%204l1-4%201-2v13l1%208%202%2015%202%2013%201%203c1%200%202%204%203%2013%201%2013%200%2016-3%2015l-2%202c0%203-2%203-2%200%200-2-2-3-3-1l-3%201-2%201-12%204-8%202c-4%201-5%201-8-1l-6-1c-1%201-2%201-2-1l-2-1h-4l-3-1c-1-1-1-1-1%201v2c-2%200-2%201-1%202l-1%203-2%202h14a318%20318%200%200062-1l6-2%201-2%201-5%202-5%201-3c0-2%201-3%203%200%201%201%201%200%201-9-1-8-1-10%201-15l4-14%203-12c3-6%2010-17%2012-18l1-1-1-5-4-7-3-7c0-10-9-26-16-30-4-2-16-2-16%201m93%2020v4l2%204%201%204c0%203%200%203-2%202-2%200-2%200-1%201l1%203c-2%202-2%208%200%209h2l2-2c2%200%202%200%201%201l-1%204c0%203-2%204-5%201h-2l-1%202c-2%200-2%200%200%202%201%201%202%202%203%201v1h3c4%200%204%200%204%202s0%203%201%202c1%200%202%201%202%203l1%203%203-2c2-3%202-3%202-10s0-7-3-7c-3%201-3%200-1-5%202-4%203-11%201-9-3%202-4%200-4-5%200-4%200-6-2-7l-2-3c0-3-5-2-5%201m116%2067l-1%204-1%205-3%207-2%206c-1%200-3%205-2%206l4%202c3%200%203%200%205-5%203-6%204-13%202-16l-1-6-1-3M97%20122l3%203c3%203%203%203%202%205l-2%202h-5c-3%200-4%202-2%202v1c-1%201-1%201%201%202l3%201%202%201%201-2%202%201h2l3-1h2l-4-2-1-1c0-2%202-2%2012-2%209%200%2012%200%2010-1l-11-1h-9l3-1%203-1c-2-1-4-5-3-6l-6-1-6%201m232%204l3%203c2%201%202%202%201%202-1%201%200%201%202%201h1v1h5l15%205a2547%202547%200%200119%205c-6-3-16-7-22-8l-14-6c-9-4-10-5-10-3m-261%207l4%209%206%209c2%204%204%204%204%200%200-2%200-3%202-3l3-2%203-1%204-1c1-2%201-2-6-1-6%200-7%200-7-2h-1c-1%201-2%200-7-7-4-6-5-6-5-1m43%206l-4%202-5%201%203%201%203%202c1%202%2024-1%2028-3%203-1%203-2-9-2l-14-1h-2m236%2017c-1%203%208%208%2015%208%202%200%203%200%203%202s2%204%203%202c2-1%203-7%201-7h-1l-2-1-2-1c1-1-2-2-7-4-6-1-9-1-10%201M52%20179l-17%202-15%201-8%201c-8%200-11%201-11%204%200%202%200%202%206%201%2037-3%2060-6%2058-8-1-1-1-1%201-1l2%202%201%201%201-2c0-2-8-3-18-1\\'%20fill=\\'%23d3d3d3\\'%20fill-rule=\\'evenodd\\'/%3e%3c/svg%3e'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/bc90cc72896c64fad5161ea66602b9a6/f4a91/study2.webp 728w,\n/static/bc90cc72896c64fad5161ea66602b9a6/223e5/study2.webp 1280w\"\n              sizes=\"(max-width: 728px) 100vw, 728px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/bc90cc72896c64fad5161ea66602b9a6/83881/study2.jpg 728w,\n/static/bc90cc72896c64fad5161ea66602b9a6/289e0/study2.jpg 1280w\"\n            sizes=\"(max-width: 728px) 100vw, 728px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/bc90cc72896c64fad5161ea66602b9a6/83881/study2.jpg\"\n            alt=\"教室でテストを受ける外国人がこちらを見て笑っているフリー素材\"\n            title=\"教室でテストを受ける外国人がこちらを見て笑っているフリー素材\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>証明完了．</p>\n<h4 id=\"全域性チェック\" style=\"position:relative;\"><a href=\"#%E5%85%A8%E5%9F%9F%E6%80%A7%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF\" aria-label=\"全域性チェック permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>全域性チェック</h4>\n<p>おっと，重要なおまじないを忘れていました．コードの冒頭に以下の1行を追加します．</p>\n<div class=\"gatsby-highlight\" data-language=\"idris\"><pre class=\"language-idris\"><code class=\"language-idris\"><span class=\"token operator\">%</span><span class=\"token hvariable\">default</span> <span class=\"token keyword\">total</span></code></pre></div>\n<p>これにより，ファイル内のすべての関数定義でIdrisの全域性チェッカーが有効になります．</p>\n<p>詳しくは割愛しますが，証明の場合分けが漏れていたり，再帰呼び出しの引数が減少していなかったりする場合に怒ってくれます．なので，とりあえずファイルの冒頭に書いておくと良いことあるお守りです．</p>\n<p>ともあれ，全域性を<a href=\"https://docs.idris-lang.org/en/latest/tutorial/theorems.html?highlight=total#totality-checking-issues\">保証することはできない</a>ので過信も禁物です．まぁ，関数の停止性を保証するなんて原理的に無理っぽいのはなんとなくわかりますよね．</p>\n<h3 id=\"実践編まとめ\" style=\"position:relative;\"><a href=\"#%E5%AE%9F%E8%B7%B5%E7%B7%A8%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"実践編まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実践編まとめ</h3>\n<p>最終的なコードは以下のようになりました．</p>\n<div class=\"gatsby-highlight\" data-language=\"idris\"><pre class=\"language-idris\"><code class=\"language-idris\"><span class=\"token operator\">%</span><span class=\"token hvariable\">default</span> <span class=\"token keyword\">total</span>\n\n<span class=\"token hvariable\">sum</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Nat</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Nat</span>\n<span class=\"token hvariable\">sum</span> <span class=\"token constant\">Z</span> <span class=\"token operator\">=</span> <span class=\"token constant\">Z</span>\n<span class=\"token hvariable\">sum</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span> <span class=\"token operator\">+</span> <span class=\"token hvariable\">sum</span> <span class=\"token hvariable\">k</span>\n\n<span class=\"token hvariable\">p</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">n</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Nat</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">sum</span> <span class=\"token hvariable\">n</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">n</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">n</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token hvariable\">p</span> <span class=\"token constant\">Z</span> <span class=\"token operator\">=</span> <span class=\"token constant\">Refl</span>\n<span class=\"token hvariable\">p</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span>\n  <span class=\"token keyword\">let</span> <span class=\"token hvariable\">inductiveHypothesis</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">p</span> <span class=\"token hvariable\">k</span> <span class=\"token keyword\">in</span>\n    <span class=\"token operator\">?</span><span class=\"token hvariable\">proofP</span>\n\n<span class=\"token comment\">---------- Proofs ----------</span>\n\n<span class=\"token hvariable\">Main<span class=\"token punctuation\">.</span>proofP</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">proof</span>\n  <span class=\"token hvariable\">intros</span>\n  <span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">sym</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">multRightSuccPlus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">k</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">-- transform right</span>\n  <span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">plusCommutative</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">plusCommutative</span> <span class=\"token number\">1</span> <span class=\"token hvariable\">k</span>\n  <span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">plusSuccRightSucc</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token hvariable\">k</span>\n  <span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">plusCommutative</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plus</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">sym</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">multDistributesOverPlusLeft</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">sum</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\">-- transform left</span>\n  <span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">sym</span> <span class=\"token hvariable\">inductiveHypothesis</span>\n  <span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">plusCommutative</span> <span class=\"token number\">1</span> <span class=\"token hvariable\">k</span>\n  <span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">sym</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">multRightSuccPlus</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">sym</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">multRightSuccPlus</span> <span class=\"token hvariable\">k</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">sym</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">multZeroRightZero</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">sym</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">plusZeroRightNeutral</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">rewrite</span> <span class=\"token hvariable\">plusAssociative</span> <span class=\"token hvariable\">k</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">mult</span> <span class=\"token hvariable\">k</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">S</span> <span class=\"token hvariable\">k</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token hvariable\">trivial</span></code></pre></div>\n<p>答案用紙に書くとこうなります．</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 728px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/584b4fe8610265e18eed42669acf552d/f8a3c/answer.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.62087912087912%; position: relative; bottom: 0; left: 0; background-image: url('data:image/svg+xml,%3csvg%20xmlns=\\'http://www.w3.org/2000/svg\\'%20width=\\'400\\'%20height=\\'267\\'%20viewBox=\\'0%200%20400%20267\\'%20preserveAspectRatio=\\'none\\'%3e%3cpath%20d=\\'M336%203c-10%202-18%2012-20%2023-5%2019-8%2028-8%2020%200-4-2-4-5%201-3%204-3%209%200%207%202-2%202-1%202%202l-3%203c-3%200%201%207%206%2010%203%201%203%201%203%205-6%2030-5%2047%201%2050%204%202%204%203-1%2016-4%2012-4%2011-5%2038l-2%2010c-2%203-3%2020-1%2021%201%201%201%201%201-1%200-3%202-6%207-10l3-4c1-3%205-8%207-8l9-9%205-6%2011-17%205-11%204%204%2020%2015c4%201%207%204%207%207l-1%203-4%203-7%205c-34%2020-40%2030-29%2041%203%202%204%205%202%205l-3%205c-4%206-5%2010-2%2012l2%204%202%201c2%200%202%200%202%202-1%202%204%206%206%206l2%201%202%202c2%200%202%201%202%203-1%202%200%202%205%202%204%200%205%200%205%202l17%201h17v-53l-4%201-5%201h-5c-1-1%2011-13%2013-13l1-86V30l-3-3-4-3-1-1c0-2-5-7-8-7l-3-1c-1-1-21%200-23%201-2%200-2%200-2-5%201-5%200-7-5-7l-3-1h-12\\'%20fill=\\'%23d3d3d3\\'%20fill-rule=\\'evenodd\\'/%3e%3c/svg%3e'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/584b4fe8610265e18eed42669acf552d/f4a91/answer.webp 728w,\n/static/584b4fe8610265e18eed42669acf552d/c58b7/answer.webp 1920w\"\n              sizes=\"(max-width: 728px) 100vw, 728px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/584b4fe8610265e18eed42669acf552d/83881/answer.jpg 728w,\n/static/584b4fe8610265e18eed42669acf552d/f8a3c/answer.jpg 1920w\"\n            sizes=\"(max-width: 728px) 100vw, 728px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/584b4fe8610265e18eed42669acf552d/83881/answer.jpg\"\n            alt=\"答案用に書かれたIdrisのコード\"\n            title=\"答案用に書かれたIdrisのコード\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>教師は</p>\n<ol>\n<li>答案で証明している型が，問題とカリー＝ハワード同型対応するか確かめる</li>\n<li>答案をOCRして<code class=\"language-text\">idris --check</code>する</li>\n</ol>\n<p>だけで採点が完了します．なお，最初から問題をIdrisで出題していればStep 1は不要になります．</p>\n<p>どうですか，Idrisによりテスト回収〜返却までのリードタイムが大幅に短縮されそうです．したがって，テストが返ってくるまでの，あのイヤな数日感を過ごさなくて良くなるわけです．</p>\n<p>また，表現が厳格なので「記述が微妙でバツをもらった」とか「教師によって採点の厳しさ・解釈が違う」ということもなくなります．（採点で使用するIdrisのバージョンは合わせておく必要があります）</p>\n<p>これからは数学の授業をIdrisにしたほうが良いのかもしれません．</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 728px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7bcbb42da95f31bcab14f33476f8e8f4/f8a3c/schedule.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.62087912087912%; position: relative; bottom: 0; left: 0; background-image: url('data:image/svg+xml,%3csvg%20xmlns=\\'http://www.w3.org/2000/svg\\'%20width=\\'400\\'%20height=\\'267\\'%20viewBox=\\'0%200%20400%20267\\'%20preserveAspectRatio=\\'none\\'%3e%3cpath%20d=\\'M0%20134v133h71v-29c0-54-5-218-7-234V0H0v134M325%201a4399%204399%200%200018%20152c0-1%206-7%208-7l3-3%204-3%204-3%204-4%205-3%204-2%201-1%202-3%2012-9%2010-7V0h-37l-38%201M115%203a354%20354%200%2000-1%2017c-2%204%201%204%204%200%201-3%201-3%206-3s8%203%203%203l-2%201c0%202%202%203%205%202h3V4h-8a44%2044%200%2001-10-1m50%207c0%205-1%205-4%208-4%203-4%204-2%205%201%201%202%201%205-2l4-4%203%203%205%204c2%200%202-2%200-3-4-3-7-7-8-12%200-4-1-5-2-5l-1%206m43-5v9l-1%208v2c2%203%205%200%205-4v-4l2%203c3%204%205%205%205%202%201-1%200-2-2-4l-2-2%202-3c2-3%202-3%200-4-1-1-2%200-3%202-2%202-3%201-3-3%200-3-3-4-3-2m82%200l-4%203c-2%202-3%203-2%204v3l1%202v4c-4%202%201%203%209%202%209%200%2011-1%207-4v-2c2-2%201-3-2-3l-4-1%204-1c3%201%204%201%204-1l-1-2-5-2c-3-3-7-4-7-2m-41%202l-4%201c-3%200-4%200-4%202s1%202%204%202c4%200%204%201%200%204l-3%205c1%202%204%201%206-2l2-2v7l2%201c2%200%202%200%202-4-1-5-1-5%203-1%203%202%203%202%204%201%201-2%201-3-2-5-4-2-5-4-1-4%203%200%205-2%203-3l-4-1-4-1-2-2-2%202M84%2037c-3%201-4%203%200%204%202%200%202%200%202%209v7h6l-1-10c0-13%200-13-7-10m74%2031v3l-3%202-3%202%203-1c3%200%204%200%204%202s-1%203-4%204l-3%201%202%202c4%203%205%203%202%200v-2l3%201v1c0%201%201%202%203%201%202%200%203-1%203-3%200-1%200-3%202-3%201-1%201-1-2-1l-4-1%201-1%203-2%203-2-3-2h-3l-2-1h-2m-72%205c-4%201-5%207-2%207l3-1c0-2%202-3%203-2%203%201%202%203-3%207l-5%208v3h8c8%200%209%200%208-3%200-2-1-2-5-2h-4l2-2%205-4c6-5-2-14-10-11m91%2012c-2%200-3%204-3%205l3-1h4l-6%203c-4%201-5%201-3%202%201%200%204%201%205%203%202%202%202%202%204%201l2-5%203-3c4-1%204-2%200-2-2%201-3%200-3-1l-2-1v-1h-4m-92%2027c-3%203-3%205%201%205l2-2c0-2%203-1%204%202%200%202%200%202-2%202s-3%201-3%202l2%202c4%200%206%203%204%205h-4c-1-2-6-3-6-2v2c0%204%2011%207%2014%203%202-2%202-6%200-8v-3c2-2%201-6-2-8-3-3-7-3-10%200m310%2014l-4%203-2%201-1%201-1%201-2%201a208%20208%200%2001-26%2021l-4%203-5%204-6%205c-2%200-2%201-2%205%200%209%202%209%208%203l3-2%203-2%204-3%202-1%2014-12a2809%202809%200%200021-16c3-2%203-2%203-8%200-8%200-8-5-4M89%20155l-5%2010c0%203%200%203%205%203%204%200%205%200%205%202%200%201%201%202%203%202l2-2%202-2v-5c-1%200-2-3-2-7-1-9-3-9-10-1m309-3a100%20100%200%2001-13%2011%20687%20687%200%2001-39%2030v14l2-2a174%20174%200%200120-16l5-4a197%20197%200%200019-14c8-6%208-7%208-14%200-6%200-7-2-5m-3%2031a86%2086%200%2000-10%208l-10%208-13%2011c-12%209-14%2012-14%2016%200%205%201%209%202%207l5-4%205-4%201-1%203-2%208-6%205-4a236%20236%200%200122-18l1-7c0-8%200-8-5-4m-309%208c-2%206-1%2011%201%2011%202%201%203%200%204-1%203-2%205%200%205%204-1%203-4%204-5%202s-6-1-6%201%205%205%208%205c4%200%208-3%208-7%202-6-4-11-9-9l-2-1c0-1%201-2%205-2s5-1%205-3c0-3-13-3-14%200m310%2022l-4%204-2%201-5%204-9%206-4%204-3%202-3%202-6%206-6%205-1%201c-2%200-2%201-2%206%200%208%201%2010%203%207l2-1%205-3%2010-9c3-1%205-4%205-4l1-1c1%200%206-4%2010-9l7-4c5-3%206-5%206-13v-7l-4%203M90%20230c-6%202-5%2021%201%2023%209%204%2016-7%209-14-1-2-3-2-5-2-2%201-3%200-3-1%200-2%203-4%204-2h6c0-3-7-6-12-4m306%2012l-5%204-3%203-4%203-4%203-4%203-2%202-2%202-3%203-2%202h10c6%200%2010-1%2011-2l6-4c6-5%206-6%206-15v-7l-4%203\\'%20fill=\\'%23d3d3d3\\'%20fill-rule=\\'evenodd\\'/%3e%3c/svg%3e'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7bcbb42da95f31bcab14f33476f8e8f4/f4a91/schedule.webp 728w,\n/static/7bcbb42da95f31bcab14f33476f8e8f4/c58b7/schedule.webp 1920w\"\n              sizes=\"(max-width: 728px) 100vw, 728px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7bcbb42da95f31bcab14f33476f8e8f4/83881/schedule.jpg 728w,\n/static/7bcbb42da95f31bcab14f33476f8e8f4/f8a3c/schedule.jpg 1920w\"\n            sizes=\"(max-width: 728px) 100vw, 728px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7bcbb42da95f31bcab14f33476f8e8f4/83881/schedule.jpg\"\n            alt=\"国社Idris理英\"\n            title=\"国社Idris理英\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>Idrisにふんわり入門し，いろいろな証明を書いてみました．初めて定理証明支援系というものを触ってみましたが面白いですねこれ．</p>\n<p>Idris歴3日なので，何か間違ったことを書いていればマサカリでご指摘ください．</p>\n<p>ありがとうございました．</p>\n<blockquote class=\"twitter-tweet\" data-partner=\"tweetdeck\"><p lang=\"ja\" dir=\"ltr\">型は命題！（素振り）<br>型は命題！（素振り）</p>&mdash; 七十 (@sititou70) <a href=\"https://twitter.com/sititou70/status/1541583963013410816?ref_src=twsrc%5Etfw\">June 28, 2022</a></blockquote>\n<h3 id=\"参考記事\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83%E8%A8%98%E4%BA%8B\" aria-label=\"参考記事 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考記事</h3>\n<ul>\n<li><a href=\"https://zenn.dev/blackenedgold/books/introduction-to-idris\">プログラング言語Idrisに入門させたい（v0.9）</a>\n<ul>\n<li>日本語，体系的，そして無料です．ここまでの入門テキストは，日本語では他に無い気がします．</li>\n<li>本記事におけるウォーミングアップの題材はこちらを参考にしています．</li>\n<li><a href=\"https://twitter.com/blackenedgold\">κeen</a>さん，ありがとうございます．</li>\n</ul>\n</li>\n<li><a href=\"https://blog.miz-ar.info/2015/02/idris-finite-set/\">Idrisの有界な自然数で遊んでみる(0)</a>\n<ul>\n<li>先程の入門記事よりも証明について詳しく書かれています．実際のインタラクティブ証明器の操作方法なども書かれています．</li>\n<li><a href=\"https://twitter.com/mod_poppo\">mod_poppo</a>さん，ありがとうございます．</li>\n</ul>\n</li>\n<li>公式ドキュメント系（英語だけどわかりやすい）\n<ul>\n<li><a href=\"http://docs.idris-lang.org/en/latest/proofs/index.html\">Theorem Proving</a></li>\n<li><a href=\"https://docs.idris-lang.org/en/latest/tutorial/theorems.html\">Theorem Proving（チュートリアル）</a></li>\n</ul>\n</li>\n</ul>\n<h4 id=\"フリー素材の出典\" style=\"position:relative;\"><a href=\"#%E3%83%95%E3%83%AA%E3%83%BC%E7%B4%A0%E6%9D%90%E3%81%AE%E5%87%BA%E5%85%B8\" aria-label=\"フリー素材の出典 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>フリー素材の出典</h4>\n<ul>\n<li><a href=\"https://video-ac.com/video/1537\">https://video-ac.com/video/1537</a></li>\n<li><a href=\"https://www.photo-ac.com/main/detail/2312318\">https://www.photo-ac.com/main/detail/2312318</a></li>\n<li><a href=\"https://www.photo-ac.com/main/detail/2387537\">https://www.photo-ac.com/main/detail/2387537</a></li>\n</ul>\n<script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-1\">TAPL的にいうと，「 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∏</mo><mi>x</mi><mo>:</mo><msub><mi>T</mi><mn>1</mn></msub><mi mathvariant=\"normal\">.</mi><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\prod x:T_1.T_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∏</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span> という形を持つ依存関数型」でしょうか．詳しくはTAPL第1版第2刷 p.366を参照ください．<a href=\"#fnref-1\" class=\"footnote-backref\">↩</a></li>\n<li id=\"fn-2\">このモードは<a href=\"https://docs.idris-lang.org/en/latest/reference/tactics.html?highlight=tactics#commonly-used-tactics\">現在非推奨</a>のようですが，推奨される新しいモードは情報が少なかったため，本記事ではいったん古い機能で入門しています．<a href=\"#fnref-2\" class=\"footnote-backref\">↩</a></li>\n</ol>\n</div>","frontmatter":{"title":"Idrisでふんわり眺める依存型","date":"2022/07/04"},"fields":{"slug":"/Idrisでふんわり眺める依存型/"},"id":"82d43655-ea2a-52cd-97a3-16b7b28ad150"},"firstImage":{"imageFile":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#888888","images":{"fallback":{"src":"/static/82c1a735590a9195678fcc43a66b12fe/4a49b/study1.jpg","srcSet":"/static/82c1a735590a9195678fcc43a66b12fe/b4dad/study1.jpg 320w,\n/static/82c1a735590a9195678fcc43a66b12fe/3440d/study1.jpg 640w,\n/static/82c1a735590a9195678fcc43a66b12fe/4a49b/study1.jpg 1280w","sizes":"(min-width: 1280px) 1280px, 100vw"},"sources":[{"srcSet":"/static/82c1a735590a9195678fcc43a66b12fe/c0bcc/study1.webp 320w,\n/static/82c1a735590a9195678fcc43a66b12fe/17574/study1.webp 640w,\n/static/82c1a735590a9195678fcc43a66b12fe/71d4d/study1.webp 1280w","type":"image/webp","sizes":"(min-width: 1280px) 1280px, 100vw"}]},"width":1280,"height":720}}}},"relatedMarkdownRemarks":{"posts":[{"id":"29b79017-f96d-5b04-8d01-5b8ee761ebed","frontmatter":{"draft":null}},{"id":"3a3c4125-9986-53bb-8b96-ae29936c96ab","frontmatter":{"draft":null}},{"id":"73d6ab42-b3e6-5663-a175-b1f3d69c29e1","frontmatter":{"draft":null}},{"id":"f49ce388-e81c-5425-af59-9902f125c20f","frontmatter":{"draft":null}},{"id":"c2249b7b-b97e-5cf4-8ea9-8024e96851b7","frontmatter":{"draft":true}},{"id":"5888c50d-8414-5e8f-b0dc-28a31b29053d","frontmatter":{"draft":null}},{"id":"be594923-185e-5cca-95b6-5267b3c9fc8c","frontmatter":{"draft":null}},{"id":"8f7b1b24-7738-5b97-bfb6-fd763f11a664","frontmatter":{"draft":true}},{"id":"75696ec6-74a3-5046-8a3c-f39b36d92311","frontmatter":{"draft":null}},{"id":"c2db052c-95c6-5094-935b-9eb39f5c762a","frontmatter":{"draft":null}},{"id":"27f10a38-0ecb-539f-a717-7e40a41bbd10","frontmatter":{"draft":null}},{"id":"3908aafc-c8d3-5c67-821f-0866592449f2","frontmatter":{"draft":true}},{"id":"cbdf3192-973c-5d87-9cf1-bb9110e9a169","frontmatter":{"draft":null}},{"id":"9f24363b-ee3e-54bf-8a18-46ea3b269bea","frontmatter":{"draft":null}},{"id":"46a22c41-5455-557c-85d4-973a6e2220ee","frontmatter":{"draft":null}},{"id":"50951bb1-eb92-5663-a3d8-8f35f73a1322","frontmatter":{"draft":null}},{"id":"a091877c-69b8-59f9-8963-1af334fd573c","frontmatter":{"draft":null}},{"id":"0116f663-28d1-507a-b5ab-b189801dd408","frontmatter":{"draft":true}},{"id":"01deffb8-0d62-54c6-9e41-20832cbc3c6e","frontmatter":{"draft":null}},{"id":"067a602f-4581-5707-b896-73190dd8c889","frontmatter":{"draft":null}},{"id":"0c5568c9-6d87-56ed-ab0e-caeb9c1aafa4","frontmatter":{"draft":null}},{"id":"1086a735-7173-58cc-a813-c540a563aedf","frontmatter":{"draft":false}},{"id":"1162dccb-e1bf-576d-a5c6-0993394feb0a","frontmatter":{"draft":true}},{"id":"12222bfa-2e8e-51ee-99d8-8a19902351f5","frontmatter":{"draft":null}},{"id":"1509de3c-7308-5e40-a885-f5ebdb089774","frontmatter":{"draft":null}},{"id":"2239c111-61d9-556e-9045-9e3707553db4","frontmatter":{"draft":true}},{"id":"2cfd9e33-b4e1-53e4-884d-d8a6760f3387","frontmatter":{"draft":true}},{"id":"2f30c3f1-0d66-590b-8dba-7836df701d46","frontmatter":{"draft":null}},{"id":"3b696b96-130d-50de-a673-dc1367f32387","frontmatter":{"draft":null}},{"id":"48c65a15-67ca-57d0-9edc-ebcb868f7ad2","frontmatter":{"draft":true}},{"id":"49cf25c1-03f6-575e-8c2f-638ccd6198ea","frontmatter":{"draft":null}},{"id":"4ed3b747-2001-54f4-9661-3acab89ce275","frontmatter":{"draft":null}},{"id":"4edc1b46-b395-5783-af6a-818b8fc9c2dc","frontmatter":{"draft":null}},{"id":"50d3cc2a-de7a-5b9a-a8d8-754415fe4d94","frontmatter":{"draft":null}},{"id":"63f3c7ad-6c59-52b5-9816-78fd348955ff","frontmatter":{"draft":true}},{"id":"69a4aa90-b728-522c-b34f-abee49825c45","frontmatter":{"draft":true}},{"id":"73ab4455-f04d-5320-bf3a-90b9f7441d13","frontmatter":{"draft":null}},{"id":"75550af2-8134-5467-a07d-abbb5a4f6b7c","frontmatter":{"draft":true}},{"id":"7778d041-a5bf-536a-a36f-c0dbc5e08ac7","frontmatter":{"draft":true}},{"id":"78349b16-6e41-5fef-ae38-bcdc5ff297ef","frontmatter":{"draft":true}},{"id":"7a8fc278-a847-5b68-8b74-a83193ba3f55","frontmatter":{"draft":null}},{"id":"7d6499d9-277c-5f07-b8b1-98ae40c50c42","frontmatter":{"draft":null}},{"id":"7d79eb4b-cd4a-5621-a67a-91d9a24dce05","frontmatter":{"draft":null}},{"id":"871ac696-39ea-5c64-94f3-5dc4b73b5770","frontmatter":{"draft":true}},{"id":"8b3e46c2-1a1e-5af0-8900-7972c7285d15","frontmatter":{"draft":null}},{"id":"961ec1e6-3f2b-59d9-a33f-dad76cf67f47","frontmatter":{"draft":null}},{"id":"97f01467-e3a1-58e1-b2a4-db77354cc1a3","frontmatter":{"draft":null}},{"id":"9f02de74-61a0-5daf-a048-1c1022e08fe4","frontmatter":{"draft":null}},{"id":"a190aac4-0483-5e02-b1d3-261f3b5f313a","frontmatter":{"draft":null}},{"id":"b4251348-b618-5b5b-a2c8-e4c6b2431b83","frontmatter":{"draft":true}},{"id":"bfee69af-7d7f-5d87-9680-d2e9b60f8416","frontmatter":{"draft":null}},{"id":"c5e2431a-cf05-5024-b833-e1c69f680d44","frontmatter":{"draft":null}},{"id":"c6def021-b8da-5dbe-ad3e-811d9286424d","frontmatter":{"draft":true}},{"id":"c7a5adfb-149b-5469-ba35-7421e2101951","frontmatter":{"draft":null}},{"id":"d29b4513-0609-5cfc-af49-817467dbed1f","frontmatter":{"draft":null}},{"id":"d4d1afa4-f2f9-5942-ae36-2826fb938af5","frontmatter":{"draft":null}},{"id":"db26c6b9-37b4-5cc4-b1ec-c61dc667863e","frontmatter":{"draft":null}},{"id":"dd0c41cf-0a03-5b89-b5a2-f64859aeae63","frontmatter":{"draft":null}},{"id":"e322eac2-bd89-5347-b20d-d050d303a6be","frontmatter":{"draft":null}},{"id":"e376b2d4-df91-5b82-af7a-a8d02763e922","frontmatter":{"draft":true}},{"id":"e4fb8478-b1ad-59eb-95e8-8c5e0500d3f4","frontmatter":{"draft":null}},{"id":"e83330dc-2312-5ae6-95fa-53e86909f42b","frontmatter":{"draft":true}},{"id":"eba9aa6a-6e21-5f1b-a0eb-7b6bfb1e04f1","frontmatter":{"draft":null}},{"id":"ebae7878-c4ee-505e-81e2-3d3fc47ea826","frontmatter":{"draft":null}},{"id":"ed7af7f9-75f5-59be-9063-de564576eed7","frontmatter":{"draft":true}},{"id":"f06a6ae0-e961-504c-8dab-a60489c0557a","frontmatter":{"draft":true}},{"id":"f5a25ce1-67a6-51b2-9bf1-f9fbacb41ad1","frontmatter":{"draft":true}},{"id":"fd6eab68-17d3-5395-8b2b-54a6efe43ebb","frontmatter":{"draft":null}}]}},"pageContext":{"id":"82d43655-ea2a-52cd-97a3-16b7b28ad150"}},"staticQueryHashes":["1530353647","2576926420","63159454"]}