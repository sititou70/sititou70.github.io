{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/Advent-of-Code-2021攻略ガイド/","result":{"data":{"site":{"siteMetadata":{"siteUrl":"https://sititou70.github.io"}},"markdownRemark":{"excerpt":"Advent of Code 2021をRust…","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f2f0cc20eaee74bb0701cb400d43698e/28895/top.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 92.76923076923077%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAC4jAAAuIwF4pT92AAAB50lEQVR42pWUWXejMAyFbXmBkDSk7fuwpune///rNFdeCE7PTMuDDpJjPu6V5Sjtn7gId/53veTnJTcVahrY+5l3u4mVdjNrO4dFbSfWZox5rsPagI0Dk5mYqGPjLkz+lQ3WncPvuuemuXDbnrEvA3R3hWHD+qkAcqZjC7i1Ix8AqQlQrMkepXreN898PM4AUl+qCpB+qRVqg9jbP3jphZ2/QFkPpX3cm4CHw0tSSAJbKcuxAu6rjitADD5sqCv3ZYX7Z26jwqG0GfJ1DdDuiZ0dAEMfQ2CNovI1MFq++VqhNH3A2jPXOICd67ny6CNO2CB36LtBiIu7u9dfAHUCwm4IqHJuDNYJwBrhASTU96cPQANw+K5qycdgUeyFw5HcxFqeDdrQUJyO0+k9A5OSdd9STlqUxZ5ZrNceljE2lZ7D/DlYt5QU3n/cABdl8oQyPB1AlcMtECVuCPBKhlnHsRH1St0Ao4JymD365DHEMiq1jxa/9ToHgNLTh4dPAHH18ghki0RzUBLW/gdahShs27d4ylF6+kFOlKbiFvwYhcLUQ1qdrKV+E1AF4MSPj198FMvZqliUgzByDfUGhToqbNv32MOlD+kqyXxtAibL8ZQL4PWebgGqVQ+Lq5eB2+xe35U/h6oa+S8NLbXtbbRmDQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f2f0cc20eaee74bb0701cb400d43698e/96d09/top.webp 650w\"\n              sizes=\"(max-width: 650px) 100vw, 650px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f2f0cc20eaee74bb0701cb400d43698e/28895/top.png 650w\"\n            sizes=\"(max-width: 650px) 100vw, 650px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f2f0cc20eaee74bb0701cb400d43698e/28895/top.png\"\n            alt=\"Advent of Code 2021\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>Advent of Code 2021をRustで完走しました．</p>\n<p>個人的に難しい問題が多く，途中でやめてしまおうかと思う中，他の人のコードに何度も助けられました．そのため，私の解法もここに残しておくことで誰かの役に立てばと思います．</p>\n<p>各問題を解くまでのプロセスと解答コードを示しますので，言うまでもなくネタバレ注意です（言ってる）</p>\n<h2 id=\"かんたん-day-1-sonar-sweep\" style=\"position:relative;\"><a href=\"#%E3%81%8B%E3%82%93%E3%81%9F%E3%82%93-day-1-sonar-sweep\" aria-label=\"かんたん day 1 sonar sweep permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[かんたん] <a href=\"https://adventofcode.com/2021/day/1\">Day 1: Sonar Sweep</a></h2>\n<details><summary>詳細を見る</summary>\n<p>Advent of Code 2021は，海に落ちた鍵を探しに行く話です．</p>\n<h3 id=\"概要\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81\" aria-label=\"概要 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>まずはソナーを使用して鍵を検出できないか試します．ソナーの計測値が時系列データとして次のように与えられます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">199\n200\n208\n210\n200\n...</code></pre></div>\n<h3 id=\"part-1\" style=\"position:relative;\"><a href=\"#part-1\" aria-label=\"part 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>1つ前の値と比べて増加している計測値の数を回答します．愚直にループで実装すれば問題ありません．</p>\n<p>初めての言語で挑戦する場合は，ファイルや標準入力の読み込み方法，数値のパース方法などが求められます．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day01-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2\" style=\"position:relative;\"><a href=\"#part-2\" aria-label=\"part 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>計測値のノイズを排除するために，大きさ3のスライディングウインドウを設定し，ウインドウ内の合計値が増加する回数を回答します．こちらも愚直に実装すれば問題ありません．</p>\n<p>または，3つ前の値と比べて増加している計測値をカウントしても同じです．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day01-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"かんたん-day-2-dive\" style=\"position:relative;\"><a href=\"#%E3%81%8B%E3%82%93%E3%81%9F%E3%82%93-day-2-dive\" aria-label=\"かんたん day 2 dive permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[かんたん] <a href=\"https://adventofcode.com/2021/day/2\">Day 2: Dive!</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-1\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-1\" aria-label=\"概要 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>潜水艦の動きが次のように与えられます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">forward 5\ndown 5\nforward 8\nup 3\ndown 8\nforward 2\n...</code></pre></div>\n<h3 id=\"part-1-1\" style=\"position:relative;\"><a href=\"#part-1-1\" aria-label=\"part 1 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>入力値の意味が次のように与えられます．</p>\n<ul>\n<li>forward N: 水平位置がN増加する</li>\n<li>down N: 深さがN増加する</li>\n<li>up N: 深さがN減少する</li>\n</ul>\n<p>入力どおりに潜水艦を動かした場合の最終的な位置における， <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>水平位置</mtext><mo>×</mo><mtext>深さ</mtext></mrow><annotation encoding=\"application/x-tex\">水平位置 \\times 深さ</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord cjk_fallback\">水平位置</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord cjk_fallback\">深さ</span></span></span></span></span> を回答します．</p>\n<p>特に工夫は必要ありません．入力をパースしながら潜水艦の現在位置を更新して行けば良いです．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day02-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-1\" style=\"position:relative;\"><a href=\"#part-2-1\" aria-label=\"part 2 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>実はPart 1で与えられた入力値の意味が間違っていたと教えられます．本当の意味は次のとおりです．</p>\n<ul>\n<li>down X: AimをX増やす</li>\n<li>up X: AimをX減らす</li>\n<li>forward X: 次のことを行う\n<ul>\n<li>水平位置をX増やす</li>\n<li><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mi>i</mi><mi>m</mi><mo>×</mo><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">Aim \\times X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\">im</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span></span> だけ深さを増やす</li>\n</ul>\n</li>\n</ul>\n<p>こちらも特に工夫はいりません．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day02-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"かんたん-day-3-binary-diagnostic\" style=\"position:relative;\"><a href=\"#%E3%81%8B%E3%82%93%E3%81%9F%E3%82%93-day-3-binary-diagnostic\" aria-label=\"かんたん day 3 binary diagnostic permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[かんたん] <a href=\"https://adventofcode.com/2021/day/3\">Day 3: Binary Diagnostic!</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-2\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-2\" aria-label=\"概要 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>潜水艦の調子がおかしいです．診断データが2進数で次のように与えられます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">00100\n11110\n10110\n...</code></pre></div>\n<h3 id=\"part-1-2\" style=\"position:relative;\"><a href=\"#part-1-2\" aria-label=\"part 1 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>消費電力を10進数で求められます．消費電力は <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>ガンマレート</mtext><mo>∗</mo><mtext>イプシロンレート</mtext></mrow><annotation encoding=\"application/x-tex\">ガンマレート * イプシロンレート</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord cjk_fallback\">ガンマレート</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord cjk_fallback\">イプシロンレート</span></span></span></span></span> です．</p>\n<p>ガンマレートは入力値の各ビットの最瀕値をくっつけたものになります．イプシロンレートはその逆で，各ビットの最瀕値でないビットをつなげた値になります．</p>\n<p>各行をパースしながら，各桁の0と1の度数を集計していき，最後にガンマレートとイプシロンレートを計算すればいいでしょう．</p>\n<p>値のパースや基数変換の方法が求められます．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day03-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-2\" style=\"position:relative;\"><a href=\"#part-2-2\" aria-label=\"part 2 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>生命維持率を回答します．生命維持率は，酸素発生率と二酸化炭素吸収率の積です．</p>\n<p>生命維持の求め方は少し複雑です．すべての入力値のうち，各ビットの最瀕値を持つもの以外を取り除くという操作をします．</p>\n<p>例：</p>\n<ol>\n<li>全ての入力値の1ビット目の最瀕値は1</li>\n<li>1ビット目が1でない値を取り除く</li>\n<li>残りの入力値の2ビット目の最瀕地は0</li>\n<li>2ビット目が0でない値を取り除く…</li>\n</ol>\n<p>基本的にはそのまま実装すれば問題ありません．</p>\n<p>「取り除く」という操作をどのように実現するかは言語によって異なると思います．可変長配列や集合が使えるなら簡単です．使えないなら，各値に「取り除かれたか」というビットを保持しておくなどの方法があるでしょう．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day03-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"かんたん-day-4-giant-squid\" style=\"position:relative;\"><a href=\"#%E3%81%8B%E3%82%93%E3%81%9F%E3%82%93-day-4-giant-squid\" aria-label=\"かんたん day 4 giant squid permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[かんたん] <a href=\"https://adventofcode.com/2021/day/4\">Day 4: Giant Squid</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-3\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-3\" aria-label=\"概要 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>ビンゴで遊びたそうなダイオウイカが近づいてきたので，潜水艦になぜか搭載されているビンゴシステムを使って対決します．（未来予知によって確実に勝ちますが）</p>\n<p>数字を開ける順番と，複数のビンゴボードが次のように与えられます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">7,4,9,5,11,17,23,2,0,14,21,24,10,16,13,6,15,25,12,22,18,20,8,19,3,26,1 // 数字を開ける順番\n\n22 13 17 11  0\n 8  2 23  4 24\n21  9 14 16  7\n 6 10  3 18  5\n 1 12 20 15 19\n\n 3 15  0  2 22\n 9 18 13 17  5\n19  8  7 25 23\n20 11 10 24  4\n14 21 16 12  6\n\n14 21 17 24  4\n10 16 15  9 19\n18  8 23 26 20\n22 11 13  6  5\n 2  0 12  3  7</code></pre></div>\n<h3 id=\"part-1-3\" style=\"position:relative;\"><a href=\"#part-1-3\" aria-label=\"part 1 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>順番通りに数字を開けていき，一番最初にビンゴするボードにおける得点を回答します．</p>\n<p>ビンゴしたボードの得点は， <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>ビンゴした列の値の合計</mtext><mo>×</mo><mtext>数字が呼ばれた回数</mtext></mrow><annotation encoding=\"application/x-tex\">ビンゴした列の値の合計 \\times 数字が呼ばれた回数</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord cjk_fallback\">ビンゴした列の値の合計</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord cjk_fallback\">数字が呼ばれた回数</span></span></span></span></span> で計算できます．</p>\n<p>計算量に関する懸念はないのでそのまま実装していけばOKです．ボードのパースやビンゴ判定の実装が少し大変かもしれません．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day04-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-3\" style=\"position:relative;\"><a href=\"#part-2-3\" aria-label=\"part 2 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>Part 1とは異なり，一番最後にビンゴするボードの得点を回答します．（ボードの得点計算において，「数字の呼ばれた回数」のウエイトが高いので一番最後のボードを選べば勝てる）</p>\n<p>Part 1が解けているならほぼ同じコードの流用で解けます．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day04-2/src/main.rs\">解答コード</a></p>\n<h3 id=\"余談\" style=\"position:relative;\"><a href=\"#%E4%BD%99%E8%AB%87\" aria-label=\"余談 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>余談</h3>\n<p>この問題，呼ばれる数字列を自分側があらかじめ知っているのズルくないですか？イカサマでは？（激ウマギャグ）</p>\n<p>あと，yosuke_furukawaさんが「<a href=\"https://www.netflix.com/jp/title/81040344\">イカゲーム</a>と掛けたのかなこれは」と<a href=\"https://yosuke-furukawa.hatenablog.com/entry/2021/12/27/220312\">言っていました</a>が， <strong>私は違うと思います．</strong></p>\n</details>\n<h2 id=\"かんたん-day-5-hydrothermal-venture\" style=\"position:relative;\"><a href=\"#%E3%81%8B%E3%82%93%E3%81%9F%E3%82%93-day-5-hydrothermal-venture\" aria-label=\"かんたん day 5 hydrothermal venture permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[かんたん] <a href=\"https://adventofcode.com/2021/day/5\">Day 5: Hydrothermal Venture</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-4\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-4\" aria-label=\"概要 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>熱水噴出口の情報から，海水温が高い危険な場所を計算します．</p>\n<p>噴出口の情報は次のように与えられます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0,9 -> 5,9\n8,0 -> 0,8\n9,4 -> 3,4\n2,2 -> 2,1\n7,0 -> 7,4\n6,4 -> 2,0\n0,9 -> 2,9\n3,4 -> 1,4\n0,0 -> 8,8\n5,5 -> 8,2\n...</code></pre></div>\n<p>各座標が整数の2次元平面を考えます．ここで，例えば<code class=\"language-text\">0,9 -> 5,9</code>は，<code class=\"language-text\">(0,9)</code>から<code class=\"language-text\">(5,9)</code>へ熱水が吹き出しており，海水温が高いことを表しています．</p>\n<h3 id=\"part-1-4\" style=\"position:relative;\"><a href=\"#part-1-4\" aria-label=\"part 1 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>噴出口が重なる位置の数を回答します．つまり，入力の線分の交点の数を回答します．また，このパートでは水平または垂直の噴出口のみを考慮すれば良いです．</p>\n<p>2次元配列を用意して，入力の通りに海水温の高い位置をカウントアップしていけば良いです．おそらく計算量的にも問題ない時間で解けます．</p>\n<p>一方で，累積和，<a href=\"https://imoz.jp/algorithms/imos_method.html\">いもす法</a>を使用することでより早く計算できるかもしれません．今回の問題では線分を扱っているので，あまりメリットが無い気もしますが，私はせっかくなのでいもしてみました．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day05-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-4\" style=\"position:relative;\"><a href=\"#part-2-4\" aria-label=\"part 2 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>Part 1に加えて，斜め方向も考慮せよと言われます．Part 1のコードを少し拡張するだけで解けるはずです．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day05-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"ふつう-day-6-lanternfish\" style=\"position:relative;\"><a href=\"#%E3%81%B5%E3%81%A4%E3%81%86-day-6-lanternfish\" aria-label=\"ふつう day 6 lanternfish permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ふつう] <a href=\"https://adventofcode.com/2021/day/6\">Day 6: Lanternfish</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-5\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-5\" aria-label=\"概要 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>ハダカイワシの成長，増加を計算します．</p>\n<p>ハダカイワシは次の規則で成長し，増加します．</p>\n<ul>\n<li>大人の個体は7日に1ひきの子供を産みます</li>\n<li>子供は2日で大人になります</li>\n</ul>\n<p>つまり，各ハダカイワシには子供を生むまでの「内部タイマー」という概念があり，次のように増えます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Initial state: 3,4,3,1,2\nAfter  1 day:  2,3,2,0,1\nAfter  2 days: 1,2,1,6,0,8\nAfter  3 days: 0,1,0,5,6,7,8\nAfter  4 days: 6,0,6,4,5,6,7,8,8\nAfter  5 days: 5,6,5,3,4,5,6,7,7,8\nAfter  6 days: 4,5,4,2,3,4,5,6,6,7\nAfter  7 days: 3,4,3,1,2,3,4,5,5,6\n...</code></pre></div>\n<p>ここで，パズルの入力として初期値が<code class=\"language-text\">3,4,3,1,2</code>のように与えられます．</p>\n<h3 id=\"part-1-5\" style=\"position:relative;\"><a href=\"#part-1-5\" aria-label=\"part 1 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>80日後のハダカイワシの数を回答します．</p>\n<h4 id=\"遅い方法\" style=\"position:relative;\"><a href=\"#%E9%81%85%E3%81%84%E6%96%B9%E6%B3%95\" aria-label=\"遅い方法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>遅い方法</h4>\n<p>一番ナイーブな解法は，各ハダカイワシの内部タイマーを<code class=\"language-text\">[3,4,3,1,2]</code>のような可変長配列で管理し，一日ごとにすべてのタイマーをデクリメントしながら，0を見つけて子供を追加していく方法です．しかしこの方法は計算コストが高いです．</p>\n<h4 id=\"早い方法\" style=\"position:relative;\"><a href=\"#%E6%97%A9%E3%81%84%E6%96%B9%E6%B3%95\" aria-label=\"早い方法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>早い方法</h4>\n<p>上記の増加表を見ていると，ある時点で同じ内部タイマーを持つイワシは，その後の変化が同じであることに気づきます．つまり，イワシごとの内部タイマーを管理するのではなく，内部タイマーごとのイワシの数を覚えれば十分であることになります．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">After  7 days: 3,4,3,1,2,3,4,5,5,6\n\nの場合，\n\n[3,4,3,1,2,3,4,5,5,6]\n\nではなく\n\n[0,1,1,3,2,2,1,0,0]\n\nを扱う</code></pre></div>\n<p>そして，内部タイマーを減らすためには，配列を左にシフトします．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[0,1,1,3,2,2,1,0,0]\n\n日が経過したので左にシフト\n\n[1,1,3,2,2,1,0,0,0]\n\n添字0の位置が1\n→内部タイマー0のイワシが1ひきいる\n→1ひきの子供が生まれる\n→配列の添字8（右端）に1を加算\n\n...</code></pre></div>\n<h4 id=\"もうちょっと早い方法\" style=\"position:relative;\"><a href=\"#%E3%82%82%E3%81%86%E3%81%A1%E3%82%87%E3%81%A3%E3%81%A8%E6%97%A9%E3%81%84%E6%96%B9%E6%B3%95\" aria-label=\"もうちょっと早い方法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>もうちょっと早い？方法</h4>\n<p>言語やデータ構造によっては，配列を左シフトするのは高価かもしれません．</p>\n<p>親イワシは内部タイマーによって順番に子供を産んでいくので，大人イワシだけの配列を作り，「現在子供を産む大人イワシのポインタ」をループさせれば良いと思いました．「子供イワシ」は別のキューで管理し，大人になったら大人イワシ配列へ追加します．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">大人イワシ配列，子供イワシキュー\n[0,1,1,3,2,2,1] [0,0]\n ^現在子供を産むイワシ\n\n→子供を産むイワシなし，成長して大人になったイワシなし\n\n[次の日]\n\n[0,1,1,3,2,2,1] [0,1]\n   ^現在子供を産むイワシ\n\n→子供を産むイワシ1ひき，成長して大人になったイワシなし\n\n[次の日]\n\n[0,1,1,3,2,2,1] [1,1]\n     ^現在子供を産むイワシ\n\n→子供を産むイワシ1ひき，成長して大人になったイワシなし\n\n[次の日]\n\n[0,1,2,3,2,2,1] [1,3]\n       ^現在子供を産むイワシ\n\n→子供を産むイワシ1ひき，成長して大人になったイワシ1ひき（現在子供を産むイワシポインタの直前に加算）\n\n...</code></pre></div>\n<p>以下のコードはこの方法で実装されています．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day06-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-5\" style=\"position:relative;\"><a href=\"#part-2-5\" aria-label=\"part 2 5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>255日後のイワシの数を回答します．上記のナイーブな実装ではきついはずです．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day06-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"かんたん-day-7-the-treachery-of-whales\" style=\"position:relative;\"><a href=\"#%E3%81%8B%E3%82%93%E3%81%9F%E3%82%93-day-7-the-treachery-of-whales\" aria-label=\"かんたん day 7 the treachery of whales permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[かんたん] <a href=\"https://adventofcode.com/2021/day/7\">Day 7: The Treachery of Whales</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-6\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-6\" aria-label=\"概要 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>横方向にしか動けないカニの潜水艦を縦に整列させる問題です．（そして，カニ潜水艦から出るビームか何かで海底を破壊するらしいです）</p>\n<p>カニ潜水艦の初期位置が<code class=\"language-text\">16,1,2,0,4,2,7,1,2,14</code>のように与えられます．図示すると以下のようになります．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">位置:     0123456789...\n潜水艦1:                  #\n潜水艦2:   #\n潜水艦3:    #\n潜水艦4:  #\n潜水艦5:      #\n潜水艦6:    #\n潜水艦7:         #\n潜水艦8:   #\n潜水艦9:    #\n潜水艦10:               #</code></pre></div>\n<h3 id=\"part-1-6\" style=\"position:relative;\"><a href=\"#part-1-6\" aria-label=\"part 1 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>カニ潜水艦は横へ1つ動くのに燃料を1消費します．全体の燃料が最も少なくなる整列位置を回答します．（上記の例では位置2が最もエコらしいです）</p>\n<p>全域探索で解きました．すべての位置について消費燃料を計算し，最小値を求めればいいです．もっと効率の良い方法があるかもしれません．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day07-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-6\" style=\"position:relative;\"><a href=\"#part-2-6\" aria-label=\"part 2 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>実はカニ潜水艦は，横へ1つ動くのに燃料1，もう1つ動くのに燃料2，さらに動くのに燃料3を消費するのだそうです．そのうえで全体の燃料が最も少なくなる位置を回答します．</p>\n<p>こちらも全域探索でゴリ押して解けました．各潜水艦の消費コストは，等差数列の和の公式を知っていれば <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathcal{O}(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></span> で求まります．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day07-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"むずかしい-day-8-seven-segment-search\" style=\"position:relative;\"><a href=\"#%E3%82%80%E3%81%9A%E3%81%8B%E3%81%97%E3%81%84-day-8-seven-segment-search\" aria-label=\"むずかしい day 8 seven segment search permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[むずかしい] <a href=\"https://adventofcode.com/2021/day/8\">Day 8: Seven Segment Search</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-7\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-7\" aria-label=\"概要 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>配線がおかしい7セグの表示を復元する問題です．</p>\n<p>次のような入力が与えられます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">eadbcf faceb faecgd gdefabc adc ad adbf gfacbe bceda dcegb | gdfcae adc cedbfa dafb\nedbfga begcd cbg gc gcadebf fbgde acbgfd abcde gfcbed gfec | fcgedb cgb dgebacf gc\nfgaebd cg bdaec gdafb agbcfd gdcbef bgcad gfac gcb cdgabef | cg cg fdcagb cbg\n...</code></pre></div>\n<p>潜水艦にはたくさんの7セグ4桁 ディスプレイが搭載されていますが，それぞれで配線がおかしいです．各行は，各4桁7セグディスプレイに関する情報です．</p>\n<p>今は1つの行，1つの7セグ4桁 ディスプレイに着目します．</p>\n<p>ディスプレイは次のようになっています．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">潜水艦からの入力: a b c d e f g\n                  | | | | | | |\n            [ここで配線が入れ替わっている]\n                  | | | | | | |\nディスプレイ入力: a b c d e f g\n aa  |  aa  |  aa  |  aa\nb  c | b  c | b  c | b  c\nb  c | b  c | b  c | b  c\n dd  |  dd  |  dd  |  dd\ne  f | e  f | e  f | e  f\ne  f | e  f | e  f | e  f\n gg  |  gg  |  gg  |  gg</code></pre></div>\n<p>つまり，1つのディスプレイ内の全ての桁は同じ配線ミスの影響を受けます．このディスプレイに対応する次の入力に着目します．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">eadbcf faceb faecgd gdefabc adc ad adbf gfacbe bceda dcegb | gdfcae adc cedbfa dafb</code></pre></div>\n<p>行の右側は，現在点灯しているディスプレイ側のセグを表しています．1桁目は<code class=\"language-text\">cdfeb</code>，2桁目は<code class=\"language-text\">fcadb</code>…が点灯しています．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">潜水艦からの入力: a b c d e f g\n                  | | | | | | |\n            [ここで配線が入れ替わっている]\n                  | | | | | | |\nディスプレイ入力: a b c d e f g\n ##  |  ##  |  ##  |  ##\n.  # | .  # | #  # | #  .\n.  # | .  # | #  # | #  .\n ##  |  ##  |  ##  |  ##\n#  # | .  . | #  # | .  #\n#  # | .  . | #  # | .  #\n ##  |  ..  |  ..  |  ..</code></pre></div>\n<p>配線がおかしいので表示がめちゃくちゃです．</p>\n<p>入力行の左側は，表示されうるディスプレイ側のパターンを表しています．0〜9の10パターンあります．つまり，<code class=\"language-text\">ad</code>はディスプレイのaとdが同時に表示されうることを表します．</p>\n<p>このようなディスプレイが入力行の数だけ潜水艦に設置されています．</p>\n<h3 id=\"part-1-7\" style=\"position:relative;\"><a href=\"#part-1-7\" aria-label=\"part 1 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>潜水艦の全てのディスプレイに1, 4, 7, 8がいくつ表示されているか求められます．これらの数字は，表示のために必要なセグ数が固有なので，配線ミスの影響を受けずに識別可能です．</p>\n<p>例えば，1を表示するためには2つのセグが必要ですが，0〜9の他の数字で2つのセグのみで表示できるものはありません．</p>\n<p>したがって，入力行の右側で2つのセグを使用しているものを数えれば，潜水艦全体の1の個数がわかります．</p>\n<p>他の数字に関しても同様に数えるだけです．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day08-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-7\" style=\"position:relative;\"><a href=\"#part-2-7\" aria-label=\"part 2 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>各ディスプレイの表示を解析し，数値の合計値を回答します．</p>\n<p>ここでは，ディスプレイ側の各セグごとに「接続されうる潜水艦側のセグ」を管理して解きました．以下の行を例に詳しく説明します．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">eadbcf faceb faecgd gdefabc adc ad adbf gfacbe bceda dcegb | gdfcae adc cedbfa dafb</code></pre></div>\n<p>行の左側について，まず表示セグの数ごとに整理します．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">//表示セグ2個（表している数字は1）\nad\n\n// 表示セグ3個（表している数字は7）\nadc\n\n// 表示セグ4個（表している数字は4）\nadbf\n\n// 表示セグ5個（表している数字は2 or 3 or 5）\nfaceb\nbceda\ndcegb\n\n// 表示セグ6個（表している数字は0 or 6 or 9）\neadbcf\nfaecgd\ngfacbe\n\n// 表示セグ7個（表している数字は8）\ngdefabc</code></pre></div>\n<p>次に，ディスプレイの各セグについて「接続されうる潜水艦側のセグ」を準備します．最初は全ての可能性があるので次のようになります．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ディスプレイセグa: (a, b, c, d, e, f, g)\nディスプレイセグb: (a, b, c, d, e, f, g)\nディスプレイセグc: (a, b, c, d, e, f, g)\nディスプレイセグd: (a, b, c, d, e, f, g)\nディスプレイセグe: (a, b, c, d, e, f, g)\nディスプレイセグf: (a, b, c, d, e, f, g)\nディスプレイセグg: (a, b, c, d, e, f, g)</code></pre></div>\n<p>ここで，例えば<code class=\"language-text\">ad</code>の情報を使うと次のように推論できます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\"ad\"は表示に2個のセグを使う\n→2個のセグで表示する数字は1しかない\n→したがって，ディスプレイセグのaとdには，潜水艦側のcまたはfしか接続され得ない\n\nディスプレイセグa: (c, f)\nディスプレイセグb: (a, b, c, d, e, f, g)\nディスプレイセグc: (a, b, c, d, e, f, g)\nディスプレイセグd: (c, f)\nディスプレイセグe: (a, b, c, d, e, f, g)\nディスプレイセグf: (a, b, c, d, e, f, g)\nディスプレイセグg: (a, b, c, d, e, f, g)\n\nまた，ディスプレイセグのaとd以外に，潜水艦側のcとfが接続されることはない\n\nディスプレイセグa: (c, f)\nディスプレイセグb: (a, b, d, e, g)\nディスプレイセグc: (a, b, d, e, g)\nディスプレイセグd: (c, f)\nディスプレイセグe: (a, b, d, e, g)\nディスプレイセグf: (a, b, d, e, g)\nディスプレイセグg: (a, b, d, e, g)</code></pre></div>\n<p>続けて，例えば<code class=\"language-text\">faceb</code>，<code class=\"language-text\">bceda</code>，<code class=\"language-text\">dcegb</code>の情報を使うと次にように推論できます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\"faceb\"，\"bceda\"，\"dcegb\"に関して，それぞれの表示に5個のセグを使う\n→2または3または5の入力である\n→それぞれにセグb，c，eが共通して現れている．\n→これらは2，3，5の表示に共通して使う部分（以下参照）が接続されているディスプレイセグである\n ##  // #: 共通部分\n.  . // .: 非共通部分\n.  .\n ##\n.  .\n.  .\n ##\n→つまり，これらのセグには，2，3，5の表示に共通して使わない部分の潜水艦側セグは接続されていない\n→ディスプレイセグb，c，eからb，c，e，fを削除\n\nディスプレイセグa: (c, f)\nディスプレイセグb: (a, d, g)\nディスプレイセグc: (a, d, g)\nディスプレイセグd: (c, f)\nディスプレイセグe: (a, d, g)\nディスプレイセグf: (a, b, d, e, g)\nディスプレイセグg: (a, b, d, e, g)\n\nまた，\"faceb\"，\"bceda\"，\"dcegb\"に「現れているが共通していないセグ」には，2，3，5の表示に共通して使う部分の潜水艦側セグは接続されていない\n→つまり，\"faceb\" | \"bceda\" | \"dcegb\" - \"faceb\" &amp; \"bceda\" &amp; \"dcegb\"＝\"adfg\"には，潜水艦側のa，d，gは接続されない\n→ディスプレイセグa，d，f，gからa，d，gを削除\n\nディスプレイセグa: (c, f)\nディスプレイセグb: (a, d, g)\nディスプレイセグc: (a, d, g)\nディスプレイセグd: (c, f)\nディスプレイセグe: (a, d, g)\nディスプレイセグf: (b, e)\nディスプレイセグg: (b, e)</code></pre></div>\n<p>…というようにして，全ての制約を使うと潜水艦側セグとディスプレイセグの対応関係がわかります．あとは，その対応関係と入力行右側の情報を使ってディスプレイに本来表示されるはずだった数値を復元し，それをすべての行に対して実行し，合計を求めました．</p>\n<p>効率性や計算量などは問題になりませんでしたが，とにかく上記のアルゴリズムを実装に落とし込むのが大変でした．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day08-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"かんたん-day-9-smoke-basin\" style=\"position:relative;\"><a href=\"#%E3%81%8B%E3%82%93%E3%81%9F%E3%82%93-day-9-smoke-basin\" aria-label=\"かんたん day 9 smoke basin permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[かんたん] <a href=\"https://adventofcode.com/2021/day/9\">Day 9: Smoke Basin</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-8\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-8\" aria-label=\"概要 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>海底の標高マップから盆地を見つける問題です．海底火山の煙を回避するために，煙の流れを見たいそうです．</p>\n<p>次のようなマップが入力されます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2199943210\n3987894921\n9856789892\n8767896789\n9899965678</code></pre></div>\n<p>各数字はその地点の標高です．</p>\n<h3 id=\"part-1-8\" style=\"position:relative;\"><a href=\"#part-1-8\" aria-label=\"part 1 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>周囲よりも低い場所のリスクレベルを回答します．リスクレベルは，その位置の<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>標高</mtext><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">標高 + 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord cjk_fallback\">標高</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span>です．つまり，上下左右の自分自身よりも高い場所について，その標高の合計を数えます．マップの端は反対側と隣接していません．</p>\n<p>基本的に全域探索しました．マップの端付近では周囲のセルが3個だったり2個だったりになるので，そのへんだけ注意していれば問題なく解けます．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day09-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-8\" style=\"position:relative;\"><a href=\"#part-2-8\" aria-label=\"part 2 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>盆地を探索します．盆地とは9以外のセルのクラスタです．例えば次のようなものです．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">##99943210\n#987894921\n9856789892\n8767896789\n9899965678</code></pre></div>\n<p>すべての盆地を面積が大きい順に並べて，最大3つの面積の積を回答します．</p>\n<p>まず，盆地の面積を深さ優先探索する次のような関数を作りました．</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">find_basin_cells</span><span class=\"token operator\">&lt;</span><span class=\"token lifetime-annotation symbol\">'a</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span>\n    point<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Point</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">usize</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n    visited_points<span class=\"token punctuation\">:</span> <span class=\"token operator\">&amp;</span><span class=\"token lifetime-annotation symbol\">'a</span> <span class=\"token keyword\">mut</span> <span class=\"token class-name\">HashSet</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">Point</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">usize</span><span class=\"token operator\">>></span><span class=\"token punctuation\">,</span>\n    map<span class=\"token punctuation\">:</span> <span class=\"token operator\">&amp;</span><span class=\"token lifetime-annotation symbol\">'a</span> <span class=\"token class-name\">Map</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> <span class=\"token operator\">&amp;</span><span class=\"token lifetime-annotation symbol\">'a</span> <span class=\"token keyword\">mut</span> <span class=\"token class-name\">HashSet</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">Point</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">usize</span><span class=\"token operator\">>></span></code></pre></div>\n<p>そして，マップのすべての位置に対してこの関数を実行して盆地を探索しました．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day09-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"かんたん-day-10-syntax-scoring\" style=\"position:relative;\"><a href=\"#%E3%81%8B%E3%82%93%E3%81%9F%E3%82%93-day-10-syntax-scoring\" aria-label=\"かんたん day 10 syntax scoring permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[かんたん] <a href=\"https://adventofcode.com/2021/day/10\">Day 10: Syntax Scoring</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-9\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-9\" aria-label=\"概要 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>カッコを数える問題です．入力は次のようなものです．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[({(&lt;(())[]>[[{[]{&lt;()&lt;>>\n[(()[&lt;>])]({[&lt;{&lt;&lt;[]>>(\n{([(&lt;{}[&lt;>[]}>{[]{[(&lt;()>\n...</code></pre></div>\n<p>各開きカッコはそれぞれの閉じカッコに対応します．</p>\n<p>入力の各行には，カッコの対応が不正なものと，不完全（不正ではないが閉じカッコが足りない）なものがあります．</p>\n<h3 id=\"part-1-9\" style=\"position:relative;\"><a href=\"#part-1-9\" aria-label=\"part 1 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>不正な行に関して「構文エラー得点」を計算します．構文エラー得点ってなんやねん．各行の一番左の不正なカッコについて以下の規則で得点を付与し，その合計を回答します．</p>\n<ul>\n<li><code class=\"language-text\">)</code>: 3 points.</li>\n<li><code class=\"language-text\">]</code>: 57 points.</li>\n<li><code class=\"language-text\">}</code>: 1197 points.</li>\n<li><code class=\"language-text\">></code>: 25137 points.</li>\n</ul>\n<p>各行を左から操作します．開きカッコがあればスタックに積み，閉じカッコがあればスタックから下ろします．下ろす際，開きカッコに対応しないのであれば構文エラーで得点が加算されます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">入力が\"[{}>\"の場合\n\nスタック: []\n[{}>\n\nスタック: [ // 開きカッコなのでスタックに積む\n[{}>\n^ポインタ\n\nスタック: [{ // 開きカッコなのでスタックに積む\n[{}>\n ^ポインタ\n\nスタック: [ // \"{\"を\"}\"で消費\n[{}>\n  ^ポインタ\n\nスタック: [ // \"[\"を\">\"で消費できない！構文エラー，25137ポイント！\n[{}>\n   ^ポインタ</code></pre></div>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day10-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-9\" style=\"position:relative;\"><a href=\"#part-2-9\" aria-label=\"part 2 9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>不完全な行に対して足りないカッコを補完します．保管する際，以下の規則でやはり「補完ポイント」が得られます（？）．全ての行の補完ポイント中央値を回答します．</p>\n<h4 id=\"得点規則\" style=\"position:relative;\"><a href=\"#%E5%BE%97%E7%82%B9%E8%A6%8F%E5%89%87\" aria-label=\"得点規則 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>得点規則</h4>\n<ul>\n<li>文字を保管する度に\n<ul>\n<li>いままでの得点を5倍</li>\n<li>対応した得点を加算\n<ul>\n<li><code class=\"language-text\">)</code>: 1 point.</li>\n<li><code class=\"language-text\">]</code>: 2 points.</li>\n<li><code class=\"language-text\">}</code>: 3 points.</li>\n<li><code class=\"language-text\">></code>: 4 points.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>補完処理はPart 1のコードの拡張で実現できます．エラー無く最後の文字まで読んだ時，スタックに残っている開きカッコから閉じカッコを保管します．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">入力が\"[{\"の場合\n\nスタック: []\n[{\n\nスタック: [ // 開きカッコなのでスタックに積む\n[{\n^ポインタ\n\nスタック: [{ // 開きカッコなのでスタックに積む\n[{\n ^ポインタ\n\n入力を全て読んだがスタックが空でないので補完可能\n\nスタック: [ // 開きカッコを消費\n[{} // 対応する閉じカッコを補完，3ポイント\n  ^ポインタ\n\nスタック: // 開きカッコを消費\n[{}] // 対応する閉じカッコを補完，15 + 2 = 17ポイント\n   ^ポインタ\n\nスタックが空なので修了</code></pre></div>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day10-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"かんたん-day-11-dumbo-octopus\" style=\"position:relative;\"><a href=\"#%E3%81%8B%E3%82%93%E3%81%9F%E3%82%93-day-11-dumbo-octopus\" aria-label=\"かんたん day 11 dumbo octopus permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[かんたん] <a href=\"https://adventofcode.com/2021/day/11\">Day 11: Dumbo Octopus</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-10\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-10\" aria-label=\"概要 10 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>光るタコのパターンを予測する問題です．</p>\n<p>10 * 10のグリッドにタコが隙間なく敷き詰められています（そんなことある？）</p>\n<ul>\n<li>それぞれのタコはエネルギーレベルを持っています．</li>\n<li>レベルは各ステップごとに1増加します</li>\n<li>エネルギーが10以上になるとタコは発光し，エネルギーが即座に0へ戻ります．\n<ul>\n<li>（つまり，各ステップでタコのエネルギーは0〜9しかありえない）</li>\n</ul>\n</li>\n<li>発光した際，周囲8つのタコのエネルギーを1増加します．</li>\n<li>これにより発光の連鎖もあり得ます\n<ul>\n<li>ただし，そのステップで発光したタコは（エネルギーが0のタコは），ほかのタコによってエネルギーを増加されません．</li>\n</ul>\n</li>\n</ul>\n<p>タコのエネルギーの初期値が次のように与えられます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">5483143223\n2745854711\n5264556173\n6141336146\n6357385478\n4167524645\n2176841721\n6882881134\n4846848554\n5283751526</code></pre></div>\n<h3 id=\"part-1-10\" style=\"position:relative;\"><a href=\"#part-1-10\" aria-label=\"part 1 10 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>100ステップまでに発光したタコの個数を回答します．</p>\n<p>上記の規則を愚直に実装していけば問題ありません．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day11-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-10\" style=\"position:relative;\"><a href=\"#part-2-10\" aria-label=\"part 2 10 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>全てのタコは同時に発光する瞬間のステップ数を回答します．</p>\n<p>これも，Part 1のコードを少し拡張すればすぐに求められます．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day11-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"ふつう-day-12-passage-pathing\" style=\"position:relative;\"><a href=\"#%E3%81%B5%E3%81%A4%E3%81%86-day-12-passage-pathing\" aria-label=\"ふつう day 12 passage pathing permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ふつう] <a href=\"https://adventofcode.com/2021/day/12\">Day 12: Passage Pathing</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-11\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-11\" aria-label=\"概要 11 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>洞窟を探索します．洞窟はいくつかの部屋にわかれており，次のような形式で地図が入力されます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">start-A\nstart-b\nA-c\nA-b\nb-d\nA-end\nb-end</code></pre></div>\n<p>図にすると以下のとおりです．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">    start\n    /   \\\nc--A-----b--d\n    \\   /\n     end</code></pre></div>\n<p>部屋には小部屋（小文字で表される）と大部屋（大文字で表される）があります．</p>\n<h3 id=\"part-1-11\" style=\"position:relative;\"><a href=\"#part-1-11\" aria-label=\"part 1 11 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>それぞれの小部屋を高々1度しか訪れてはいけない場合の，スタートからゴールまでのパスの数を回答します．</p>\n<p>グラフの表現には様々な方法があります．ハッシュマップや集合が使えればそれが一番楽だと思いますが，しっかりとノード，枝といった構造体を作ってもいいですね．</p>\n<p>全てのパスを求めなければなりませんが，計算量が問題となるほどのグラフではありませんでした．そのため，愚直にDFSで解きました．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">type Node = String;\ntype Path = Vec&lt;Node>;\nfn visit(path: &amp;Path, map: &amp;Map) -> Vec&lt;Path> {}</code></pre></div>\n<p>として，パスを見ながら行ける部屋に全て行くというものです．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day12-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-11\" style=\"position:relative;\"><a href=\"#part-2-11\" aria-label=\"part 2 11 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p><strong>1度だけ個部屋に2度訪れていい</strong> という条件のもとで，スタートからゴールまでのパスの数を回答します．各部屋に2度訪れても良いというわけではないので注意してください．</p>\n<p>基本的にはPart 1の拡張で解けます．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day12-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"かんたん-day-13-transparent-origami\" style=\"position:relative;\"><a href=\"#%E3%81%8B%E3%82%93%E3%81%9F%E3%82%93-day-13-transparent-origami\" aria-label=\"かんたん day 13 transparent origami permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[かんたん] <a href=\"https://adventofcode.com/2021/day/13\">Day 13: Transparent Origami</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-12\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-12\" aria-label=\"概要 12 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>おりがみをする問題です．潜水艦の赤外線カメラを使用したいのですが，そのカメラを使用するためのシリアルキーが折り紙に印字されているらしいです．</p>\n<p>入力は次のようなものです．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">6,10\n0,14\n9,10\n0,3\n10,4\n4,11\n6,0\n6,12\n4,1\n0,13\n10,12\n3,4\n3,0\n8,4\n1,10\n2,14\n8,10\n9,0\n\nfold along y=7\nfold along x=5</code></pre></div>\n<p>入力の最初の方には2次元平面の点が並んでいます．この点は透明な折り紙シートに打たれている点です．最後の方には折り方の指示が書かれています．例えば，<code class=\"language-text\">fold along y=7</code>は <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mn>7</mn></mrow><annotation encoding=\"application/x-tex\">y = 7</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">7</span></span></span></span></span> の直線に紙を折ることを示しています．</p>\n<h3 id=\"part-1-12\" style=\"position:relative;\"><a href=\"#part-1-12\" aria-label=\"part 1 12 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>紙を1回折った後の点の数を回答します．</p>\n<p>まず，点群の表現方法について考えます．本番用のパズル入力の折り方指示を見ると，<code class=\"language-text\">x = 655</code>といった大きな数字であることがわかります．つまり，この紙の高さや幅は1300以上もあるということです．紙を2次元配列で表現する方法もありますが，約170万個もの要素をメモリ上に確保するのは大変そうです．そのため，以下のようにガッシュセットを使って点群を表現することにしました．</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">type</span> <span class=\"token type-definition class-name\">Point</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">u32</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">u32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token type-definition class-name\">Map</span> <span class=\"token operator\">=</span> <span class=\"token class-name\">HashSet</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">Point</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>これによって，メモリ消費量が点の数に対して線形になるのでエコだと思います．</p>\n<p>次に，紙を折るという処理を考えます．とはいえ座標を変換するだけなので少し考えればかんたんです．例えば以下の紙上の点pを座標変換する場合を考えます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">  01234\n0 .....\n1 .....\n2 .....\n3 ----- // y=3で折る\n4 .....\n5 ..p..\n6 .....</code></pre></div>\n<p>ここで，x座標はそのまま2です．y座標に関しては，「折り目からpまでの距離の2倍をpから引けばいい」と図形的にわかります．したがって，</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mtext>移動後の</mtext><mi>y</mi><mtext>座標</mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msub><mi>p</mi><mi>y</mi></msub><mo>−</mo><mn>2</mn><mo>×</mo><mo stretchy=\"false\">(</mo><msub><mi>p</mi><mi>y</mi></msub><mo>−</mo><mtext>折り目</mtext><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>2</mn><mo>×</mo><mtext>折り目</mtext><mi>y</mi><mo>−</mo><msub><mi>p</mi><mi>y</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>2</mn><mo>×</mo><mn>3</mn><mo>−</mo><mn>5</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n移動後のy座標 &#x26;= p_y - 2 \\times (p_y - 折り目y) \\\\\n              &#x26;= 2 \\times 折り目y - p_y \\\\\n              &#x26;= 2 \\times 3 - 5 \\\\\n              &#x26;= 1\n\\end{aligned}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:6em;vertical-align:-2.75em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">移動後の</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord cjk_fallback\">座標</span></span></span><span style=\"top:-3.91em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-0.91em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord cjk_fallback\">折り目</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.91em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord cjk_fallback\">折り目</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">5</span></span></span><span style=\"top:-0.91em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span></span></span></span></span></span></span></div>\n<p>となります．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">  01234\n0 .....\n1 ..p..\n2 .....\n3 ----- // y=3で折った</code></pre></div>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day13-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-12\" style=\"position:relative;\"><a href=\"#part-2-12\" aria-label=\"part 2 12 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>Part 1のコードを使って，残りの指示通りに折っていくとシリアルキーが図形的に浮かび上がります．<code class=\"language-text\">Map</code>を表示する関数を追加で実装する必要があるでしょう．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day13-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"ふつう-day-14-extended-polymerization\" style=\"position:relative;\"><a href=\"#%E3%81%B5%E3%81%A4%E3%81%86-day-14-extended-polymerization\" aria-label=\"ふつう day 14 extended polymerization permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ふつう] <a href=\"https://adventofcode.com/2021/day/14\">Day 14: Extended Polymerization</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-13\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-13\" aria-label=\"概要 13 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>ポリマーの生成過程をシミュレートします．次のような入力が与えられます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">NNCB\n\nCH -> B\nHH -> N\nCB -> H\nNH -> C\nHB -> C\nHC -> B\nHN -> C\nNN -> C\nBH -> H\nNC -> B\nNB -> B\nBN -> B\nBB -> N\nBC -> B\nCC -> N\nCN -> C</code></pre></div>\n<p>最初の行はポリマーの初期状態です．ポリマーは<code class=\"language-text\">B</code>，<code class=\"language-text\">N</code>，<code class=\"language-text\">C</code>，<code class=\"language-text\">H</code>といった要素が単連結してできています．</p>\n<p>その後の入力はポリマーの生成ルールです．<code class=\"language-text\">AB -> C</code>といった表記は，1ステップ経過するたびに<code class=\"language-text\">AB</code>の間に<code class=\"language-text\">C</code>という要素が増えることを意味しています．</p>\n<p>ポリマーは以下のように増えていきます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Template:     NNCB\n\n\"NN -> C\"によってCを挿入，\"NC -> B\"によってBを挿入，\"CB -> H\"によってHを挿入\n\nAfter step 1: NCNBCHB\nAfter step 2: NBCCNBBBCBHCB\n...</code></pre></div>\n<h3 id=\"part-1-13\" style=\"position:relative;\"><a href=\"#part-1-13\" aria-label=\"part 1 13 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>10ステップ経過後のポリマーにおいて，一番多い要素と一番少ない要素の差を回答します．</p>\n<h4 id=\"ナイーブな解法\" style=\"position:relative;\"><a href=\"#%E3%83%8A%E3%82%A4%E3%83%BC%E3%83%96%E3%81%AA%E8%A7%A3%E6%B3%95\" aria-label=\"ナイーブな解法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ナイーブな解法</h4>\n<p>以下のように，可変長配列などを用いてポリマーを表現し，先頭から生成ルールを適用していきます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">現状のポリマー：['N',      'N',      'C',      'B']\n\n  次のポリマー：['N', 'C', 'N', 'B', 'C', 'H', 'B']\n                       ^追加     ^追加     ^追加\n...</code></pre></div>\n<p>しかし，ポリマー長さは二次関数的に増加していくので，この方法ではすぐに限界が来ます．</p>\n<h4 id=\"効率的な解法\" style=\"position:relative;\"><a href=\"#%E5%8A%B9%E7%8E%87%E7%9A%84%E3%81%AA%E8%A7%A3%E6%B3%95\" aria-label=\"効率的な解法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>効率的な解法</h4>\n<p>上記の手法では，とても長いポリマーに対して高々16個しかない生成ルールを繰り返し適用しているのがムダでした．今回の問題では我々は要素の <strong>隣接</strong> にしか興味がないことに気づきました．そのため，以下のようなアルゴリズムで効率よく解けます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Template: NNCB\n→次の構造を初期化する\n\n// 要素個数マップ\n[\n    N -> 2\n    C -> 1\n    B -> 1\n]\n// 隣接個数マップ\n[\n    NN -> 1\n    NC -> 1\n    CB -> 1\n]\n\nステップ1\n1. 新しい隣接個数マップを用意\n2. 隣接個数マップの各隣接について以下を実行\n  1. 新しく増える要素をルールから特定\n  2. 新しく増える隣接を，新しい隣接個数マップに追加\n  例：NN -> 1の場合\n    →ルール「NN->C」によって間にCが増える．\n    →つまり「NC」と「CN」の隣接が増えるので，新しい隣接個数マップに記録．\n\nステップ2\n...</code></pre></div>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day14-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-13\" style=\"position:relative;\"><a href=\"#part-2-13\" aria-label=\"part 2 13 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>上記のナイーブな実装だと厳しいはずです．効率的な解法を使いました．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day14-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"ふつう-day-15-chiton\" style=\"position:relative;\"><a href=\"#%E3%81%B5%E3%81%A4%E3%81%86-day-15-chiton\" aria-label=\"ふつう day 15 chiton permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ふつう] <a href=\"https://adventofcode.com/2021/day/15\">Day 15: Chiton</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-14\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-14\" aria-label=\"概要 14 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>次のような入力が与えられます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">1163751742\n1381373672\n2136511328\n3694931569\n7463417111\n1319128137\n1359912421\n3125421639\n1293138521\n2311944581</code></pre></div>\n<p>これは2次元のマップで，左上がスタート，左下がゴール，各数値はその地点の <strong>リスクレベル</strong> です．</p>\n<h3 id=\"part-1-14\" style=\"position:relative;\"><a href=\"#part-1-14\" aria-label=\"part 1 14 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>あるパスのリスクレベルは，その軌跡の各地点のリスクレベルの合計です．スタートからゴールまでのあらゆるパスの中で，もっとも低いリスクレベルの値を回答します．</p>\n<p>この問題は普通にA*探索で突破しました．ヒューリスティック関数には，ゴールまでのマンハッタン距離を採用しました．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day15-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-14\" style=\"position:relative;\"><a href=\"#part-2-14\" aria-label=\"part 2 14 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>Part 1に比べてマップの広さが1辺5倍になります．これもPart 1と全く同じアルゴリズムで解きました．ただし，探索に4分ほどかかってしまっています．こう少し効率的な解き方がありそうです．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day15-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"ふつう-day-16-packet-decoder\" style=\"position:relative;\"><a href=\"#%E3%81%B5%E3%81%A4%E3%81%86-day-16-packet-decoder\" aria-label=\"ふつう day 16 packet decoder permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ふつう] <a href=\"https://adventofcode.com/2021/day/16\">Day 16: Packet Decoder</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-15\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-15\" aria-label=\"概要 15 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>バイナリにデコードされた数式をパースする問題です．次のような入力が与えられます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">E20D7880532D4E551A5791BD7B8C964C1548CB3...</code></pre></div>\n<p>上記のデータがどのような数式を表すのか…という仕様の部分は問題本文を参照してください．</p>\n<p>今までの問題と比べて仕様が複雑です．難しいアルゴリズムなどは必要ない代わりに，仕様を正確にコードで変換するモデリング力が試されます．ときにはテストなども書きつつ，動作を確認しながらコーディングする必要があるでしょう．私はテストを書いていませんが．</p>\n<h3 id=\"part-1-15\" style=\"position:relative;\"><a href=\"#part-1-15\" aria-label=\"part 1 15 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>全てのパケットにはバージョン番号があり，ここではその番号の合計値を回答します．パケットのパースがうまくできているかを一度確かめに来ている感じです．</p>\n<p>どうせ後から実際の計算も行わなければならなくなるので，<code class=\"language-text\">入力データ -[パーサー]-> AST -[評価器]-> 計算結果</code>という構成をとることにしました．</p>\n<p>ASTといってもそんなに複雑なものではなくて，以下のようなノードのあつまりです．</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">enum</span> <span class=\"token type-definition class-name\">Node</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">Literal</span> <span class=\"token punctuation\">{</span>\n        version<span class=\"token punctuation\">:</span> <span class=\"token keyword\">u8</span><span class=\"token punctuation\">,</span>\n        type_id<span class=\"token punctuation\">:</span> <span class=\"token keyword\">u8</span><span class=\"token punctuation\">,</span>\n        value<span class=\"token punctuation\">:</span> <span class=\"token keyword\">u128</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token class-name\">Operator</span> <span class=\"token punctuation\">{</span>\n        version<span class=\"token punctuation\">:</span> <span class=\"token keyword\">u8</span><span class=\"token punctuation\">,</span>\n        type_id<span class=\"token punctuation\">:</span> <span class=\"token keyword\">u8</span><span class=\"token punctuation\">,</span>\n        nodes<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Vec</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">Node</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Part 1ではパーサーのみを愚直に実装しました．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day16-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-15\" style=\"position:relative;\"><a href=\"#part-2-15\" aria-label=\"part 2 15 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>Part 2ではASTを値に評価する部分を作成しました．こちらのほうが分量は軽かったです．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day16-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"かんたん-day-17-trick-shot\" style=\"position:relative;\"><a href=\"#%E3%81%8B%E3%82%93%E3%81%9F%E3%82%93-day-17-trick-shot\" aria-label=\"かんたん day 17 trick shot permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[かんたん] <a href=\"https://adventofcode.com/2021/day/17\">Day 17: Trick Shot</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-16\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-16\" aria-label=\"概要 16 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>簡単な物理シミュレーションを実装します．鍵が海のある領域にあるかもしれないため，そこにセンサーを放り投げて調査するそうです．</p>\n<p>調査したい範囲に関する次のような入力が与えられます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">target area: x=20..30, y=-10..-5</code></pre></div>\n<p>ここは2次元空間で，自分は<code class=\"language-text\">(0, 0)</code>にいます．センサーを<code class=\"language-text\">S</code>から右上に投げた様子を図示すると次のようになります．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.............#....#............\n.......#..............#........\n...............................\nS........................#.....\n...............................\n...............................\n...........................#...\n...............................\n....................TTTTTTTTTTT\n....................TTTTTTTTTTT\n....................TTTTTTTT#TT\n....................TTTTTTTTTTT\n....................TTTTTTTTTTT\n....................TTTTTTTTTTT</code></pre></div>\n<p>放り投げたセンサーは次の法則で運動します．</p>\n<ul>\n<li>各ステップごとに\n<ul>\n<li>横方向の速度が1減少する（水の抵抗）</li>\n<li>深さ方向の速度が1増加する（重力加速度）</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"part-1-16\" style=\"position:relative;\"><a href=\"#part-1-16\" aria-label=\"part 1 16 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p><code class=\"language-text\">S</code>から様々な初期速度でセンサーを投げてターゲットに入ったとして，センサーが到達する最も高い位置を回答します．</p>\n<p>なお，次のような <strong>オーバーシュート</strong> は領域に入ったとみなされません．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">S..............................................................\n...............................................................\n...............................................................\n...............................................................\n.................#.............................................\n....................TTTTTTTTTTT................................\n....................TTTTTTTTTTT................................\n....................TTTTTTTTTTT................................\n....................TTTTTTTTTTT................................\n....................TTTTTTTTTTT..#.............................\n....................TTTTTTTTTTT................................\n...............................................................\n...............................................................\n...............................................................\n...............................................................\n................................................#..............\n...............................................................\n...............................................................\n...............................................................\n...............................................................\n...............................................................\n...............................................................\n..............................................................#</code></pre></div>\n<p>→ 速度が早すぎて領域を飛び越してしまっています．</p>\n<h4 id=\"愚直な解法\" style=\"position:relative;\"><a href=\"#%E6%84%9A%E7%9B%B4%E3%81%AA%E8%A7%A3%E6%B3%95\" aria-label=\"愚直な解法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>愚直な解法</h4>\n<p>あらゆる方向に飛ばしてみる，という方法をまず思いつきます．つまり初速 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><msub><mi>v</mi><mn>0</mn></msub><mo>⃗</mo></mover><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>v</mi><mi>x</mi></msub><mo separator=\"true\">,</mo><msub><mi>v</mi><mi>y</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\vec{v_0} = (v_x, v_y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.864em;vertical-align:-0.15em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.714em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2355em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"></path></svg></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span> を <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mo>−</mo><mn>10000</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>10000</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(-10000, -10000)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">10000</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">10000</span><span class=\"mclose\">)</span></span></span></span></span> 〜 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mn>10000</mn><mo separator=\"true\">,</mo><mn>10000</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(10000, 10000)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">10000</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">10000</span><span class=\"mclose\">)</span></span></span></span></span> くらいまで雑に試してみるというものです．</p>\n<h4 id=\"少し賢い解法\" style=\"position:relative;\"><a href=\"#%E5%B0%91%E3%81%97%E8%B3%A2%E3%81%84%E8%A7%A3%E6%B3%95\" aria-label=\"少し賢い解法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>少し賢い解法</h4>\n<p>物理を少し知っていれば，ベクトルは分解できることに気づきます．つまり，今回 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>v</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">v_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span> には興味がないということです．したがって， <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">_</mi><mo separator=\"true\">,</mo><mo>−</mo><mn>10000</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(\\_, -10000)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.06em;vertical-align:-0.31em;\"></span><span class=\"mopen\">(</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">10000</span><span class=\"mclose\">)</span></span></span></span></span> 〜 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">_</mi><mo separator=\"true\">,</mo><mn>10000</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(\\_, 10000)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.06em;vertical-align:-0.31em;\"></span><span class=\"mopen\">(</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">10000</span><span class=\"mclose\">)</span></span></span></span></span> を試せば十分というわけです．私はこの方法で解きました．</p>\n<h4 id=\"賢い解法\" style=\"position:relative;\"><a href=\"#%E8%B3%A2%E3%81%84%E8%A7%A3%E6%B3%95\" aria-label=\"賢い解法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>賢い解法</h4>\n<p>もう少し軌道を観察していると，打ち上げたセンサーは <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">_</mi><mo separator=\"true\">,</mo><mo>−</mo><msub><mi>v</mi><mi>y</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(\\_, -v_y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.06em;vertical-align:-0.31em;\"></span><span class=\"mopen\">(</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span> で位置 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">_</mi><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(\\_, 0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.06em;vertical-align:-0.31em;\"></span><span class=\"mopen\">(</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span></span> に落ちてくるのに気づきます．つまり，最も高い高度を目指して初速 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>v</mi><mi>y</mi></msub></mrow><annotation encoding=\"application/x-tex\">v_y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></span> を増加させると，その逆の速度で位置0に落下してくるということです．そして，落下速度が早すぎると次のステップで， <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>v</mi><mi>y</mi></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">v_y + 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span> の落下速度で領域をオーバーシュートしてしまいます．したがって，原点からの落下速度が領域をギリギリオーバーシュートしない打ち上げ速度を狙えばいいということです．</p>\n<p>この入力を例に考えてみますと，</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">target area: x=20..30, y=-10..-5</code></pre></div>\n<p>位置0から下方向に投げたとき，ギリギリ領域に収まる落下速度は-10です．つまりyの下端ギリギリです．したがって，原点での落下速度は −9が最速で，初速も9とできますので，最高高度は <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>9</mn><mo>+</mo><mn>8</mn><mo>+</mo><mn>7</mn><mo>+</mo><mo>⋯</mo><mo>+</mo><mn>2</mn><mo>+</mo><mn>1</mn><mo>=</mo><mo stretchy=\"false\">(</mo><mn>10</mn><mo>×</mo><mn>9</mn><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">/</mi><mn>2</mn><mo>=</mo><mn>45</mn></mrow><annotation encoding=\"application/x-tex\">9 + 8 + 7 + \\cdots + 2 + 1 = (10 \\times 9) / 2 = 45</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">9</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">8</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">7</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">10</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">9</span><span class=\"mclose\">)</span><span class=\"mord\">/2</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">45</span></span></span></span></span> となります．</p>\n<p>コードすら必要なく解けてしまいますね！</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day17-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-16\" style=\"position:relative;\"><a href=\"#part-2-16\" aria-label=\"part 2 16 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>領域に収まるすべての初速のパターン数を回答します．</p>\n<p>私は雑な全域探索で解きました．上記の考察から，y方向の初速 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>v</mi><mi>y</mi></msub></mrow><annotation encoding=\"application/x-tex\">v_y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></span> に関しては <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>±</mo><mtext>領域の下端位置</mtext></mrow><annotation encoding=\"application/x-tex\">\\pm{領域の下端位置}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">±</span><span class=\"mord\"><span class=\"mord cjk_fallback\">領域の下端位置</span></span></span></span></span></span> くらいの範囲を探索すればいいと気づきます．x方向の探索範囲についても1ステップ目でオーバーシュートするような範囲は探索する必要がないため，0〜領域の右端位置くらいまでを探索すればいいでしょう．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day17-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"ふつう-day-18-snailfish\" style=\"position:relative;\"><a href=\"#%E3%81%B5%E3%81%A4%E3%81%86-day-18-snailfish\" aria-label=\"ふつう day 18 snailfish permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ふつう] <a href=\"https://adventofcode.com/2021/day/18\">Day 18: Snailfish</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-17\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-17\" aria-label=\"概要 17 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>クサウオが鍵を見たといいます．そして，数学の宿題を手伝ってくれたらどこで見たのか教えてくれるそうです．</p>\n<p>クサウオは <strong>クサウオ数</strong> という独自の命数法を使っていて，以下のようなものです．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[1,2]\n[[1,2],3]\n[9,[8,7]]\n[[1,9],[8,5]]</code></pre></div>\n<p>クサウオ数は常に2つの要素をもつタプルです．要素には0〜9またはクサウオ数が入ります．</p>\n<p>宿題は与えられた全てのクサウオ数の合計を求めることです．以下のようなクサウオ数のリストが入力として与えられます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[[[0,[4,5]],[0,0]],[[[4,5],[2,6]],[9,5]]]\n[7,[[[3,7],[4,3]],[[6,3],[8,8]]]]\n[[2,[[0,8],[3,4]]],[[[6,7],1],[7,[1,6]]]]\n...</code></pre></div>\n<p>2つのクサウオ数の足し算は以下の手順によって行われます．</p>\n<ol>\n<li>2つのクサウオ数を新たなタプルとして連結する\n<ol>\n<li>例：<code class=\"language-text\">[1,2] + [3,4] = [[1,2],[3,4]]</code></li>\n</ol>\n</li>\n<li>連結したクサウオ数に <strong>削減処理</strong> を適用する</li>\n</ol>\n<p>削減処理は以下のように行われます．</p>\n<ol>\n<li>(ラベル)</li>\n<li>爆発：4回以上ネストされているクサウオ数がある場合，そのような一番左のクサウオ数が <strong>爆発する</strong>．(ラベル)に戻る</li>\n<li>分裂：10以上の数がある場合，その数は <strong>分裂して</strong> 新たなクサウオ数になる．(ラベル)に戻る</li>\n<li>おわり</li>\n</ol>\n<p>爆発は以下のように行われます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[[6,[5,[4,[3,2]]]],1]\n          ^^^^^ 爆発対象（ネストが4以上）\n\n1. クサウオ数が爆発すると，その左右の要素が飛んでいき，一番始めにぶつかった数に加算される\n2. 爆発したクサウオ数は0になる\n\nしたがって以下のようになります\n\n        v 3を加算  v 2を加算\n[[6,[5,[7,  0  ]]],3]\n          ^^^^^ 爆発対象（0になった）\n\nなお，加算対象が無い場合は何もしません</code></pre></div>\n<p>数の分裂は<code class=\"language-text\">[切り捨て(数/2),切り上げ(数/2)]</code>のように行われます．例えば<code class=\"language-text\">11</code>は<code class=\"language-text\">[5,6]</code>になります．</p>\n<p>以上，仕様が複雑なので注意して実装する必要がありますね．</p>\n<h3 id=\"part-1-17\" style=\"position:relative;\"><a href=\"#part-1-17\" aria-label=\"part 1 17 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>与えられた全てのクサウオ数を足した場合の <strong>マグニチュード</strong> を回答します．クサウオ数のマグニチュードは <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>左の数</mtext><mo>×</mo><mn>3</mn><mo>+</mo><mtext>右の数</mtext><mo>×</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">左の数 \\times 3 + 右の数 \\times 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord cjk_fallback\">左の数</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord cjk_fallback\">右の数</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span></span> で求められます．</p>\n<p>難しいのは，クサウオ数をどのように表現するのか，という点だとおもいます．そのまま実装するのであれば配列やタプルをネストすることになるわけですが，そうすると爆発処理が実装しづらそうです．したがって，次のような<code class=\"language-text\">char</code>の配列を用いることにしました．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[[6,[5,[4,[3,2]]]],1]\n\n上記のクサウオ数は以下のように表す\n\n['[', '[', '6', '[', '5', '[', '4', '[', '3', '2', ']', ']', ']', ']', '1', ']']</code></pre></div>\n<p>こうすることで，爆発の際に<code class=\"language-text\">現時点から左側の最初の数を特定</code>といった処理も，そのまま配列の走査として書けます．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day18-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-17\" style=\"position:relative;\"><a href=\"#part-2-17\" aria-label=\"part 2 17 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>与えられたクサウオ数のうち，異なる2つを足し合わせる場合の最大のマグニチュードを回答します．</p>\n<p>素直に全ての組み合わせを計算すればOKです．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day18-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"むずかしい-day-19-beacon-scanner\" style=\"position:relative;\"><a href=\"#%E3%82%80%E3%81%9A%E3%81%8B%E3%81%97%E3%81%84-day-19-beacon-scanner\" aria-label=\"むずかしい day 19 beacon scanner permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[むずかしい] <a href=\"https://adventofcode.com/2021/day/19\">Day 19: Beacon Scanner</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-18\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-18\" aria-label=\"概要 18 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>3次元空間で点群のマッチングを行う問題です．簡易的なSLAMといえるかも．</p>\n<p>3次元空間の海中にビーコンと，そのスキャナーがいくつか展開されました．スキャナーによるスキャン情報が以下のように与えられます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">--- scanner 0 ---\n404,-588,-901\n528,-643,409\n-838,591,734\n...\n\n--- scanner 1 ---\n686,422,578\n605,423,415\n515,917,-361\n...\n\n--- scanner 2 ---\n649,640,665\n682,-795,504\n-784,533,-524\n...\n\n--- scanner 3 ---\n-589,542,597\n605,-692,669\n-500,565,-823\n...\n\n--- scanner 4 ---\n727,592,562\n-293,-554,779\n441,611,-461\n...</code></pre></div>\n<p>スキャナーは自分が検知したビーコンの位置を，自分からの相対座標で報告しています．スキャナーのスキャン可能範囲は， <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mo>±</mo><mn>1000</mn><mo separator=\"true\">,</mo><mo>±</mo><mn>1000</mn><mo separator=\"true\">,</mo><mo>±</mo><mn>1000</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(\\pm{1000}, \\pm{1000}, \\pm{1000})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">±</span><span class=\"mord\"><span class=\"mord\">1000</span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">±</span><span class=\"mord\"><span class=\"mord\">1000</span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">±</span><span class=\"mord\"><span class=\"mord\">1000</span></span><span class=\"mclose\">)</span></span></span></span></span> です．</p>\n<p>すべてのスキャナーが同じ方向を向いているとは限りません．スキャナーは，90度単位で様々な姿勢をとり得ます．<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span></span>，<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span>，<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span></span></span>，<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">-x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\">x</span></span></span></span></span>，<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">-y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span>，<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">-z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span></span></span>」に対してそれぞれ4種類の回転が考えられるため，24種類の姿勢があり得ます．</p>\n<p>各スキャナーに対して，最小12個のビーコンを共有してスキャンしているスキャナーが1つ以上あります．</p>\n<h3 id=\"part-1-18\" style=\"position:relative;\"><a href=\"#part-1-18\" aria-label=\"part 1 18 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>マップ全体のビーコンの数を回答します．</p>\n<p>そのためには，すべてのビーコン群（=スキャン結果）を統合してマップ全体のビーコン群を得る必要があります．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[ビーコン群1] + [ビーコン群2] + [ビーコン群3] + ... = [全てのビーコン群]</code></pre></div>\n<p>つまり，2つのビーコン群をマッチングする，上記の<code class=\"language-text\">+</code>演算子を実装できれば良いわけです．</p>\n<p>スキャナ1と2の2つのビーコン群が与えられて，スキャナ1を基準とした時のスキャナ2の位置と回転を返す，次のような関数を考えました．</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">use</span> <span class=\"token namespace\">euclid<span class=\"token punctuation\">::</span>default<span class=\"token punctuation\">::</span></span><span class=\"token punctuation\">{</span><span class=\"token class-name\">Point3D</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Vector3D</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token type-definition class-name\">Vector</span> <span class=\"token operator\">=</span> <span class=\"token class-name\">Vector3D</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">i32</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token type-definition class-name\">Point</span> <span class=\"token operator\">=</span> <span class=\"token class-name\">Point3D</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">i32</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token type-definition class-name\">Scan</span> <span class=\"token operator\">=</span> <span class=\"token class-name\">HashSet</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">Point</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// (i32, Vector)は，スキャナ1を基準としたスキャナ2の(回転id, 位置)です</span>\n<span class=\"token comment\">// 回転idにか関しては後述します</span>\n<span class=\"token comment\">// なお，マッチしなければNoneを返します</span>\n<span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">match_scan</span><span class=\"token punctuation\">(</span>s1<span class=\"token punctuation\">:</span> <span class=\"token operator\">&amp;</span><span class=\"token class-name\">Scan</span><span class=\"token punctuation\">,</span> s2<span class=\"token punctuation\">:</span> <span class=\"token operator\">&amp;</span><span class=\"token class-name\">Scan</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> <span class=\"token class-name\">Option</span><span class=\"token operator\">&lt;</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">i32</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Vector</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><em>「2つのビーコン群を統合したビーコン群」が欲しいんじゃないの？</em> と思われるかもしれません．しかし，結局本質的に必要なのは2つのスキャナの相対位置と回転です．これらがわかればビーコン群の座標変換は自由にできます．むしろマッチングを行った結果何をしたいのかは外部の任せるというほうが，使い勝手が良いかなと思ってこのようにしました．</p>\n<p>ここで， <strong>スキャナ2のビーコン群をあらゆる姿勢に回転させたうえで，スキャナ1の各ビーコンについて，スキャナ2の各ビーコンと同一だと仮定した上で最低12個の一致があるか調べる</strong> ．という処理を思いつきました．自然言語だとうまく言えませんが，疑似コードでは以下のようになります．</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">for</span> 回転id <span class=\"token keyword\">in</span> <span class=\"token number\">0</span><span class=\"token punctuation\">..</span><span class=\"token number\">24</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">for</span> ビーコン<span class=\"token number\">1</span> <span class=\"token keyword\">in</span> スキャン結果<span class=\"token number\">1</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">for</span> ビーコン<span class=\"token number\">2</span> <span class=\"token keyword\">in</span> スキャン結果<span class=\"token number\">2</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// スキャン結果2を回転idで回転</span>\n            <span class=\"token comment\">// スキャン結果1と2で12個以上のビーコンのマッチがあるか調べる</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>…なかなか計算量がヤバそうな処理ですが，ここはRustさんに頑張ってもらいます．もうすこし良い方法がありそうです．</p>\n<p>この処理を実装するためには，あるビーコンの座標を24種類の姿勢に回転させる関数が必要になります．そのために，まずは，各軸を中心に座標を回転させる関数を次のように実装しました．</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token comment\">// angle_id: 0 ~ 3</span>\n<span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">rotate_x</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Point</span><span class=\"token punctuation\">,</span> angle_id<span class=\"token punctuation\">:</span> <span class=\"token keyword\">i32</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> <span class=\"token class-name\">Point</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">rotate_y</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Point</span><span class=\"token punctuation\">,</span> angle_id<span class=\"token punctuation\">:</span> <span class=\"token keyword\">i32</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> <span class=\"token class-name\">Point</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">rotate_z</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Point</span><span class=\"token punctuation\">,</span> angle_id<span class=\"token punctuation\">:</span> <span class=\"token keyword\">i32</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> <span class=\"token class-name\">Point</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>これらの基本的な操作を用いて，24種類の回転をする次のような関数が書けます．</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token comment\">// angle_id: 0 ~ 23</span>\n<span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">rotate</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Point</span><span class=\"token punctuation\">,</span> angle_id<span class=\"token punctuation\">:</span> <span class=\"token keyword\">i32</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> <span class=\"token class-name\">Point</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// メモ：pがangle_id 1〜23を向いているとして，それをangle_id 0に戻すことをイメージして書いています</span>\n\n    <span class=\"token comment\">// どの軸に対する姿勢か，0: x, 1: y, 2: z</span>\n    <span class=\"token keyword\">let</span> axis_id <span class=\"token operator\">=</span> angle_id <span class=\"token operator\">/</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// マイナス方向を向くか，0: 向かない, 1: 向く</span>\n    <span class=\"token keyword\">let</span> flip_id <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>angle_id <span class=\"token operator\">/</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// 軸に対して何回回転するか</span>\n    <span class=\"token keyword\">let</span> rotate_angle_id <span class=\"token operator\">=</span> angle_id <span class=\"token operator\">%</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">let</span> axis_rotated_point <span class=\"token operator\">=</span> <span class=\"token keyword\">match</span> axis_id <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 各軸のほうを向くように回転</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">let</span> flipped_point <span class=\"token operator\">=</span> <span class=\"token keyword\">if</span> flip_id <span class=\"token operator\">==</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// なにもしない</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">match</span> axis_id <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// 軸の反対側を向くように回転</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">match</span> axis_id <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 各軸を中心に所定の角度だけ回転</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>以上の処理によりすべてのビーコン群を統合すると，マップ全体のビーコンの数がわかります．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day19-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-18\" style=\"position:relative;\"><a href=\"#part-2-18\" aria-label=\"part 2 18 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>各スキャナのマンハッタン距離を計算した時，もっとも遠い距離を回答します．</p>\n<p>先程の関数を用いてスキャナ0を基準としたすべてのスキャナの絶対位置を求めます．そのうえですべての組み合わせを考慮して最大値を求めれば良いです．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day19-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"ふつう-day-20-trench-map\" style=\"position:relative;\"><a href=\"#%E3%81%B5%E3%81%A4%E3%81%86-day-20-trench-map\" aria-label=\"ふつう day 20 trench map permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[ふつう] <a href=\"https://adventofcode.com/2021/day/20\">Day 20: Trench Map</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-19\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-19\" aria-label=\"概要 19 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>バイナリ画像のフィルタ処理をする問題です．次のような入力が与えられます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">..#.#..#####.#.#.#.###.##.....###.##.#..###.####..#####..#....#..#..##..###..######.###...####..#..#####..##..#.#####...##.#.#..#.##..#.#......#.###.######.###.####...#.##.##..#..#..#####.....#.#....###..#.##......#.....#..#..#..##..#...##.######.####.####.#.#...#.......#..#.#.#...####.##.#......#..#...##.#.##..#...##.#.##..###.#......#.#.......#.#.#.####.###.##...#.....####.#..#..#.##.#....##..#.####....##...##..#...#......#.#.......#.......##..####..#...#.#.#...##..#.#..###..#####........#..####......#..#\n\n#..#.\n#....\n##..#\n..#..\n..###</code></pre></div>\n<p>上の方は画像処理フィルタ，下の方は入力画像を表しています．</p>\n<p>画像処理フィルタの適用規則について，以下の画像の中心のピクセルを処理する場合を例に説明します．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">#..#.\n#....\n##..#\n..#..\n..###</code></pre></div>\n<p>ここで，処理したいピクセルを中心とする3 * 3の領域を考えます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># . . # .\n#[. . .].\n#[# . .]#\n.[. # .].\n. . # # #</code></pre></div>\n<p>この領域を左上から右下へ順番に読むと<code class=\"language-text\">...#...#.</code>となります．これを<code class=\"language-text\">000100010</code>と解釈して10進数になおすと<code class=\"language-text\">34</code>になります．最終的に，処理したいピクセルは，入力されたフィルタ文字列の34文字目，つまり<code class=\"language-text\">#</code>に変換されます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0         10        20        30  34    40        50        60        70\n|         |         |         |   |     |         |         |         |\n..#.#..#####.#.#.#.###.##.....###.##.#..###.####..#####..#....#..#..##..##</code></pre></div>\n<p>この処理を画像全体のピクセルに適用します．</p>\n<p>なお，本問題で扱う画像は無限大の大きさを持つらしいので注意です．入力で与えられる領域外には<code class=\"language-text\">.</code>のピクセルが広がっています．</p>\n<h3 id=\"part-1-19\" style=\"position:relative;\"><a href=\"#part-1-19\" aria-label=\"part 1 19 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>フィルタを2回適用した後の<code class=\"language-text\">#</code>の数を回答します．</p>\n<p>無限の大きさを持つ画像に対してフィルタを適用するわけですが，実際には入力画像の周辺のピクセルだけを計算し，範囲外のピクセルに関しては一様なのでまとめて管理すれば問題ありません．したがって，マップを次のように定義します．</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">use</span> <span class=\"token namespace\">rusttype<span class=\"token punctuation\">::</span></span><span class=\"token class-name\">Point</span> <span class=\"token keyword\">as</span> <span class=\"token class-name\">RPoint</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token type-definition class-name\">Point</span> <span class=\"token operator\">=</span> <span class=\"token class-name\">RPoint</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">i32</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">struct</span> <span class=\"token type-definition class-name\">Map</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">pub</span> hashset<span class=\"token punctuation\">:</span> <span class=\"token class-name\">HashSet</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">Point</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">pub</span> min_x<span class=\"token punctuation\">:</span> <span class=\"token keyword\">i32</span><span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">pub</span> max_x<span class=\"token punctuation\">:</span> <span class=\"token keyword\">i32</span><span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">pub</span> min_y<span class=\"token punctuation\">:</span> <span class=\"token keyword\">i32</span><span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">pub</span> max_y<span class=\"token punctuation\">:</span> <span class=\"token keyword\">i32</span><span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">pub</span> outside_cell_state<span class=\"token punctuation\">:</span> <span class=\"token keyword\">bool</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>範囲外のピクセルの状態は<code class=\"language-text\">outside_cell_state</code>によって一括で保持しています．</p>\n<p>このマップは，フィルタを適用する度に上下左右方向へ1ピクセルぶんだけ拡張する必要があります．マップの上部を例に説明します．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">............[範囲外（全て'#'または'.'）]............\n______[フィルタ適用によって新しく拡張される領域]____\n##...#..##..##...#.[マップの上端].##...#...#..##..##</code></pre></div>\n<p>「フィルタ適用によって新しく拡張される領域」にフィルタを適用した結果は一様にならないのがわかると思います．フィルタの下段（3段目）が既存の領域の情報を参照するからです．その一段上の領域に関してはそのまま一様なので問題ありません．</p>\n<p>というわけで，フィルタを適用する処理は次のように書けます．</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">pub</span> <span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">apply_filter</span><span class=\"token punctuation\">(</span>map<span class=\"token punctuation\">:</span> <span class=\"token operator\">&amp;</span><span class=\"token class-name\">Map</span><span class=\"token punctuation\">,</span> filter<span class=\"token punctuation\">:</span> <span class=\"token operator\">&amp;</span><span class=\"token class-name\">Filter</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> <span class=\"token keyword\">Self</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> new_map <span class=\"token operator\">=</span> <span class=\"token class-name\">Map</span><span class=\"token punctuation\">::</span><span class=\"token function\">new</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">for</span> y <span class=\"token keyword\">in</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>min_y <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">..=</span><span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>max_y <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>min_x <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">..=</span><span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>max_x <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// 各ピクセルに対してフィルタを適用した結果をnew_mapに保持</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// 範囲外のピクセルの状態にフィルタを適用した結果を計算</span>\n    new_map<span class=\"token punctuation\">.</span>outside_cell_state <span class=\"token operator\">=</span> <span class=\"token keyword\">if</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>outside_cell_state <span class=\"token punctuation\">{</span>\n        filter<span class=\"token punctuation\">[</span><span class=\"token number\">511</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        filter<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    new_map\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day20-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-19\" style=\"position:relative;\"><a href=\"#part-2-19\" aria-label=\"part 2 19 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>フィルタを50回適用した後の<code class=\"language-text\">#</code>の数を回答します．Part 1のアルゴリズムを使用すれば問題なく解けます．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day20-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"むずかしい-day-21-dirac-dice\" style=\"position:relative;\"><a href=\"#%E3%82%80%E3%81%9A%E3%81%8B%E3%81%97%E3%81%84-day-21-dirac-dice\" aria-label=\"むずかしい day 21 dirac dice permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[むずかしい] <a href=\"https://adventofcode.com/2021/day/21\">Day 21: Dirac Dice</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-20\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-20\" aria-label=\"概要 20 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p><strong>ディラックダイス</strong> という特殊なダイスを使ったボードゲームの展開を考える問題です．</p>\n<p>ボードゲームでは，ボード，ポーン，サイコロを使用します．</p>\n<p>ボードにはプレイヤーの止まれる10個マス目が円形に配置されており，次のようなものです．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">// 10の後は1に戻ります\n |---------------------------------------------------------------\n v                                                              |\n[1] -> [2] -> [3] -> [4] -> [5] -> [6] -> [7] -> [8] -> [9] -> [10]</code></pre></div>\n<p>プレイヤーの初期位置は以下のように入力として与えられます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Player 1 starting position: 4\nPlayer 2 starting position: 8</code></pre></div>\n<p>プレイヤーはそれぞれ自分の得点をもちます．ゲーム開始時点では両者0点です．</p>\n<p>最初はプレイヤー1のターンからはじめます．</p>\n<p>各ターンで，プレイヤーはサイコロを3回振ります．出た目の合計だけポーンを進めて，止まった位置の数字だけ自分の得点を増やします．その後ターンを交代します．</p>\n<h3 id=\"part-1-20\" style=\"position:relative;\"><a href=\"#part-1-20\" aria-label=\"part 1 20 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>以下の条件で，どちらかが勝つまでゲームを進めます． <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>負けたほうのプレイヤーの得点</mtext><mo>×</mo><mtext>サイコロを振った回数</mtext></mrow><annotation encoding=\"application/x-tex\">負けたほうのプレイヤーの得点 \\timesサイコロを振った回数</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord cjk_fallback\">負けたほうのプレイヤーの得点</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord cjk_fallback\">サイコロを振った回数</span></span></span></span></span> を回答します．</p>\n<ul>\n<li><strong>決定論的サイコロ</strong> を用います．決定論的サイコロは，1回目に振ったとき1が出て，次に振ったとき2が出て，100回目に振ったとき100，101回目に振るとまた1が出るようなサイコロです．</li>\n<li>得点が1000になったプレイヤーを勝利とします．</li>\n</ul>\n<p>ここでは特に難しいアルゴリズムを考える必要はありません．素直にゲーム内容をコードに落とし込めばよいです．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day21-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-20\" style=\"position:relative;\"><a href=\"#part-2-20\" aria-label=\"part 2 20 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>以下の条件において，<strong>ゲームのすべての分岐パターンを考慮します．</strong> 勝利するパターンが多いプレイヤーのパターン数を回答します．</p>\n<ul>\n<li><strong>ディラックダイス</strong> を用いてゲームを進行します．ディラックダイスは3面サイコロです．振る度に3つの可能性に世界が分岐します（そのため， <strong>ゲームのすべての分岐パターンを考慮</strong> する必要がある…という設定です）</li>\n<li>得点が21になったプレイヤーを勝利とします．</li>\n</ul>\n<p>つまり，次のようなゲームの分岐をすべて考慮して，プレイヤーそれぞれの勝利パターン数をカウントします．</p>\n<ul>\n<li>プレイヤー1がサイコロで1を出す\n<ul>\n<li>プレイヤー1がサイコロで1を出す\n<ul>\n<li>...\n<ul>\n<li>プレイヤー1 or 2が勝利</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>プレイヤー1がサイコロで2を出す\n<ul>\n<li>...\n<ul>\n<li>プレイヤー1 or 2が勝利</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>プレイヤー1がサイコロで3を出す\n<ul>\n<li>...\n<ul>\n<li>プレイヤー1 or 2が勝利</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>プレイヤー1がサイコロで2を出す\n<ul>\n<li>プレイヤー1がサイコロで1を出す\n<ul>\n<li>...\n<ul>\n<li>プレイヤー1 or 2が勝利</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>プレイヤー1がサイコロで2を出す\n<ul>\n<li>...\n<ul>\n<li>プレイヤー1 or 2が勝利</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>プレイヤー1がサイコロで3を出す\n<ul>\n<li>...\n<ul>\n<li>プレイヤー1 or 2が勝利</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>プレイヤー1がサイコロで3を出す\n<ul>\n<li>プレイヤー1がサイコロで1を出す\n<ul>\n<li>...\n<ul>\n<li>プレイヤー1 or 2が勝利</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>プレイヤー1がサイコロで2を出す\n<ul>\n<li>...\n<ul>\n<li>プレイヤー1 or 2が勝利</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>プレイヤー1がサイコロで3を出す\n<ul>\n<li>...\n<ul>\n<li>プレイヤー1 or 2が勝利</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>分岐は木構造なので，次のような深さ優先探索が使えます．</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token comment\">// (p1 wins, p2 wins)</span>\n<span class=\"token keyword\">type</span> <span class=\"token type-definition class-name\">Wins</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">u128</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">u128</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">struct</span> <span class=\"token type-definition class-name\">PlayerState</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">pub</span> pos<span class=\"token punctuation\">:</span> <span class=\"token keyword\">u32</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 1 ~ 10</span>\n    <span class=\"token keyword\">pub</span> score<span class=\"token punctuation\">:</span> <span class=\"token keyword\">u32</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">calc_wins</span><span class=\"token punctuation\">(</span>\n    current_player<span class=\"token punctuation\">:</span> <span class=\"token class-name\">PlayerState</span><span class=\"token punctuation\">,</span>\n    next_player<span class=\"token punctuation\">:</span> <span class=\"token class-name\">PlayerState</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> <span class=\"token class-name\">Wins</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// プレイヤー1が勝利していたら，return (1, 0);</span>\n    <span class=\"token comment\">// プレイヤー2が勝利していたら，return (0, 1);</span>\n\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> current_wins<span class=\"token punctuation\">:</span> <span class=\"token keyword\">u128</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> next_wins<span class=\"token punctuation\">:</span> <span class=\"token keyword\">u128</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span> dice1 <span class=\"token keyword\">in</span> <span class=\"token number\">0</span><span class=\"token punctuation\">..</span><span class=\"token number\">3</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">for</span> dice2 <span class=\"token keyword\">in</span> <span class=\"token number\">0</span><span class=\"token punctuation\">..</span><span class=\"token number\">3</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">for</span> dice3 <span class=\"token keyword\">in</span> <span class=\"token number\">0</span><span class=\"token punctuation\">..</span><span class=\"token number\">3</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token comment\">// 残りのステップについてcalc_winsを呼び出す</span>\n                <span class=\"token comment\">// その結果をcurrent_winsとnext_winsに加算</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>current_wins<span class=\"token punctuation\">,</span> next_wins<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>一方で，上記の実装では計算量が明らかにヤバそうです．雑に予想すると，各ターンでプレイヤーが平均5点を得るとして，21点貯まるのに5回自分のターンが必要で，ゲーム全体では9回のターンが必要です．そうなるとサイコロを27回くらい振ることになります．</p>\n<p>したがってゲームのパターン数は約 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>3</mn><mn>27</mn></msup><mo>=</mo><mn>7</mn><mo separator=\"true\">,</mo><mn>625</mn><mo separator=\"true\">,</mo><mn>597</mn><mo separator=\"true\">,</mo><mn>484</mn><mo separator=\"true\">,</mo><mn>987</mn></mrow><annotation encoding=\"application/x-tex\">3^{27} = 7,625,597,484,987</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord\">3</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">27</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">7</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">625</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">597</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">484</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">987</span></span></span></span></span> となり，13桁のオーダーになります．やばい．</p>\n<p>もう少し最適化の余地を考えてみます．すると，各ターンの分岐はサイコロの合計数が同じならば発生しないことがわかります．つまり，あるターンで1，1，3が出た場合と1，3，1が出た場合では，その後のゲーム進行は全く同じだということです．したがって，先程の処理を次のように変更できます．</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token comment\">// (p1 wins, p2 wins)</span>\n<span class=\"token keyword\">type</span> <span class=\"token type-definition class-name\">Wins</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">u128</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">u128</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">struct</span> <span class=\"token type-definition class-name\">PlayerState</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">pub</span> pos<span class=\"token punctuation\">:</span> <span class=\"token keyword\">u32</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 1 ~ 10</span>\n    <span class=\"token keyword\">pub</span> score<span class=\"token punctuation\">:</span> <span class=\"token keyword\">u32</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">calc_wins</span><span class=\"token punctuation\">(</span>\n    current_player<span class=\"token punctuation\">:</span> <span class=\"token class-name\">PlayerState</span><span class=\"token punctuation\">,</span>\n    next_player<span class=\"token punctuation\">:</span> <span class=\"token class-name\">PlayerState</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> <span class=\"token class-name\">Wins</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// プレイヤー1が勝利していたら，return (1, 0);</span>\n    <span class=\"token comment\">// プレイヤー2が勝利していたら，return (1, 0);</span>\n\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> current_wins<span class=\"token punctuation\">:</span> <span class=\"token keyword\">u128</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> next_wins<span class=\"token punctuation\">:</span> <span class=\"token keyword\">u128</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>roll<span class=\"token punctuation\">,</span> freq<span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> <span class=\"token macro property\">vec!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 残りのステップについてcalc_winsを呼び出す</span>\n        <span class=\"token comment\">// その結果 * freqを，current_winsとnext_winsに加算</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>current_wins<span class=\"token punctuation\">,</span> next_wins<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>先ほどと同じようにパターン数を見積もってみますと， <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>7</mn><mn>10</mn></msup><mo>=</mo><mn>282</mn><mo separator=\"true\">,</mo><mn>475</mn><mo separator=\"true\">,</mo><mn>249</mn></mrow><annotation encoding=\"application/x-tex\">7^{10} = 282,475,249</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord\">7</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">10</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">282</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">475</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">249</span></span></span></span></span> となりますので，13桁 -> 9桁オーダーへダイエットに成功しました．</p>\n<p>上記の発想を更に一般化すると，<strong>ゲームの状態が決定すれば，そこから先の展開もすべて決定的である</strong> ということに気づきます．</p>\n<p>言い換えれば，calc_winsは純粋関数で，入力が決まれば出力も決まるということです．したがって，この関数の入力と出力のペアをメモしておけば，次回同じ引数で関数を呼び出さずとも出力がわかるという，メモ化による最適化が使えます．</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token comment\">// (p1 wins, p2 wins)</span>\n<span class=\"token keyword\">type</span> <span class=\"token type-definition class-name\">Wins</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">u128</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">u128</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">struct</span> <span class=\"token type-definition class-name\">PlayerState</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">pub</span> pos<span class=\"token punctuation\">:</span> <span class=\"token keyword\">u32</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 1 ~ 10</span>\n    <span class=\"token keyword\">pub</span> score<span class=\"token punctuation\">:</span> <span class=\"token keyword\">u32</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">type</span> <span class=\"token type-definition class-name\">GameState</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">PlayerState</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">PlayerState</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token type-definition class-name\">CalcWinsCache</span> <span class=\"token operator\">=</span> <span class=\"token class-name\">HashMap</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">GameState</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Wins</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">calc_wins</span><span class=\"token punctuation\">(</span>\n    current_player<span class=\"token punctuation\">:</span> <span class=\"token class-name\">PlayerState</span><span class=\"token punctuation\">,</span>\n    next_player<span class=\"token punctuation\">:</span> <span class=\"token class-name\">PlayerState</span><span class=\"token punctuation\">,</span>\n    cahce<span class=\"token punctuation\">:</span> <span class=\"token operator\">&amp;</span><span class=\"token keyword\">mut</span> <span class=\"token class-name\">CalcWinsCache</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> <span class=\"token class-name\">Wins</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// キャッシュがあればキャッシュからWinsを返す</span>\n    <span class=\"token comment\">// プレイヤー1が勝利していたら，return (1, 0);</span>\n    <span class=\"token comment\">// プレイヤー2が勝利していたら，return (1, 0);</span>\n\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> current_wins<span class=\"token punctuation\">:</span> <span class=\"token keyword\">u128</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> next_wins<span class=\"token punctuation\">:</span> <span class=\"token keyword\">u128</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>roll<span class=\"token punctuation\">,</span> freq<span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> <span class=\"token macro property\">vec!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 残りのステップについてcalc_winsを呼び出す</span>\n        <span class=\"token comment\">// その結果 * freqを，current_winsとnext_winsに加算</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// キャッシュに自分の入力と出力をメモする</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>current_wins<span class=\"token punctuation\">,</span> next_wins<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>上記の2つの最適化によって，この問題は200msくらいで解けます．勝利数を倍の42にしても1秒くらいで解けてしまいます．57にしたらu128をオーバフローして落ちました．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day21-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"むずかしい-day-22-reactor-reboot\" style=\"position:relative;\"><a href=\"#%E3%82%80%E3%81%9A%E3%81%8B%E3%81%97%E3%81%84-day-22-reactor-reboot\" aria-label=\"むずかしい day 22 reactor reboot permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[むずかしい] <a href=\"https://adventofcode.com/2021/day/22\">Day 22: Reactor Reboot</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-21\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-21\" aria-label=\"概要 21 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>3次元空間の各位置にあるスイッチ（問題文では「炉心」と表現されている）をオン / オフする問題です．</p>\n<p>座標が整数の3次元空間上に，全て状態がオフのスイッチが並んでいます．次のような操作手順が入力として与えられます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">on x=-5..47,y=-31..22,z=-19..33\non x=-44..5,y=-27..21,z=-14..35\non x=-49..-1,y=-11..42,z=-10..38\non x=-20..34,y=-40..6,z=-44..1\noff x=26..39,y=40..50,z=-2..11\non x=-41..5,y=-41..6,z=-36..8\n...</code></pre></div>\n<p><code class=\"language-text\">on x=-5..47,y=-31..22,z=-19..33</code>は<code class=\"language-text\">x=-5..47,y=-31..22,z=-19..33</code>の範囲のスイッチをすべてオンにすることを示しています．<code class=\"language-text\">off x=26..39,y=40..50,z=-2..11</code>は<code class=\"language-text\">x=26..39,y=40..50,z=-2..11</code>の範囲のスイッチをすべてオフにすることを示しています．</p>\n<h3 id=\"part-1-21\" style=\"position:relative;\"><a href=\"#part-1-21\" aria-label=\"part 1 21 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>入力の指示を全て実行した場合，<code class=\"language-text\">x=-50..50,y=-50..50,z=-50..50</code>の範囲でオンになっているスイッチの数を回答します．</p>\n<p>扱わなければならない範囲が小さいので，愚直に実装すれば解けます．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day22-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-21\" style=\"position:relative;\"><a href=\"#part-2-21\" aria-label=\"part 2 21 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>入力の指示を全て実行したあとオンになっているスイッチの数を回答します．</p>\n<p>Part 1と違い，考慮しなければならない範囲が膨大なため効率の良いアルゴリズムを考える必要があります．</p>\n<p>問題を単純化して考えるために，空間が2次元であり，操作は\"on\"だけの場合を想定してみます．すると，\"on\"という操作は， <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>自身の領域</mtext><mo>−</mo><mtext>既存の領域との共通部分</mtext></mrow><annotation encoding=\"application/x-tex\">自身の領域 - 既存の領域との共通部分</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord cjk_fallback\">自身の領域</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord cjk_fallback\">既存の領域との共通部分</span></span></span></span></span> の数だけスイッチをオンにしていることがわかります．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">  ↓既存の領域A\n+-----------+\n|       +---+-------+\n|   +---+---+---+   |\n|   |(a)|(b)|(c)|   |\n*---+---+---+   |   |\n    |   +-------+---+\n    |    (d)    | ↑既存の領域B\n    +-----------+\n        ↑新しくonする領域\n\n「(d) = 新しくonする領域 - (a) - (b) - (c)」の数だけスイッチをオンしている</code></pre></div>\n<p>したがって， <strong>既存の領域のOR部分</strong> と <strong>新しくonする領域</strong> のAND部分の面積が知れれば良いわけです．</p>\n<p>まず，2つの領域の場合，AND部分の矩形は簡単に求まります．2つの領域をそれぞれ <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>b</mi><mn>1</mn></msub><mo>=</mo><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">(</mo><msub><mi>b</mi><mrow><mn>11</mn><mi>x</mi></mrow></msub><mo separator=\"true\">,</mo><msub><mi>b</mi><mrow><mn>11</mn><mi>y</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mo stretchy=\"false\">(</mo><msub><mi>b</mi><mrow><mn>12</mn><mi>x</mi></mrow></msub><mo separator=\"true\">,</mo><msub><mi>b</mi><mrow><mn>12</mn><mi>y</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">b_1 = ((b_{11x}, b_{11y}), (b_{12x}, b_{12y}))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mopen\">((</span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">))</span></span></span></span></span> ， <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>b</mi><mn>2</mn></msub><mo>=</mo><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">(</mo><msub><mi>b</mi><mrow><mn>21</mn><mi>x</mi></mrow></msub><mo separator=\"true\">,</mo><msub><mi>b</mi><mrow><mn>21</mn><mi>y</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mo stretchy=\"false\">(</mo><msub><mi>b</mi><mrow><mn>22</mn><mi>x</mi></mrow></msub><mo separator=\"true\">,</mo><msub><mi>b</mi><mrow><mn>22</mn><mi>y</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">b_2 = ((b_{21x}, b_{21y}), (b_{22x}, b_{22y}))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mopen\">((</span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">21</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">21</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">22</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">22</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">))</span></span></span></span></span> とすると，AND部分は，</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">(</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=\"false\">(</mo><msub><mi>b</mi><mrow><mn>11</mn><mi>x</mi></mrow></msub><mo separator=\"true\">,</mo><msub><mi>b</mi><mrow><mn>21</mn><mi>x</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=\"false\">(</mo><msub><mi>b</mi><mrow><mn>11</mn><mi>y</mi></mrow></msub><mo separator=\"true\">,</mo><msub><mi>b</mi><mrow><mn>21</mn><mi>y</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mo stretchy=\"false\">(</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><msub><mi>b</mi><mrow><mn>12</mn><mi>x</mi></mrow></msub><mo separator=\"true\">,</mo><msub><mi>b</mi><mrow><mn>22</mn><mi>x</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><msub><mi>b</mi><mrow><mn>12</mn><mi>y</mi></mrow></msub><mo separator=\"true\">,</mo><msub><mi>b</mi><mrow><mn>22</mn><mi>y</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">((max(b_{11x}, b_{21x}), max(b_{11y}, b_{21y})), (min(b_{12x}, b_{22x}), min(b_{12y}, b_{22y})))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mopen\">((</span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">21</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">21</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">))</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">min</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">22</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">min</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">22</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)))</span></span></span></span></span></div>\n<p>となります．</p>\n<p>次に，「 <strong>複数の領域のOR部分</strong> と <strong>単一領域</strong> のAND部分」の面積を求める方法を考えます．結論から言ってしまうと，次のようなコードで実現できます．</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">AND</span>領域の面積を計算<span class=\"token punctuation\">(</span>複数領域<span class=\"token punctuation\">,</span> 単一領域<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> <span class=\"token keyword\">i32</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> 面積 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>複数領域要素<span class=\"token punctuation\">,</span> index<span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> 複数領域 <span class=\"token punctuation\">{</span>\n        面積 <span class=\"token operator\">+=</span> <span class=\"token punctuation\">(</span>単一領域 <span class=\"token operator\">&amp;</span> 複数領域要素<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>面積\n                <span class=\"token operator\">-</span> <span class=\"token constant\">AND</span>領域の面積を計算<span class=\"token punctuation\">(</span>複数領域<span class=\"token punctuation\">[</span>index<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>単一領域 <span class=\"token operator\">&amp;</span> 複数領域要素<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> 面積\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>このコードの動作を先程の図で説明します．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">  ↓既存の領域A\n+-----------+\n|       +---+-------+\n|   +---+---+---+   |\n|   |(a)|(b)|(c)|   |\n*---+---+---+   |   |\n    |   +-------+---+\n    |    (d)    | ↑既存の領域B\n    +-----------+\n        ↑新しくonする領域\n\n「(d) = 新しくonする領域 - (a) - (b) - (c)」の数だけスイッチをオンしている</code></pre></div>\n<p>まず，<code class=\"language-text\">複数領域要素</code>に<code class=\"language-text\">既存の領域A</code>が来た場合，<code class=\"language-text\">面積</code>には<code class=\"language-text\">既存の領域A &amp; 新しくonする領域 - ((既存の領域A &amp; 新しくonする領域) &amp; 既存の領域B) = (a)</code>の面積が加算されます．</p>\n<p>次に，<code class=\"language-text\">複数領域要素</code>に<code class=\"language-text\">既存の領域B</code>が来た場合，<code class=\"language-text\">面積</code>には<code class=\"language-text\">新しくonする領域 &amp; 既存の領域 = (b) + (c)</code>の面積が加算されます．しっかりとAND領域の面積を計算できています．</p>\n<p>以上により\"on\"操作に関しては実装できそうです．次に\"off\"操作に関して考えていきますが，これまた結論からいいますと以下のようなコードでうまく行きます．</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">let</span> 面積 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> 既存領域の集合 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>モード<span class=\"token punctuation\">,</span> 領域<span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> 入力指示<span class=\"token punctuation\">.</span>逆<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> モード <span class=\"token operator\">==</span> <span class=\"token string\">\"on\"</span> <span class=\"token punctuation\">{</span>\n        aria <span class=\"token operator\">+=</span> 領域<span class=\"token punctuation\">.</span>面積<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token constant\">AND</span>領域の面積を計算<span class=\"token punctuation\">(</span>既存領域の集合<span class=\"token punctuation\">,</span> 領域<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    既存領域の集合<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>領域<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><em>「なんで指示を逆に実行してんねん」</em> や <em>「offの時面積いじらないんかい」</em> などと思われるかもしれません．私なりに理解した結果「\"ボタンをoffにする\"という操作の結果引かれるべき面積を，それ以前のon操作の処理に引かせている」のだと思いました．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">指示1: 領域1をon  // 既存領域に領域3が含まれているので，その領域を自身から除外した部分を面積に足す\n指示2: 領域2をon  // 既存領域に領域3が含まれているので，その領域を自身から除外した部分を面積に足す\n指示3: 領域3をoff // 面積はいじらないが，既存領域に自身を追加する\n指示4: 領域4をon  // ↑に実行していく</code></pre></div>\n<p>以上，上記の処理を3次元に拡張すれば問題が解けます．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day22-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"むずかしい-day-23-amphipod\" style=\"position:relative;\"><a href=\"#%E3%82%80%E3%81%9A%E3%81%8B%E3%81%97%E3%81%84-day-23-amphipod\" aria-label=\"むずかしい day 23 amphipod permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[むずかしい] <a href=\"https://adventofcode.com/2021/day/23\">Day 23: Amphipod</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-22\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-22\" aria-label=\"概要 22 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>端脚類（以降\"アイテム\"）を正しい部屋に移動させる問題です．</p>\n<p>次のようなマップとアイテムの初期状態が与えられます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">#############\n#...........#\n###B#C#B#D###\n  #A#D#C#A#\n  #########</code></pre></div>\n<p>アイテムはマップ内を以下の条件を守って自由に移動できます．</p>\n<ul>\n<li>あるアイテムが部屋の入口の廊下にとどまったままで，他のアイテムは移動できません</li>\n<li>別のアイテムが既に入っている部屋には入れません</li>\n</ul>\n<p>マップの見方は以下のとおりです．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">'#'は壁，'.'はそこに何もないことを表す\n'v'の廊下の位置にはアイテムはとどまれない\n\n   v v v v\n#############\n#...........#  &lt;廊下\n###B#C#B#D###  &lt;部屋1\n  #A#D#C#A#    &lt;部屋2\n  #########\n\nゴール（整列）状態\n#############\n#...........#\n###A#B#C#D###\n  #A#B#C#D#\n  #########</code></pre></div>\n<p>各アイテムは1つの位置を動くたびに次のエネルギーを消費します．</p>\n<ul>\n<li>A: 1</li>\n<li>B: 10</li>\n<li>C: 100</li>\n<li>D: 1000</li>\n</ul>\n<h3 id=\"part-1-22\" style=\"position:relative;\"><a href=\"#part-1-22\" aria-label=\"part 1 22 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>アイテムを整列させるために必要な最小エネルギーを回答します．</p>\n<p>基本的には各マップの状態をノードとして，DFSやBFSを実行すれば解けます．</p>\n<p>しかし，素直に全ての状態を探索すると時間がかかりそうです．アイテムがとどまれる場所は15箇所ありますので，可能な盤面は <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>15</mn><mo>∗</mo><mn>14</mn><mo>∗</mo><mn>13</mn><mo>∗</mo><mn>12</mn><mo>∗</mo><mn>11</mn><mo>∗</mo><mn>10</mn><mo>∗</mo><mn>9</mn><mo>∗</mo><mn>8</mn><mo>÷</mo><msup><mn>2</mn><mn>4</mn></msup><mo>=</mo><mn>16</mn><mo separator=\"true\">,</mo><mn>216</mn><mo separator=\"true\">,</mo><mn>200</mn></mrow><annotation encoding=\"application/x-tex\">15*14*13*12*11*10*9*8 \\div 2^4 = 16,216,200</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">15</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">14</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">13</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">12</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">11</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">10</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">9</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">8</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">÷</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">16</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">216</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">200</span></span></span></span></span> パターンということになります．ちょっと多くてイヤですね．</p>\n<p>今回は以下のような枝切りによって探索時間の短縮を図ります．あるマップの状態から，次に探索すべき状態を生成する<code class=\"language-text\">get_next_maps</code>関数を考えます．</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">get_next_maps</span><span class=\"token punctuation\">(</span>map<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Map</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> <span class=\"token class-name\">Map</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 正しい位置に入れられるitemがあればいれる</span>\n    <span class=\"token comment\">// →正しい位置に入れられるアイテムがあるのにそれを無視するような不要な操作を枝切り</span>\n    <span class=\"token keyword\">for</span> アイテム <span class=\"token keyword\">in</span> 廊下 <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> アイテムを正しい部屋に入れられる <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>アイテムを入れた状態の<span class=\"token class-name\">Map</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// 取り出せるitemがあればあらゆる位置に取り出す</span>\n    <span class=\"token comment\">// →正しい位置に入れられるアイテムがない</span>\n    <span class=\"token comment\">// →したがって，部屋からいずれかのアイテムを取り出して状況を変えるしか無い</span>\n    <span class=\"token comment\">// →逆に言えば，そのような状況でアイテムを部屋から取り出さないような不要な操作を枝切り</span>\n    <span class=\"token keyword\">let</span> 次の<span class=\"token class-name\">Map</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">for</span> アイテム <span class=\"token keyword\">in</span> 各部屋の移動できるアイテム <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">for</span> 取り出し場所<span class=\"token keyword\">in</span>アイテムを取り出し可能な廊下の位置 <span class=\"token punctuation\">{</span>\n            次の<span class=\"token class-name\">Map</span><span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>アイテムを取り出し場所に取り出したマップ<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> 次の<span class=\"token class-name\">Map</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>以上の仕組みを実装することで，現実的な時間内で問題が解けます．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day23-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-22\" style=\"position:relative;\"><a href=\"#part-2-22\" aria-label=\"part 2 22 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>部屋の深さが2倍の4になります．Part 1のアルゴリズムによって問題なく解けます．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day23-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"むずかしい-day-24-arithmetic-logic-unit\" style=\"position:relative;\"><a href=\"#%E3%82%80%E3%81%9A%E3%81%8B%E3%81%97%E3%81%84-day-24-arithmetic-logic-unit\" aria-label=\"むずかしい day 24 arithmetic logic unit permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[むずかしい！] <a href=\"https://adventofcode.com/2021/day/24\">Day 24: Arithmetic Logic Unit</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-23\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-23\" aria-label=\"概要 23 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>独自の処理系上で動作するモデル番号検証プログラムがあります．そのプログラムが受け付けるモデル番号を探索する問題です．</p>\n<p>潜水艦のALU：arithmetic logic unitが壊れました．そのため，このALUの代わりとなるものを作成しなければなりません．また，代わりのALUを潜水艦に設置する際，ALU上でモデル番号の検証プログラムが実行され，検証に成功しないとALUは起動しません．有効なモデル番号を見つける必要があります．</p>\n<p>モデル番号は14桁の数値です．各桁は1〜9です．0は現れません．</p>\n<p>ALUの仕様は以下のとおりです．</p>\n<ul>\n<li>4つのレジスタを持っています\n<ul>\n<li><code class=\"language-text\">x</code>，<code class=\"language-text\">y</code>，<code class=\"language-text\">z</code>，<code class=\"language-text\">w</code>のレジスタがあります</li>\n<li>レジスタは整数を保持します</li>\n<li>プログラム開始前に，レジスタは0に初期化されます．</li>\n</ul>\n</li>\n<li>入力メモリをもちます．複数の整数を保持する配列のようなものです．</li>\n<li>次の命令を解釈できます\n<ul>\n<li><code class=\"language-text\">imp a</code>：入力メモリを1つ消費して，値を<code class=\"language-text\">a</code>に読み込みます．</li>\n<li><code class=\"language-text\">add a b</code>：<code class=\"language-text\">a</code>と<code class=\"language-text\">b</code>の和を<code class=\"language-text\">a</code>にセットします</li>\n<li><code class=\"language-text\">mul a b</code>：<code class=\"language-text\">a</code>と<code class=\"language-text\">b</code>の積を<code class=\"language-text\">a</code>にセットします</li>\n<li><code class=\"language-text\">div a b</code>：<code class=\"language-text\">a</code>と<code class=\"language-text\">b</code>の商を<code class=\"language-text\">a</code>にセットします</li>\n<li><code class=\"language-text\">mod a b</code>：<code class=\"language-text\">a</code>と<code class=\"language-text\">b</code>の剰余を<code class=\"language-text\">a</code>にセットします</li>\n<li><code class=\"language-text\">eql a b</code>：<code class=\"language-text\">a</code>と<code class=\"language-text\">b</code>が等しい場合は1を，等しくない場合は0を<code class=\"language-text\">a</code>にセットします</li>\n</ul>\n</li>\n<li>ジャンプ命令はありません</li>\n</ul>\n<p>MONAD：MOdel Number Automatic Detector program（モデル番号検証プログラム）が次のような入力として与えられます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">inp w\nmul x 0\nadd x z\nmod x 26\ndiv z 1\nadd x 11\neql x w\neql x 0\nmul y 0\n...</code></pre></div>\n<p>MONADは<code class=\"language-text\">inp</code>命令によってモデル番号の各桁を左から読み取ります．例えば，モデル番号が<code class=\"language-text\">1234...</code>の場合，最初の<code class=\"language-text\">imp a</code>命令は<code class=\"language-text\">1</code>を<code class=\"language-text\">a</code>にセットします．次の<code class=\"language-text\">imp a</code>命令は<code class=\"language-text\">2</code>を<code class=\"language-text\">a</code>にセットします．</p>\n<p>有効なモデル番号に対してMONADのすべてのステップを実行するとzは0になります．無効なモデル番号に対して実行するとzは0以外になります．</p>\n<h3 id=\"part-1-23\" style=\"position:relative;\"><a href=\"#part-1-23\" aria-label=\"part 1 23 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>MONADが受け付ける最大のモデル番号を回答します．</p>\n<p>はじめにMONADの挙動を観察して作戦を立ててから実装に入っていきたいと思います．</p>\n<h4 id=\"観察\" style=\"position:relative;\"><a href=\"#%E8%A6%B3%E5%AF%9F\" aria-label=\"観察 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>観察</h4>\n<p>なにはともあれMONADをRustで実装してみたいと思います．MONADのアルゴリズムで最終的なzを計算する関数を<code class=\"language-text\">orig_calc_z</code>としました．名前がひどいのは許してください．</p>\n<p>次のように関数を宣言して，</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">orig_calc_z</span><span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">:</span> <span class=\"token operator\">&amp;</span><span class=\"token class-name\">Id</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> <span class=\"token keyword\">i128</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> input_index<span class=\"token punctuation\">:</span> <span class=\"token keyword\">usize</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> x<span class=\"token punctuation\">:</span> <span class=\"token keyword\">i128</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> y<span class=\"token punctuation\">:</span> <span class=\"token keyword\">i128</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> z<span class=\"token punctuation\">:</span> <span class=\"token keyword\">i128</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> w<span class=\"token punctuation\">:</span> <span class=\"token keyword\">i128</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>おもむろにMONADのコードをコメントとして貼り付けます．</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 318px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2f41cd630890d7530cd62f13df8f2ef3/fa108/monad1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 114.77987421383648%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAC4jAAAuIwF4pT92AAACnElEQVR42qWVW2/aQBSEeawEAV/3aq/tNcaACCVJk0pUlfL//9R0dgmJlKZV4z4ceTHeb+ecGcMsSzWqvEJZeOiiR5paWDGiyBzSrILVDpUy0EIjTzS8qWFUjSxRKHKDXA0o9AbJ9ohlYTErMoNd2aLXJ+ztI7bmHsf6DK8OcGqPXdfjPHrsnIPjAU++R996CAoxpYPpn2D9I/JvZ6xEjdkq0/iyEihSia1o0Jc17nmVwmGze8Dh8ABpOvjhhNPdDyhRoTC3sP136OERJlWo2juUqsV8WWKWEHiTSMjMYi+5kafeSbZPqNEept7Dbc6wdkBlNqi6A5ZsN8lrrDiqsHfFvQnbD+sInEegocI2Au8FQbKFLDlbPcJtn6FUz0M82zthfpPjhl0tVmWEhHWs98DdVaHoaAZVSgdhRtTjTyhNoOxhuiMWy4Kb1QX2rl6BIgLbV6DmTJSsCdxGoCbQiH8GiqgwzDCY8sCrJVCKC7DZPUMSqAi0/iuB+QtA/FazMMwlYaKoMNKMjnM8srXWrdE2njOkEQMdNWseMkTgks6uuOejmmUEhYeF8sioKmfbS0amkA2j0PF+i5JREVzHz7yv9DrO9KNiyyQzpFlRvzzs4ZptBISMhu8up+u3Sv9cMdhhHmluUVCZtj2abh8V5pzhR4P/W70CEwJLQkw9QBmPnOZYrsO8JgFTvthBUeU26PpDBGYM9jWwkxVaAh1bDmaFdclwzz8BfQGKN2C9Qd3uorqwLsUk4EVhQTXG9tHpjFHJ+aYsEjF9hsHlyo3w/S0yHqBpSqma+LM0XWG1jsaEGQZYeJMWU1q+5rAmrKKyPGSS8ZmcwwAMkJC9UMGUEPLJOby6XDdjBF7h/wE0McxSd5c3hSEP/xOfBf4C54RGaq6YlqUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2f41cd630890d7530cd62f13df8f2ef3/ef33f/monad1.webp 318w\"\n              sizes=\"(max-width: 318px) 100vw, 318px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2f41cd630890d7530cd62f13df8f2ef3/fa108/monad1.png 318w\"\n            sizes=\"(max-width: 318px) 100vw, 318px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2f41cd630890d7530cd62f13df8f2ef3/fa108/monad1.png\"\n            alt=\"MONADの実装過程1\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>ここで，<code class=\"language-text\">// add </code>をマルチカーソルで選択して…</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 322px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/59fd27b4c6faaef9710359d5848d17ab/3d6b6/monad2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 250.31055900621118%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAyCAYAAABcfPsmAAAACXBIWXMAAC4jAAAuIwF4pT92AAAEqUlEQVR42qVXaW/bRhT0xyKWdfHcJbnLWydlyfIZu01R9ACSDwV6uGmbNEDz/3/DdHYpG0FQOBb1YUHKEofvzXsz7/lIuTEyT0MFC6Rhg8ivUcoNQrdAFJaokhhNqiCcELETYVPm8L0YwTCA42cQxSXCZAbXj9Eb+DgK+aPYVciCGZpog4lYopGn0GKGIm0wzXKsixxZUqKWJRp+DkQJ4aX2qooLCNVg7MoWsD8W+Io3kSMx9xNoRrzyEriBQrO+QVmvEUQlFuuXmE43GAwjSEYlq2uEsoZgMElxhl7fwckwxNGQgD2Gr9wEqzBHzvQ3TCWKCvhODJFtkc6/hc/fxOkGnshwbB5mEL1BgGNeT4bmBPYcDQh4bH7Mh+dBRkCFlZ9CCnLFl4T6FJGJZiyR8N4LDaD3CPD5eQRMCLh8ACQ/cVLBY+qBOkUyuYXP3yXZBu4+gDNGpgmy9DWCMIXLgtkIy2sLGKkVuU3J1zMALYeMsCLo1suQphNIFiZMz6Bmr1i0CDo/f16E5sYZCUg+5JGraBxByASOKzBmL3rRlNUNCJZjzAx6A/9pwP4otB9MtU94/2IU4IWpovkbo+n13fb7gfck2CNgj2V3fcWjEaspEh4v0LvUwt0JnnUeUx67EdORBGSKlJEfajZubqN6LlgL6Ej7kCdnkPkdisV30PUrSMrJ8aIvpvj/gOz8QJ0jbe5Rb+8xOfuLcrpi1K2K9gPcSc+hjh3ymFcrNnVtOc3KBg/S3B+QluQGSasQcujaFyQdUzYcCjpHeomsvmW61G48ty842TvlTzjUzVtML/7E9Pw94vwKMs7Yo2J/Do39OOxBLyygssYap3EVw+P+KX9SFAOg87k1Bp+nWx8+NLZ1aU3ABfzARGssPusG+BghgRI9tdEFjM5cn7KqLxSFVr/8nQX5g+dvKHqgkeFDBh3aZkrp3aLg/NDVNxDJwuq5v4cx7FKWrdvQiT1WNzFVlhVPQenF3bUc6kvk6/dY3HzA8voj0skdRt203A5olz0YJCvo8gJSm1lcY8SXnXQxBzsC6IeOZ0ZlCZdXz8wTjtLj/dum5dCxHE6g8lPqeArBCG3bHOaHpmWo5/N3UNVLG3FncwiN07Ao8+sPmF/9y6LcWkCzbnToQxd+3HBD+BHV6WsUy9eIuSWMHNGtKJZDM/XIY6Ln5C6jjvPD+tBKz3B48RaTLaVX3bDyskMfPkpvQh6vkE2/Jtgdt9I5BqPwgD7kHDERiYi7YVzYGdPvCtgOqda+0p0fGi2LuDzEvs6gl7+gPvsV9eYeMdfewSg4gEM5R1S8QtX8gGz2PRfxJUdAttde85mWY7vfKLMXEshoW2UzRim6zpR20Efkzew05r+AIaM/7sahS+taQy1+Zg+Sx81vnMsXNtqOI6CVXjz5idJ7Q+m9IYcr2lfWPWWTpjEDpSfc/iO7cJrTeS47XqtlnS+tjn1Gd9ig322wiTbbV2SbuzXYrhusqBCqDdL6ClG6haSWpVHKIVMvO32HxfU/PB+t28RJATMi9p4pJ7u57DNKna+o45o8FjTYDjv2kNz1xyGcsIKfbBBl5xyjWwQcVGPPfCf2Ov8BdKDwq2/wQZcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/59fd27b4c6faaef9710359d5848d17ab/f60ae/monad2.webp 322w\"\n              sizes=\"(max-width: 322px) 100vw, 322px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/59fd27b4c6faaef9710359d5848d17ab/3d6b6/monad2.png 322w\"\n            sizes=\"(max-width: 322px) 100vw, 322px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/59fd27b4c6faaef9710359d5848d17ab/3d6b6/monad2.png\"\n            alt=\"MONADの実装過程2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>コピペを駆使すれば…</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 319px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/63db6781f8ef023dfb8b89b9fe721bcf/02677/monad3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 232.91536050156742%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAvCAYAAADjNOpjAAAACXBIWXMAAC4jAAAuIwF4pT92AAAFqElEQVR42p1X2XbaWBDkbZKYVRLa911sNokdO86cM8n8/z/VVLcEwRgcZx76IAtu3e6u6sWjydyBtfAwX/gwzQizuQtjEcA0+Mz3phXyvctPDwuDf5sebDvAlN9NFy7mZgjDijH1MkzcGKMJAbbLBLW7QRc8ovT2aMOv2ERP8KwGWVDie5fisUqxnNn4EqR43jS81EM0t+HEOyTND1h3TzDWtxjJLWPahF+unAytU2BrZyiWMdJii9X6HklSIYgrbG+fkSc1PcoRFI/w83u4TgrfreBmO0wMRwA9huYyVAc1vwzNAC09ThiGFxQEaxEVe0Q8kMYt4mxDwAimW8JwC02JZSWw6MyEEaiHagQUD3MCbe0UJcFdN8Vi7iNs/oaX3sGeOQiyz5gzn58mJsZTCzcEuZkt1SR9LwA7Ama8fU0PCwJ6fg6DSQ/rZ/gEdA2CZ3ssTB9jAgmh5/bKQ8ld72EG18/IaoiIHvoEcgkUFZ+xsN4BOBk8LJYRNgQUDx2GfAAMCLgUZnMCMs/v8nDLJJf08M7O0bgZ0qxmwiMk3Q+EwqgRIC4f6GHwHg/tIcE2Pk2XGPNvw3IuHnrLXoRsUAILmu2lfO6r4X8DijksH5M5TLMV/LDkc0hPnSEl7p8BjnnAtGNYlEqcduqpH1Z8F+HDjaFpOKRELrlmoykL3nISeseqyNaoWLuhXyBihaTUX8DqyMsdcpahXODRllTANRvNBJCe2ZRITJCSgFFYE2RLwCcCd0jytXrt8SJJhfz+mo0OhIxZVhKySUIErL8koYc1PowN3EjIg/W/ty/aCcsuXU6wpKdh3CghFgFnC6fPnUjpcHAAvUjKaciR5CuoGDItv2OHueXnXkswTlfsPiVcdiA/qlQNl0M+I6XhocDLkXbPyKoHpNVX5rFBu3pgjjsCk6xiw8PJZVJehUywjCRIn3NYflK3x/yd5Opdwpb82QRJyKhJD7yBUQE4/d2ByLdLTwClw7BapEubbBIuZWJItQyA76sU5lCIkbrVkAkimhNPfepR8ntg+HDo3NtTU5b7wxWK6hYbsuxLX9z+RN5+Q9F915xud88oWDEZK6ZuP8PWaPJXNupnq6+hCajPlyFl4UYtAprtV9qFbG0cvTSkAOTMJTsCzjgv5JCUVqIhCymtClyimBvDdDT6AT8bUnVuGrIQEUQ1qvoOW9EhO3fWPKDa/KTmdlhvn7BeP2roGTUoZLnsSpfs6KGYwxdiImSH1eGFtYY75/px+M01z44e9uz07C21YjKWIIFYWgJqvJhwp5+XjbJxNX9TLksq7KDQ8hK5hHGnJdbr0DvqtX++bJpDAXL9kjnaoKVsQj633R7F6h9EKeu7+4K62as+E44Hkdk1G0jJlRTRYce8RWGDorlHvf2XzXVLwHs07RcFk0t7Ui7bsX0JaJpLtyl0BITphp2GGxbBhdmUQDoCglLTcM2OpEietGNLDvNOu43txKq9vz7N8VEHlcUlybrarbVjH0rPY+7Eww1DjvlcVjvm8AfDZKlJDuu9Dq6EjfZSyf0qPQKKRIRVmR8hwUMCSphhdkfCKHqOBOnSUkmiU/n9NXsxpESHC6sf9HJYwj0dTn2TXb4d8quOrYO+1duEBIuDXpbL0yH12354qBDRWSFDniGLRNL6m3YcmSEiF+ngvg765KoNskmUGAGsh6mXFWwEzTcKm9qToc8BJpLpB/1vZdOHbFEmFj2VtUO+lFqWRvFxGPTvC/lsc7CGQW8sA71gurAHQqwj6Fta1JD7TtwDJVIlEjZX34CDPkx3ugSEXAKktERr8qz/WvDcuQ3CHpoDk7/SmcL9ho2hXHGe1I8kqOM/QI9KlFjFRiEEXGwOp3NW1wndrVcasowBaaoSqoR5DPmt3eZ80It8snzVD/pg2GK1H/7xju3qtirEHDq2DP63Nv5LgP8Ba+G30/CTx20AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/63db6781f8ef023dfb8b89b9fe721bcf/172f8/monad3.webp 319w\"\n              sizes=\"(max-width: 319px) 100vw, 319px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/63db6781f8ef023dfb8b89b9fe721bcf/02677/monad3.png 319w\"\n            sizes=\"(max-width: 319px) 100vw, 319px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/63db6781f8ef023dfb8b89b9fe721bcf/02677/monad3.png\"\n            alt=\"MONADの実装過程3\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p><code class=\"language-text\">add</code>命令の実装完了です！他の命令に関しても同様に実装していき，MONADが動くようになりました．</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">orig_calc_z</span><span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">:</span> <span class=\"token operator\">&amp;</span><span class=\"token class-name\">Id</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> <span class=\"token keyword\">i128</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> input_index<span class=\"token punctuation\">:</span> <span class=\"token keyword\">usize</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> x<span class=\"token punctuation\">:</span> <span class=\"token keyword\">i128</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> y<span class=\"token punctuation\">:</span> <span class=\"token keyword\">i128</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> z<span class=\"token punctuation\">:</span> <span class=\"token keyword\">i128</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> w<span class=\"token punctuation\">:</span> <span class=\"token keyword\">i128</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n    w <span class=\"token operator\">=</span> input<span class=\"token punctuation\">[</span>input_index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//inp w</span>\n    x <span class=\"token operator\">*=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//mul x 0</span>\n    x <span class=\"token operator\">+=</span> z<span class=\"token punctuation\">;</span> <span class=\"token comment\">//add x z</span>\n    x <span class=\"token operator\">%=</span> <span class=\"token number\">26</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//mod x 26</span>\n    z <span class=\"token operator\">/=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//div z 1</span>\n    x <span class=\"token operator\">+=</span> <span class=\"token number\">11</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//add x 11</span>\n    x <span class=\"token operator\">=</span> <span class=\"token function\">eql</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//eql x w</span>\n    x <span class=\"token operator\">=</span> <span class=\"token function\">eql</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//eql x 0</span>\n    y <span class=\"token operator\">*=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//mul y 0</span>\n    <span class=\"token punctuation\">...</span></code></pre></div>\n<p>手始めに，これを使って全域探索してみました．<code class=\"language-text\">99999999999999</code>からモデル番号をデクリメントしつつ探索したのですが，運良くヒットする…ということはありませんでした．やはりパターン数が多すぎます．</p>\n<p>より効率的に探索するためには，MONADの処理に関してさらに理解する必要がありそうです．そこで，いったんMONADを自分なりの数式に落とし込んで再実装してみることにしました．また，処理を数式で表すことで，あわよくば解を代数的に求められないかな〜という思惑もありました．これは失敗でしたが．</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 728px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/efea460c04a2b22b998c13a63e8b6713/6e05e/monad_memo.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIDAQT/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHv1WIlQ//EABgQAQEBAQEAAAAAAAAAAAAAAAEAEQIx/9oACAEBAAEFAiZ5tw9L/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAFxABAQEBAAAAAAAAAAAAAAAAAQARIf/aAAgBAQABPyEQtWzpD0tC/9oADAMBAAIAAwAAABCkH//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABkQAQACAwAAAAAAAAAAAAAAAAEAMREhUf/aAAgBAQABPxCxrZBbuZFGKC7ML3HQZ//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/efea460c04a2b22b998c13a63e8b6713/f4a91/monad_memo.webp 728w,\n/static/efea460c04a2b22b998c13a63e8b6713/e70b0/monad_memo.webp 1087w\"\n              sizes=\"(max-width: 728px) 100vw, 728px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/efea460c04a2b22b998c13a63e8b6713/83881/monad_memo.jpg 728w,\n/static/efea460c04a2b22b998c13a63e8b6713/6e05e/monad_memo.jpg 1087w\"\n            sizes=\"(max-width: 728px) 100vw, 728px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/efea460c04a2b22b998c13a63e8b6713/83881/monad_memo.jpg\"\n            alt=\"MONADの処理を理解するためのメモ\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>数式化によって一定の法則が見えまして，次のような独自のMONADを作ることができました．</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">calc_z</span><span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">:</span> <span class=\"token operator\">&amp;</span><span class=\"token class-name\">Id</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> <span class=\"token keyword\">i128</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> <span class=\"token class-name\">A</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token class-name\">B</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token class-name\">C</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> z <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token constant\">INPUT_DIGITS_NUM</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token number\">0</span><span class=\"token punctuation\">..</span><span class=\"token constant\">INPUT_DIGITS_NUM</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> prev_z <span class=\"token operator\">=</span> <span class=\"token keyword\">if</span> i <span class=\"token operator\">==</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">{</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span> z<span class=\"token punctuation\">[</span>i <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">let</span> x <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>prev_z <span class=\"token operator\">%</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token class-name\">B</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> input<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        z<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>prev_z <span class=\"token operator\">/</span> <span class=\"token class-name\">A</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">if</span> x <span class=\"token punctuation\">{</span> <span class=\"token number\">26</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">+</span> <span class=\"token keyword\">if</span> x <span class=\"token punctuation\">{</span> input<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token class-name\">C</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    z<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token attribute attr-name\">#[cfg(test)]</span>\n<span class=\"token keyword\">mod</span> <span class=\"token module-declaration namespace\">tests</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">use</span> <span class=\"token keyword\">crate</span><span class=\"token punctuation\">::</span><span class=\"token punctuation\">{</span>calc_z<span class=\"token punctuation\">,</span> int2id<span class=\"token punctuation\">,</span> orig_calc_z<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token attribute attr-name\">#[test]</span>\n    <span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">test_calc_z</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> num <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token number\">0</span><span class=\"token punctuation\">..</span><span class=\"token number\">10000</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">let</span> input <span class=\"token operator\">=</span> <span class=\"token function\">int2id</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token macro property\">assert_eq!</span><span class=\"token punctuation\">(</span><span class=\"token function\">orig_calc_z</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>input<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">calc_z</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>input<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token macro property\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"{:?}\"</span><span class=\"token punctuation\">,</span> input<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            num <span class=\"token operator\">+=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">9</span> <span class=\"token keyword\">as</span> <span class=\"token keyword\">u128</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>テストも書きました，10000個のモデル番号に対する計算結果が，オリジナルのMONADと独自のMONADで一致することも確かめました．</p>\n<p>ここまでの観察で，MONADの本質的な部分は，inputの個数だけzを更新する部分であることがわかりました．</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">calc_z</span><span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">:</span> <span class=\"token operator\">&amp;</span><span class=\"token class-name\">Id</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> <span class=\"token keyword\">i128</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// よくわからん定数</span>\n\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> z <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token constant\">INPUT_DIGITS_NUM</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token number\">0</span><span class=\"token punctuation\">..</span><span class=\"token constant\">INPUT_DIGITS_NUM</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// よくわからん処理</span>\n        z<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token comment\">// よくわからん式 (a)</span>\n    <span class=\"token punctuation\">}</span>\n\n    z<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>また，zの配列を表示してみると，多くのモデル番号ではzの値が大きなものに発散しているようでした．したがって，今回の問題ではzをいかに発散させずに0へ持っていけるかが重要となりそうです．</p>\n<p>上記のzの更新式<code class=\"language-text\">(a)</code>を見てみます．</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\">z<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>prev_z <span class=\"token operator\">/</span> <span class=\"token class-name\">A</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">if</span> x <span class=\"token punctuation\">{</span> <span class=\"token number\">26</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span>\n       <span class=\"token operator\">+</span> <span class=\"token keyword\">if</span> x <span class=\"token punctuation\">{</span> input<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token class-name\">C</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>zを増加させる項である<code class=\"language-text\">* if x { 26 } else { 1 }</code>と<code class=\"language-text\">+ if x { input[i] + C[i] } else { 0 }</code>に着目します．どちらの項も，xという謎の真偽値がtureの時にzを増加させ，そうでない場合は値を変化させないことがわかります．</p>\n<p>一方で，zを減少させる可能性があるのは<code class=\"language-text\">prev_z / A[i]</code>の部分だけです．ここで<code class=\"language-text\">A</code>は次のような定数です．</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">let</span> <span class=\"token class-name\">A</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>つまり，モデル番号によらず，zは26で7回割られます．一方で，<code class=\"language-text\">* if x { 26 } else { 1 }</code>を思い出すと，xがtrueの場合はせっかく減少したzを打ち消してしまうことに気づきます．また， <strong>どのような1桁目のモデル番号を与えても最初のxはtrue</strong>．つまり <strong><code class=\"language-text\">z[0]</code>は0より大きい</strong> ということも確かめました．</p>\n<p>したがって， <strong>最初のtrueを除いて，xが7回以上trueになった時点で，そのモデル番号は無効</strong>．つまり <strong>xが8回以上trueとなった時点で，そのモデル番号は無効</strong> といえるので，この条件で枝切りができそうです．</p>\n<p><code class=\"language-text\">+ if x { input[i] + C[i] } else { 0 }</code>とかいう項が釈然としませんが，とりあえず無視します．</p>\n<h4 id=\"実装\" style=\"position:relative;\"><a href=\"#%E5%AE%9F%E8%A3%85\" aria-label=\"実装 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実装</h4>\n<p>各桁におけるzの計算をノードとして，深さ優先探索で解きました．ただし，xが<code class=\"language-text\">true</code>となった回数を数えておき，それが8回以上となった場合枝切りします．</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">struct</span> <span class=\"token type-definition class-name\">SearchState</span> <span class=\"token punctuation\">{</span>\n    digit_index<span class=\"token punctuation\">:</span> <span class=\"token keyword\">usize</span><span class=\"token punctuation\">,</span>\n    prev_z<span class=\"token punctuation\">:</span> <span class=\"token keyword\">i128</span><span class=\"token punctuation\">,</span>\n    true_x_num<span class=\"token punctuation\">:</span> <span class=\"token keyword\">i32</span><span class=\"token punctuation\">,</span>\n    show_progress<span class=\"token punctuation\">:</span> <span class=\"token keyword\">bool</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">search_id</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">:</span> <span class=\"token class-name\">SearchState</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> <span class=\"token class-name\">Option</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">Id</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 最終桁までステップを終えていて，かつzが0ならモデル番号を返す</span>\n\n    <span class=\"token comment\">// 枝切り</span>\n    <span class=\"token keyword\">if</span> state<span class=\"token punctuation\">.</span>true_x_num <span class=\"token operator\">>=</span> <span class=\"token number\">8</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">None</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// 現在の桁を9〜1まで試す</span>\n    <span class=\"token keyword\">for</span> digit <span class=\"token keyword\">in</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">..=</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">rev</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> z <span class=\"token operator\">=</span> <span class=\"token comment\">// zを計算</span>\n\n        <span class=\"token comment\">// 次の桁に対して自分自身を呼び出す</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token class-name\">None</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>上記のアルゴリズムによって，およそ800msくらいで解が求まりました．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day24-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-23\" style=\"position:relative;\"><a href=\"#part-2-23\" aria-label=\"part 2 23 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>MONADが受け付ける最小のモデル番号を回答します．</p>\n<p>Part 1のコードを少し改変すれば解けます．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day24-2/src/main.rs\">解答コード</a></p>\n</details>\n<h2 id=\"かんたん-day-25-sea-cucumber\" style=\"position:relative;\"><a href=\"#%E3%81%8B%E3%82%93%E3%81%9F%E3%82%93-day-25-sea-cucumber\" aria-label=\"かんたん day 25 sea cucumber permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[かんたん] <a href=\"https://adventofcode.com/2021/day/25\">Day 25: Sea Cucumber</a></h2>\n<details><summary>詳細を見る</summary>\n<h3 id=\"概要-24\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81-24\" aria-label=\"概要 24 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>ナマコの動きを予想する問題です．</p>\n<p>海底（2次元空間）にナマコが大量にいます（こわい）．潜水艦を海底のナマコが居ない部分へ安全に着陸させるために，ナマコの動きを計算します．</p>\n<p>ナマコの初期状態が次のように与えられます．</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">v...>>.vv>\n.vv>>.vv..\n>>.>v>...v\n>>v>>.>.v.\nv>v.vv.v..\n>.>>..v...\n.vv..>.>v.\nv.v..>>v.v\n....v..v.></code></pre></div>\n<p><code class=\"language-text\">.</code>の場所にはナマコはいません．<code class=\"language-text\">></code>は東向きのナマコで，右に動きます．<code class=\"language-text\">v</code>は南向きのナマコで，下に動きます．</p>\n<p>ナマコは，次に動くべき場所に空きスペースがあれば動きます．なければ動きません．</p>\n<p>マップの上下左右は，それぞれ反対側とつながっています．</p>\n<h3 id=\"part-1-24\" style=\"position:relative;\"><a href=\"#part-1-24\" aria-label=\"part 1 24 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 1</h3>\n<p>ナマコを動かしていくと，いずれお互いを邪魔しあってマップに変化がなくなります．ナマコが動かなくなる最初のステップ数を回答します．</p>\n<p>ここまでの問題が解けたなら，特に難しいことはありません．素直に実装すれば良いです．</p>\n<p><a href=\"https://github.com/sititou70/advent-of-code-2021/blob/master/day25-1/src/main.rs\">解答コード</a></p>\n<h3 id=\"part-2-24\" style=\"position:relative;\"><a href=\"#part-2-24\" aria-label=\"part 2 24 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part 2</h3>\n<p>これまでの問題全てを解いていれば自動的にクリアとなります．</p>\n</details>\n<h2 id=\"完走した感想\" style=\"position:relative;\"><a href=\"#%E5%AE%8C%E8%B5%B0%E3%81%97%E3%81%9F%E6%84%9F%E6%83%B3\" aria-label=\"完走した感想 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>完走した感想</h2>\n<details><summary>感想を見る</summary>\n<p>初めてAdvent of Codeというものに参加してみて，本当に辛かったです．後半の問題の難しさと，年末の仕事納めの忙しさのダブルパンチにより，「もうやめちゃおうかな…」と何度も思いました．しかしその分，全ての問題が終わった時の達成感は何ものにも代えがたいものでした．</p>\n<p>今回のイベントを通して，合計3000行くらいのRustのコードを書きました．イベントに参加する前は <em>「ちょっとしたパズルを25問解くだけでしょ」</em> と思っていましたが，終わってみれば，やっぱりなかなかの分量があるなぁと思います．</p>\n<p><a href=\"/Rust%E6%AD%B47%E6%97%A5%E3%81%A7%E3%81%99%E3%81%8C%E9%9F%B3%E3%82%B2%E3%83%BC%E3%82%92%E4%BD%9C%E3%82%8A%E3%81%BE%E3%81%97%E3%81%9F/\">前回の記事</a>ではノリでRustに入門しました．今回のイベントによって入門者 -> 初心者くらいまでレベルアップできたのではないかと思っています．日を追うごとに問題が難しくなっていくので，何かの言語の入門に適したイベントではないかと感じました．</p>\n<p>最後に，私をAdvent of Code 2021に誘ってくださった <a href=\"https://twitter.com/yosuke_furukawa\">@yosuke_furukawa</a> さんにお礼を申し上げます．furukawaさんに誘われるまではこのようなイベントがあることすら知りませんでしたし，多分一人では参加しなかったと思います．イベント中は，お互いのリポジトリへのPushがSlackで通知されるようにしていたのですが，お互いのコミットによってプレッシャーを与えあっていたおかげで，なんとか完走できました．</p>\n</details>\n<p>本記事があなたのお役に立てばうれしいです．</p>\n<p>ありがとうございました．</p>","frontmatter":{"title":"Advent of Code 2021攻略ガイド","date":"2021/12/28"},"fields":{"slug":"/Advent-of-Code-2021攻略ガイド/"},"id":"75696ec6-74a3-5046-8a3c-f39b36d92311"},"firstImage":{"imageFile":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080818","images":{"fallback":{"src":"/static/f2f0cc20eaee74bb0701cb400d43698e/6b08a/top.png","srcSet":"/static/f2f0cc20eaee74bb0701cb400d43698e/11f32/top.png 163w,\n/static/f2f0cc20eaee74bb0701cb400d43698e/b96ce/top.png 325w,\n/static/f2f0cc20eaee74bb0701cb400d43698e/6b08a/top.png 650w","sizes":"(min-width: 650px) 650px, 100vw"},"sources":[{"srcSet":"/static/f2f0cc20eaee74bb0701cb400d43698e/68054/top.webp 163w,\n/static/f2f0cc20eaee74bb0701cb400d43698e/43f70/top.webp 325w,\n/static/f2f0cc20eaee74bb0701cb400d43698e/ddecf/top.webp 650w","type":"image/webp","sizes":"(min-width: 650px) 650px, 100vw"}]},"width":650,"height":603}}}},"relatedMarkdownRemarks":{"posts":[{"id":"4d43646f-8aa6-52b6-b0b6-5160f0be2b05","frontmatter":{"draft":null}},{"id":"d29b4513-0609-5cfc-af49-817467dbed1f","frontmatter":{"draft":null}},{"id":"f49ce388-e81c-5425-af59-9902f125c20f","frontmatter":{"draft":null}},{"id":"5dba01b8-593d-5295-b135-16df1c6295e5","frontmatter":{"draft":null}},{"id":"48c65a15-67ca-57d0-9edc-ebcb868f7ad2","frontmatter":{"draft":true}},{"id":"f920a8a8-f5fe-57c9-8792-95c93d2b74eb","frontmatter":{"draft":null}},{"id":"c2db052c-95c6-5094-935b-9eb39f5c762a","frontmatter":{"draft":null}},{"id":"4efc4f86-56aa-5ff4-8994-3946583906ad","frontmatter":{"draft":null}},{"id":"8f7b1b24-7738-5b97-bfb6-fd763f11a664","frontmatter":{"draft":true}},{"id":"84bf9a79-dd68-55d1-a1b3-60ffd3784554","frontmatter":{"draft":null}},{"id":"50d3cc2a-de7a-5b9a-a8d8-754415fe4d94","frontmatter":{"draft":null}},{"id":"3a3c4125-9986-53bb-8b96-ae29936c96ab","frontmatter":{"draft":null}},{"id":"01deffb8-0d62-54c6-9e41-20832cbc3c6e","frontmatter":{"draft":null}},{"id":"89ddbcc0-ed71-5a69-9d55-9677eab3e6cf","frontmatter":{"draft":null}},{"id":"fc7ce496-d3b3-5f39-a04e-8e2dfb960626","frontmatter":{"draft":null}},{"id":"ed7af7f9-75f5-59be-9063-de564576eed7","frontmatter":{"draft":true}},{"id":"0116f663-28d1-507a-b5ab-b189801dd408","frontmatter":{"draft":true}},{"id":"50951bb1-eb92-5663-a3d8-8f35f73a1322","frontmatter":{"draft":null}},{"id":"82d43655-ea2a-52cd-97a3-16b7b28ad150","frontmatter":{"draft":null}},{"id":"7a8fc278-a847-5b68-8b74-a83193ba3f55","frontmatter":{"draft":null}},{"id":"5010f43b-fdb5-5b2b-8f0c-3b7434219588","frontmatter":{"draft":null}},{"id":"73ab4455-f04d-5320-bf3a-90b9f7441d13","frontmatter":{"draft":null}},{"id":"be594923-185e-5cca-95b6-5267b3c9fc8c","frontmatter":{"draft":null}},{"id":"3d71b3f9-8d6b-58a4-b6cb-8293daf99d74","frontmatter":{"draft":null}},{"id":"3c14921d-1ba3-5a7a-93a2-757f3a03ee3a","frontmatter":{"draft":null}},{"id":"067a602f-4581-5707-b896-73190dd8c889","frontmatter":{"draft":null}},{"id":"0c5568c9-6d87-56ed-ab0e-caeb9c1aafa4","frontmatter":{"draft":null}},{"id":"1086a735-7173-58cc-a813-c540a563aedf","frontmatter":{"draft":false}},{"id":"1162dccb-e1bf-576d-a5c6-0993394feb0a","frontmatter":{"draft":true}},{"id":"12222bfa-2e8e-51ee-99d8-8a19902351f5","frontmatter":{"draft":null}},{"id":"1509de3c-7308-5e40-a885-f5ebdb089774","frontmatter":{"draft":null}},{"id":"27f10a38-0ecb-539f-a717-7e40a41bbd10","frontmatter":{"draft":null}},{"id":"29b79017-f96d-5b04-8d01-5b8ee761ebed","frontmatter":{"draft":null}},{"id":"2cfd9e33-b4e1-53e4-884d-d8a6760f3387","frontmatter":{"draft":true}},{"id":"2f30c3f1-0d66-590b-8dba-7836df701d46","frontmatter":{"draft":null}},{"id":"3908aafc-c8d3-5c67-821f-0866592449f2","frontmatter":{"draft":true}},{"id":"3b696b96-130d-50de-a673-dc1367f32387","frontmatter":{"draft":null}},{"id":"46a22c41-5455-557c-85d4-973a6e2220ee","frontmatter":{"draft":null}},{"id":"49cf25c1-03f6-575e-8c2f-638ccd6198ea","frontmatter":{"draft":null}},{"id":"4ed3b747-2001-54f4-9661-3acab89ce275","frontmatter":{"draft":null}},{"id":"4edc1b46-b395-5783-af6a-818b8fc9c2dc","frontmatter":{"draft":null}},{"id":"5888c50d-8414-5e8f-b0dc-28a31b29053d","frontmatter":{"draft":null}},{"id":"63f3c7ad-6c59-52b5-9816-78fd348955ff","frontmatter":{"draft":true}},{"id":"69a4aa90-b728-522c-b34f-abee49825c45","frontmatter":{"draft":true}},{"id":"73d6ab42-b3e6-5663-a175-b1f3d69c29e1","frontmatter":{"draft":null}},{"id":"75550af2-8134-5467-a07d-abbb5a4f6b7c","frontmatter":{"draft":true}},{"id":"7778d041-a5bf-536a-a36f-c0dbc5e08ac7","frontmatter":{"draft":true}},{"id":"78349b16-6e41-5fef-ae38-bcdc5ff297ef","frontmatter":{"draft":true}},{"id":"7d6499d9-277c-5f07-b8b1-98ae40c50c42","frontmatter":{"draft":true}},{"id":"7d79eb4b-cd4a-5621-a67a-91d9a24dce05","frontmatter":{"draft":null}},{"id":"871ac696-39ea-5c64-94f3-5dc4b73b5770","frontmatter":{"draft":true}},{"id":"8b3e46c2-1a1e-5af0-8900-7972c7285d15","frontmatter":{"draft":null}},{"id":"961ec1e6-3f2b-59d9-a33f-dad76cf67f47","frontmatter":{"draft":null}},{"id":"97f01467-e3a1-58e1-b2a4-db77354cc1a3","frontmatter":{"draft":null}},{"id":"9f02de74-61a0-5daf-a048-1c1022e08fe4","frontmatter":{"draft":null}},{"id":"9f24363b-ee3e-54bf-8a18-46ea3b269bea","frontmatter":{"draft":null}},{"id":"a091877c-69b8-59f9-8963-1af334fd573c","frontmatter":{"draft":null}},{"id":"a190aac4-0483-5e02-b1d3-261f3b5f313a","frontmatter":{"draft":null}},{"id":"a6c64123-b824-5224-8027-90eb12040396","frontmatter":{"draft":null}},{"id":"b4251348-b618-5b5b-a2c8-e4c6b2431b83","frontmatter":{"draft":true}},{"id":"bfee69af-7d7f-5d87-9680-d2e9b60f8416","frontmatter":{"draft":null}},{"id":"c2249b7b-b97e-5cf4-8ea9-8024e96851b7","frontmatter":{"draft":true}},{"id":"c5e2431a-cf05-5024-b833-e1c69f680d44","frontmatter":{"draft":null}},{"id":"c6def021-b8da-5dbe-ad3e-811d9286424d","frontmatter":{"draft":true}},{"id":"c7a5adfb-149b-5469-ba35-7421e2101951","frontmatter":{"draft":null}},{"id":"cbdf3192-973c-5d87-9cf1-bb9110e9a169","frontmatter":{"draft":null}},{"id":"d4d1afa4-f2f9-5942-ae36-2826fb938af5","frontmatter":{"draft":null}},{"id":"db26c6b9-37b4-5cc4-b1ec-c61dc667863e","frontmatter":{"draft":null}},{"id":"dd0c41cf-0a03-5b89-b5a2-f64859aeae63","frontmatter":{"draft":null}},{"id":"e322eac2-bd89-5347-b20d-d050d303a6be","frontmatter":{"draft":null}},{"id":"e376b2d4-df91-5b82-af7a-a8d02763e922","frontmatter":{"draft":true}},{"id":"e4fb8478-b1ad-59eb-95e8-8c5e0500d3f4","frontmatter":{"draft":true}},{"id":"e83330dc-2312-5ae6-95fa-53e86909f42b","frontmatter":{"draft":true}},{"id":"eba9aa6a-6e21-5f1b-a0eb-7b6bfb1e04f1","frontmatter":{"draft":null}},{"id":"ebae7878-c4ee-505e-81e2-3d3fc47ea826","frontmatter":{"draft":true}},{"id":"f06a6ae0-e961-504c-8dab-a60489c0557a","frontmatter":{"draft":true}},{"id":"f5a25ce1-67a6-51b2-9bf1-f9fbacb41ad1","frontmatter":{"draft":true}},{"id":"fd6eab68-17d3-5395-8b2b-54a6efe43ebb","frontmatter":{"draft":null}}]}},"pageContext":{"id":"75696ec6-74a3-5046-8a3c-f39b36d92311"}},"staticQueryHashes":["1800451590","2576926420","63159454"],"slicesMap":{}}